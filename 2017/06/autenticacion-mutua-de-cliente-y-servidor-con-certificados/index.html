<!doctype html><html lang=es><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="picodotdev"><meta name=keywords content="java,programacion,software,hardware,tapestry,software libre,gnu,linux,gnu/linux,unix,arch,arch linux,html,css,javascript"><meta name=description content="Los certificados no solo sirven para autenticar a un servidor o acceder solo a aquellos en los que confiamos. El servidor también puede autenticar a los clientes mediante un certificado como alternativa a usar un usuario y contraseña ya sea una autenticación BASIC o un formulario personalizado. Al igual que en el cliente usa el certificado de la autoridad de certificación en la que confía para validar el que presenta el servidor, el servidor puede requerir que el cliente también proporcione un certificado que el servidor valida según las autoridades de certificación en las que confía, en ambos casos el servidor o cliente usan su clave privada para iniciar la conexión segura con el handsake del protocolo TLS. &mldr;"><base href=https://picodotdev.github.io/blog-bitix/><title>Autenticación mutua de cliente y servidor con certificados</title><link rel=author type=text/plain href=humans.txt><link rel="shortcut icon" href=assets/favicon.ico><link rel=apple-touch-icon-precomposed sizes=144x144 href=assets/apple-touch-icon-144-precomposed.png><link rel=canonical href=https://picodotdev.github.io/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/><link href=index.xml rel=alternate type=application/rss+xml title="Blog Bitix"><link rel=stylesheet type=text/css href=assets/css/font.css><link rel=stylesheet type=text/css href=assets/libs/bootstrap-4.3.1/css/bootstrap.min.css><link rel=stylesheet type=text/css href=assets/libs/Gallery-2.33.0/css/blueimp-gallery.min.css><link rel=stylesheet type=text/css href=assets/css/syntax.css><link rel=stylesheet type=text/css href=assets/css/main.css><script type=text/javascript src=assets/js/require-config.js data-main=js/main defer></script><script type=text/javascript src=assets/libs/require.js data-main=js/main defer></script><script src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js defer></script><script type=text/javascript defer>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:'ca-pub-3533636310991304',enable_page_level_ads:true});</script><script type=text/javascript defer>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-12874075-4','picodotdev.github.io');ga('send','pageview');</script><script type=text/javascript src="//platform-api.sharethis.com/js/sharethis.js#property=5920c4ce1bd0670011e06acd&product=inline-share-buttons" defer></script><script type=text/javascript src=assets/js/app.js defer></script></head><body><div class=container><div class=row><div class=col-12><header><div class=row><div class="col-12 col-lg-4"></div><div class="col-12 col-lg-4"><h2 class=title><a href=https://picodotdev.github.io/blog-bitix/>Blog Bitix</a></h2><div class=links><a href=index.xml title="¡Suscríbete a Blog Bitix!"><img src=assets/images/rss.png class=icon></a>
<a href=https://twitter.com/picodotdev/ title="¡Sígueme en twitter!"><img src=assets/images/twitter.svg class=icon></a>
<a href=https://github.com/picodotdev/blog-ejemplos/ title="¡Obtén el código fuente de los ejemplos!"><img src=assets/images/github.svg class=icon></a></div></div><div class="col-12 col-lg-4 text-center"><form name=query class="form-inline search" onsubmit="return false;"><div class=input-group><input type=text name=q class=form-control placeholder="Buscar en Blog Bitix">
<span class=input-group-btn><button class="btn btn-secondary" type=submit>Buscar</button></span></div></form><form name=search action=https://duckduckgo.com/ method=get class=hidden data-site=https://picodotdev.github.io/blog-bitix/><input type=hidden name=q></form></div></div><div class=row><div class=col-12><nav class="nav nav-pills nav-fill"><a href=/blog-bitix/tags/java/ class="nav-item nav-link">Java</a>
<a href=/blog-bitix/tags/gnu-linux/ class="nav-item nav-link">GNU/Linux</a>
<a href=/blog-bitix/tags/javascript/ class="nav-item nav-link">JavaScript</a>
<a href=/blog-bitix/tags/tapestry/ class="nav-item nav-link">Tapestry</a>
<a href=/blog-bitix/archive/ class="nav-item nav-link">Archivo y hemeroteca</a>
<a href=/blog-bitix/pages/links/ class="nav-item nav-link">Enlaces</a>
<a href=/blog-bitix/pages/about/ class="nav-item nav-link">Acerca de...</a></nav></div></div></header></div></div><div class=row><div class="col-12 text-center"><ins class=adsbygoogle style=display:inline-block;width:970px;height:250px data-ad-client=ca-pub-3533636310991304 data-ad-slot=2975854584 data-type=billboard></ins></div></div><div class=row><div class=col-12><div class=adblock-sidebar-container><div class=adblock-sidebar-container-left></div><div class=adblock-sidebar-container-right><ins class=adsbygoogle style=display:inline-block;width:300px;height:600px data-ad-client=ca-pub-3533636310991304 data-ad-slot=9933840986 data-ad-format="vertical, rectangle" data-type=auto></ins></div></div><article itemprop=mainEntity itemscope itemtype=http://schema.org/BlogPosting><meta itemprop=inLanguage content="es"><meta itemprop=keywords content="java, planeta-codigo, planeta-linux, programacion, seguridad"><h1 itemprop=name>Autenticación mutua de cliente y servidor con certificados</h1><p class=information>Escrito por
<span itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>picodotdev</span></span> el <time itemprop=datePublished datetime=2017-06-17>17/06/2017</time>, actualizado el <time itemprop=dateModified datetime=2017-06-18>18/06/2017</time>.<br><a href=tags/java/>java</a> <a href=tags/planeta-codigo/>planeta-codigo</a> <a href=tags/planeta-linux/>planeta-linux</a> <a href=tags/programacion/>programacion</a> <a href=tags/seguridad/>seguridad</a><br><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/ itemprop=url>Enlace permanente</a>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/#comments>Comentarios</a></p><div class=content itemprop=articleBody><meta itemprop=wordCount content="2555"><div class=logotypes><img src=/blog-bitix/assets/images/logotipos/openssl.svg class=right width=400 alt=OpenSSL title=OpenSSL></div><p>Los certificados no solo sirven para autenticar a un servidor o acceder solo a aquellos en los que confiamos. El servidor también puede autenticar a los clientes mediante un certificado como alternativa a usar un usuario y contraseña ya sea una autenticación <em>BASIC</em> o un formulario personalizado. Al igual que en el cliente usa el certificado de la autoridad de certificación en la que confía para validar el que presenta el servidor, el servidor puede requerir que el cliente también proporcione un certificado que el servidor valida según las autoridades de certificación en las que confía, en ambos casos el servidor o cliente usan su clave privada para iniciar la conexión segura con el <em>handsake</em> del <a href=https://es.wikipedia.org/wiki/Transport_Layer_Security>protocolo TLS</a>.</p><p>Para el ejemplo usaré un servidor web <a href=https://nginx.org/>nginx</a> ejecutado como un contenedor de <a href=https://www.docker.com/>Docker</a> configurado de tal manera que requiere autenticación para el cliente con certificados.</p><p>Inicialmente deberemos generar tres parejas de claves privadas y públicas, una para nuestra propia autoridad de certificación, una clave para el servidor y otra para el cliente. Al mismo tiempo generaré otras tres parejas de claves privadas y públicas para comprobar que cuando se proporciona un certificado incorrecto la autenticación falla.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ openssl genrsa -out ca.key <span class=m>8192</span>&#10;Generating RSA private key, <span class=m>8192</span> bit long modulus&#10;............................................................................................................................................++&#10;.........................................................................................................................................................................................................................................................................................................................................++&#10;e is <span class=m>65537</span> <span class=o>(</span>0x010001<span class=o>)</span>&#10;&#10;$ openssl rsa -in ca.key -pubout &gt; ca.pub&#10;$ openssl genrsa -out server.key <span class=m>8192</span>&#10;$ openssl rsa -in server.key -pubout &gt; server.pub&#10;$ openssl genrsa -out client.key <span class=m>8192</span>&#10;$ openssl rsa -in ca.key -pubout &gt; client.pub</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-genrsa.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-genrsa.sh target=_blank>openssl-genrsa.sh</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span><span class=lnt>2&#10;</span><span class=lnt>3&#10;</span><span class=lnt>4&#10;</span><span class=lnt>5&#10;</span><span class=lnt>6&#10;</span><span class=lnt>7&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-plaintext data-lang=plaintext>-----BEGIN CERTIFICATE-----&#10;MIIJeTCCBWGgAwIBAgIJAMmS/dYrpwDnMA0GCSqGSIb3DQEBBQUAMDExCzAJBgNV&#10;BAYTAkVTMQ4wDAYDVQQIEwVTcGFpbjESMBAGA1UEChMJbG9jYWxob3N0MB4XDTE3&#10;MDQwNzA2NTcxNVoXDTIyMDQwNjA2NTcxNVowMTELMAkGA1UEBhMCRVMxDjAMBgNV&#10;BAgTBVNwYWluMRIwEAYDVQQKEwlsb2NhbGhvc3QwggQiMA0GCSqGSIb3DQEBAQUA&#10;...&#10;-----END CERTIFICATE-----</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/ca.crt target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/ca.crt target=_blank>ca.crt</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span><span class=lnt>2&#10;</span><span class=lnt>3&#10;</span><span class=lnt>4&#10;</span><span class=lnt>5&#10;</span><span class=lnt>6&#10;</span><span class=lnt>7&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-plaintext data-lang=plaintext>-----BEGIN RSA PRIVATE KEY-----&#10;MIISJwIBAAKCBAEAyq7VfFt8LapGTtrN4zPAp5KdiHc3raAhs7MSGmrmtqYszheS&#10;AGok/xx9RlUrLSgzjhQ22s28OgfKnqKOK1bzcjTj5Uwjc5Tr7RY724924amECHXc&#10;ldJGc3c/BpdbyYboxsTau8BbAk45c61QKeoTGtQ+K4a2/X0oArroTtHOlRFFUB9t&#10;yKSD20Vj80Ks4op/Q7ucEcZ8mr9zAXzhfokK72PLRGWmmvd1NBoHUzbrkNH9A8he&#10;...&#10;-----END RSA PRIVATE KEY-----</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/ca.key target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/ca.key target=_blank>ca.key</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span><span class=lnt>2&#10;</span><span class=lnt>3&#10;</span><span class=lnt>4&#10;</span><span class=lnt>5&#10;</span><span class=lnt>6&#10;</span><span class=lnt>7&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-plaintext data-lang=plaintext>-----BEGIN PUBLIC KEY-----&#10;MIIEIjANBgkqhkiG9w0BAQEFAAOCBA8AMIIECgKCBAEAyq7VfFt8LapGTtrN4zPA&#10;p5KdiHc3raAhs7MSGmrmtqYszheSAGok/xx9RlUrLSgzjhQ22s28OgfKnqKOK1bz&#10;cjTj5Uwjc5Tr7RY724924amECHXcldJGc3c/BpdbyYboxsTau8BbAk45c61QKeoT&#10;GtQ+K4a2/X0oArroTtHOlRFFUB9tyKSD20Vj80Ks4op/Q7ucEcZ8mr9zAXzhfokK&#10;...&#10;-----END PUBLIC KEY-----</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/ca.pub target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/ca.pub target=_blank>ca.pub</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span><span class=lnt>2&#10;</span><span class=lnt>3&#10;</span><span class=lnt>4&#10;</span><span class=lnt>5&#10;</span><span class=lnt>6&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ openssl genrsa -out ca-unknown.key <span class=m>8192</span>&#10;$ openssl rsa -in ca-unknown.key -pubout &gt; ca-unknown.pub&#10;$ openssl genrsa -out server-unknown.key <span class=m>8192</span>&#10;$ openssl rsa -in server-unknown.key -pubout &gt; server-unknown.pub&#10;$ openssl genrsa -out client-unknown.key <span class=m>8192</span>&#10;$ openssl rsa -in ca-unknown.key -pubout &gt; client-unknown.pub</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-genrsa-unknown.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-genrsa-unknown.sh target=_blank>openssl-genrsa-unknown.sh</a></div></div><p>El siguiente paso es generar los certificados y firmar con la clave y certificado de la autoridad de certificado los certificados del servidor y cliente. Como paso previo a que la autoridad de certificación emita los certificados del servidor y cliente hay que generar una petición de firma de certificado, los archivos <em>.csr</em>.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span><span class=lnt>17&#10;</span><span class=lnt>18&#10;</span><span class=lnt>19&#10;</span><span class=lnt>20&#10;</span><span class=lnt>21&#10;</span><span class=lnt>22&#10;</span><span class=lnt>23&#10;</span><span class=lnt>24&#10;</span><span class=lnt>25&#10;</span><span class=lnt>26&#10;</span><span class=lnt>27&#10;</span><span class=lnt>28&#10;</span><span class=lnt>29&#10;</span><span class=lnt>30&#10;</span><span class=lnt>31&#10;</span><span class=lnt>32&#10;</span><span class=lnt>33&#10;</span><span class=lnt>34&#10;</span><span class=lnt>35&#10;</span><span class=lnt>36&#10;</span><span class=lnt>37&#10;</span><span class=lnt>38&#10;</span><span class=lnt>39&#10;</span><span class=lnt>40&#10;</span><span class=lnt>41&#10;</span><span class=lnt>42&#10;</span><span class=lnt>43&#10;</span><span class=lnt>44&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ openssl req -new -x509 -days <span class=m>1825</span> -key ca.key -out ca.crt&#10;You are about to be asked to enter information that will be incorporated&#10;into your certificate request.&#10;What you are about to enter is what is called a Distinguished Name or a DN.&#10;There are quite a few fields but you can leave some blank&#10;For some fields there will be a default value,&#10;If you enter <span class=s1>&#39;.&#39;</span>, the field will be left blank.&#10;-----&#10;Country Name <span class=o>(</span><span class=m>2</span> letter code<span class=o>)</span> <span class=o>[</span>AU<span class=o>]</span>:ES&#10;State or Province Name <span class=o>(</span>full name<span class=o>)</span> <span class=o>[</span>Some-State<span class=o>]</span>:Spain&#10;Locality Name <span class=o>(</span>eg, city<span class=o>)</span> <span class=o>[</span><span class=o>]</span>:&#10;Organization Name <span class=o>(</span>eg, company<span class=o>)</span> <span class=o>[</span>Internet Widgits Pty Ltd<span class=o>]</span>:Blog Bitix Certiticate Authority&#10;Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span> <span class=o>[</span><span class=o>]</span>:&#10;Common Name <span class=o>(</span>e.g. server FQDN or YOUR name<span class=o>)</span> <span class=o>[</span><span class=o>]</span>:&#10;Email Address <span class=o>[</span><span class=o>]</span>:&#10;&#10;$ openssl req -new -key server.key -out server.csr&#10;You are about to be asked to enter information that will be incorporated&#10;into your certificate request.&#10;What you are about to enter is what is called a Distinguished Name or a DN.&#10;There are quite a few fields but you can leave some blank&#10;For some fields there will be a default value,&#10;If you enter <span class=s1>&#39;.&#39;</span>, the field will be left blank.&#10;-----&#10;Country Name <span class=o>(</span><span class=m>2</span> letter code<span class=o>)</span> <span class=o>[</span>AU<span class=o>]</span>:ES&#10;State or Province Name <span class=o>(</span>full name<span class=o>)</span> <span class=o>[</span>Some-State<span class=o>]</span>:Spain&#10;Locality Name <span class=o>(</span>eg, city<span class=o>)</span> <span class=o>[</span><span class=o>]</span>:&#10;Organization Name <span class=o>(</span>eg, company<span class=o>)</span> <span class=o>[</span>Internet Widgits Pty Ltd<span class=o>]</span>:Blog Bitix&#10;Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span> <span class=o>[</span><span class=o>]</span>:&#10;Common Name <span class=o>(</span>e.g. server FQDN or YOUR name<span class=o>)</span> <span class=o>[</span><span class=o>]</span>:localhost&#10;Email Address <span class=o>[</span><span class=o>]</span>:&#10;&#10;Please enter the following <span class=s1>&#39;extra&#39;</span> attributes&#10;to be sent with your certificate request&#10;A challenge password <span class=o>[</span><span class=o>]</span>:&#10;An optional company name <span class=o>[</span><span class=o>]</span>:&#10;&#10;$ openssl req -new -key client.key -out client.csr&#10;&#10;$ openssl x509 -req -days <span class=m>1825</span> -in server.csr -CA ca.crt -CAkey ca.key -set_serial <span class=m>01</span> -out server.crt&#10;Signature ok&#10;<span class=nv>subject</span><span class=o>=</span><span class=nv>C</span> <span class=o>=</span> ES, <span class=nv>ST</span> <span class=o>=</span> Spain, <span class=nv>O</span> <span class=o>=</span> Blog Bitix, <span class=nv>CN</span> <span class=o>=</span> localhost&#10;Getting CA Private Key&#10;$ openssl x509 -req -days <span class=m>1825</span> -in client.csr -CA ca.crt -CAkey ca.key -set_serial <span class=m>02</span> -out client.crt</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-req.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-req.sh target=_blank>openssl-req.sh</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span><span class=lnt>2&#10;</span><span class=lnt>3&#10;</span><span class=lnt>4&#10;</span><span class=lnt>5&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ openssl req -new -x509 -days <span class=m>1825</span> -key ca-unknown.key -out ca-unknown.crt&#10;$ openssl req -new -key server-unknown.key -out server-unknown.csr&#10;$ openssl req -new -key client-unknown.key -out client-unknown.csr&#10;$ openssl x509 -req -days <span class=m>1825</span> -in server-unknown.csr -CA ca-unknown.crt -CAkey ca-unknown.key -set_serial <span class=m>01</span> -out server-unknown.crt&#10;$ openssl x509 -req -days <span class=m>1825</span> -in client-unknown.csr -CA ca-unknown.crt -CAkey ca-unknown.key -set_serial <span class=m>02</span> -out client-unknown.crt</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-req-unknown.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-req-unknown.sh target=_blank>openssl-req-unknown.sh</a></div></div><p>Con la misma herramienta de <a href=https://www.openssl.org/>OpenSSL</a> es posible comprobar si un certificado es válido para una autoridad de certificación en la que se confía, para ello se usa el certificado raiz de la autoridad.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span><span class=lnt>2&#10;</span><span class=lnt>3&#10;</span><span class=lnt>4&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ openssl verify -CAfile ca.crt server.crt&#10;server.crt: OK&#10;$ openssl verify -CAfile ca.crt client.crt&#10;client.crt: OK</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-verify.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-verify.sh target=_blank>openssl-verify.sh</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span><span class=lnt>2&#10;</span><span class=lnt>3&#10;</span><span class=lnt>4&#10;</span><span class=lnt>5&#10;</span><span class=lnt>6&#10;</span><span class=lnt>7&#10;</span><span class=lnt>8&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ openssl verify -CAfile ca.crt server-unknown.crt&#10;<span class=nv>C</span> <span class=o>=</span> ES, <span class=nv>ST</span> <span class=o>=</span> Spain, <span class=nv>O</span> <span class=o>=</span> Unknown, <span class=nv>CN</span> <span class=o>=</span> localhost&#10;error <span class=m>20</span> at <span class=m>0</span> depth lookup: unable to get <span class=nb>local</span> issuer certificate&#10;error server-unknown.crt: verification failed&#10;$ openssl verify -CAfile ca.crt client-unknown.crt&#10;<span class=nv>C</span> <span class=o>=</span> ES, <span class=nv>ST</span> <span class=o>=</span> Spain, <span class=nv>O</span> <span class=o>=</span> Unknown Client&#10;error <span class=m>20</span> at <span class=m>0</span> depth lookup: unable to get <span class=nb>local</span> issuer certificate&#10;error client-unknown.crt: verification failed</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-verify-unknown.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/openssl-verify-unknown.sh target=_blank>openssl-verify-unknown.sh</a></div></div><p>Para hacer que el servidor nginx requiera autenticación mediante certificados para el cliente hay que añadir un poco de configuración mediante las directivas <em>ssl</em> donde se indica el certificado del servidor, la clave privada del servidor, el certificado de la autoridad de certificación contra la que se validarán los certificados de los clientes y finalmente la directiva que establece que se ha de verificar a los clientes mediante certificados.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-plaintext data-lang=plaintext>http {&#10;&nbsp;&nbsp;&nbsp;&nbsp;...&#10;&nbsp;&nbsp;&nbsp;&nbsp;server {&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listen&nbsp;&nbsp;&nbsp;&nbsp;   443;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server_name  localhost;&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl_certificate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /etc/nginx/server.crt;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl_certificate_key&nbsp;&nbsp;&nbsp;&nbsp; /etc/nginx/server.key;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl_client_certificate  /etc/nginx/ca.crt;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl_verify_client&nbsp;&nbsp;&nbsp;&nbsp;   on;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl_verify_depth 5;&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&#10;&nbsp;&nbsp;&nbsp;&nbsp;}&#10;}</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/nginx.conf target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/nginx.conf target=_blank>nginx.conf</a></div></div><p>Con el siguiente archivo descriptor de <a href=https://docs.docker.com/compose/>Docker Compose</a> y comando se inicia el servidor web nginx.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ docker-compose up&#10;</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/docker-compose.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/docker-compose.sh target=_blank>docker-compose.sh</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-YAML data-lang=YAML>nginx<span class=p>:</span><span class=w>&#10;</span><span class=w>  </span>image<span class=p>:</span><span class=w> </span>nginx<span class=p>:</span>alpine<span class=w>&#10;</span><span class=w>  </span>volumes<span class=p>:</span><span class=w>&#10;</span><span class=w>&nbsp;&nbsp;&nbsp;&nbsp;</span>-<span class=w> </span>./nginx.conf<span class=p>:</span>/etc/nginx/nginx.conf<span class=p>:</span>ro<span class=w>&#10;</span><span class=w>&nbsp;&nbsp;&nbsp;&nbsp;</span>-<span class=w> </span>./server.key<span class=p>:</span>/etc/nginx/server.key<span class=p>:</span>ro<span class=w>&#10;</span><span class=w>&nbsp;&nbsp;&nbsp;&nbsp;</span>-<span class=w> </span>./server.crt<span class=p>:</span>/etc/nginx/server.crt<span class=p>:</span>ro<span class=w>&#10;</span><span class=w>&nbsp;&nbsp;&nbsp;&nbsp;</span>-<span class=w> </span>./ca.crt<span class=p>:</span>/etc/nginx/ca.crt<span class=p>:</span>ro<span class=w>&#10;</span><span class=w>  </span>ports<span class=p>:</span><span class=w>&#10;</span><span class=w>&nbsp;&nbsp;&nbsp;&nbsp;</span>-<span class=w> </span><span class=s2>&#34;80:80&#34;</span><span class=w>&#10;</span><span class=w>&nbsp;&nbsp;&nbsp;&nbsp;</span>-<span class=w> </span><span class=s2>&#34;443:443&#34;</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/docker-compose.yml target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/docker-compose.yml target=_blank>docker-compose.yml</a></div></div><p>Iniciado el servidor web ya se pueden realizar peticiones y el servidor y el cliente se autenticarán mutuamente. El servidor devolverá el código HTML de la página de bienvenida por defecto con las cabeceras del protocolo HTTP después de realizar el <em>handsake</em> donde se valida el certificado del servidor.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span><span class=lnt>17&#10;</span><span class=lnt>18&#10;</span><span class=lnt>19&#10;</span><span class=lnt>20&#10;</span><span class=lnt>21&#10;</span><span class=lnt>22&#10;</span><span class=lnt>23&#10;</span><span class=lnt>24&#10;</span><span class=lnt>25&#10;</span><span class=lnt>26&#10;</span><span class=lnt>27&#10;</span><span class=lnt>28&#10;</span><span class=lnt>29&#10;</span><span class=lnt>30&#10;</span><span class=lnt>31&#10;</span><span class=lnt>32&#10;</span><span class=lnt>33&#10;</span><span class=lnt>34&#10;</span><span class=lnt>35&#10;</span><span class=lnt>36&#10;</span><span class=lnt>37&#10;</span><span class=lnt>38&#10;</span><span class=lnt>39&#10;</span><span class=lnt>40&#10;</span><span class=lnt>41&#10;</span><span class=lnt>42&#10;</span><span class=lnt>43&#10;</span><span class=lnt>44&#10;</span><span class=lnt>45&#10;</span><span class=lnt>46&#10;</span><span class=lnt>47&#10;</span><span class=lnt>48&#10;</span><span class=lnt>49&#10;</span><span class=lnt>50&#10;</span><span class=lnt>51&#10;</span><span class=lnt>52&#10;</span><span class=lnt>53&#10;</span><span class=lnt>54&#10;</span><span class=lnt>55&#10;</span><span class=lnt>56&#10;</span><span class=lnt>57&#10;</span><span class=lnt>58&#10;</span><span class=lnt>59&#10;</span><span class=lnt>60&#10;</span><span class=lnt>61&#10;</span><span class=lnt>62&#10;</span><span class=lnt>63&#10;</span><span class=lnt>64&#10;</span><span class=lnt>65&#10;</span><span class=lnt>66&#10;</span><span class=lnt>67&#10;</span><span class=lnt>68&#10;</span><span class=lnt>69&#10;</span><span class=lnt>70&#10;</span><span class=lnt>71&#10;</span><span class=lnt>72&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ curl -v --cacert ca.crt --cert client.crt --key client.key <span class=s2>&#34;https://localhost/&#34;</span>&#10;*   Trying ::1...&#10;* TCP_NODELAY <span class=nb>set</span>&#10;* Connected to localhost <span class=o>(</span>::1<span class=o>)</span> port <span class=m>443</span> <span class=o>(</span><span class=c1>#0)</span>&#10;* ALPN, offering h2&#10;* ALPN, offering http/1.1&#10;* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH&#10;* successfully <span class=nb>set</span> certificate verify locations:&#10;*   CAfile: ca.crt&#10;  CApath: none&#10;* TLSv1.2 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Client hello <span class=o>(</span>1<span class=o>)</span>:&#10;* TLSv1.2 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server hello <span class=o>(</span>2<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Certificate <span class=o>(</span>11<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server key exchange <span class=o>(</span>12<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Request CERT <span class=o>(</span>13<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server finished <span class=o>(</span>14<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Certificate <span class=o>(</span>11<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Client key exchange <span class=o>(</span>16<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, CERT verify <span class=o>(</span>15<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS change cipher, Client hello <span class=o>(</span>1<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Finished <span class=o>(</span>20<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Finished <span class=o>(</span>20<span class=o>)</span>:&#10;* SSL connection using TLSv1.0 / ECDHE-RSA-AES256-SHA&#10;* ALPN, server accepted to use http/1.1&#10;* Server certificate:&#10;*  subject: <span class=nv>C</span><span class=o>=</span>ES<span class=p>;</span> <span class=nv>ST</span><span class=o>=</span>Spain<span class=p>;</span> <span class=nv>O</span><span class=o>=</span>Blog Bitix<span class=p>;</span> <span class=nv>CN</span><span class=o>=</span>localhost&#10;*  start date: Jun <span class=m>16</span> 22:16:18 <span class=m>2017</span> GMT&#10;*  expire date: Jun <span class=m>15</span> 22:16:18 <span class=m>2022</span> GMT&#10;*  common name: localhost <span class=o>(</span>matched<span class=o>)</span>&#10;*  issuer: <span class=nv>C</span><span class=o>=</span>ES<span class=p>;</span> <span class=nv>ST</span><span class=o>=</span>Spain<span class=p>;</span> <span class=nv>O</span><span class=o>=</span>Blog Bitix Certiticate Authority&#10;*  SSL certificate verify ok.&#10;&gt; GET / HTTP/1.1&#10;&gt; Host: localhost&#10;&gt; User-Agent: curl/7.54.1&#10;&gt; Accept: */*&#10;&gt;&#10;&lt; HTTP/1.1 <span class=m>200</span> OK&#10;&lt; Server: nginx/1.13.0&#10;&lt; Date: Fri, <span class=m>16</span> Jun <span class=m>2017</span> 22:30:06 GMT&#10;&lt; Content-Type: text/html&#10;&lt; Content-Length: <span class=m>612</span>&#10;&lt; Last-Modified: Tue, <span class=m>25</span> Apr <span class=m>2017</span> 17:23:03 GMT&#10;&lt; Connection: keep-alive&#10;&lt; ETag: <span class=s2>&#34;58ff85f7-264&#34;</span>&#10;&lt; Accept-Ranges: bytes&#10;&lt;&#10;&lt;!DOCTYPE html&gt;&#10;&lt;html&gt;&#10;&lt;head&gt;&#10;&lt;title&gt;Welcome to nginx!&lt;/title&gt;&#10;&lt;style&gt;&#10;&nbsp;&nbsp;&nbsp;&nbsp;body <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width: 35em<span class=p>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin: <span class=m>0</span> auto<span class=p>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family: Tahoma, Verdana, Arial, sans-serif<span class=p>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&lt;/style&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;&#10;&lt;p&gt;If you see this page, the nginx web server is successfully installed and&#10;working. Further configuration is required.&lt;/p&gt;&#10;&#10;&lt;p&gt;For online documentation and support please refer to&#10;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;http://nginx.org/&#34;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;&#10;Commercial support is available at&#10;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;http://nginx.com/&#34;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;&#10;&#10;&lt;p&gt;&lt;em&gt;Thank you <span class=k>for</span> using nginx.&lt;/em&gt;&lt;/p&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&#10;* Connection <span class=c1>#0 to host localhost left intact</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/curl.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/curl.sh target=_blank>curl.sh</a></div></div><p>Si se intenta realizar una petición sin certificado de cliente o con un certificado de cliente en el que no confié el servidor (que no esté firmado por la autoridad de certificación en la que confía) se devolverá un código de estado 400 que indica que la petición se ha rechazado. También el cliente advertirá si la autoridad de certificación en la que confía no valida el certificado del servidor con un error 400 y título <em>400 The SSL certificate error</em>.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>  1&#10;</span><span class=lnt>  2&#10;</span><span class=lnt>  3&#10;</span><span class=lnt>  4&#10;</span><span class=lnt>  5&#10;</span><span class=lnt>  6&#10;</span><span class=lnt>  7&#10;</span><span class=lnt>  8&#10;</span><span class=lnt>  9&#10;</span><span class=lnt> 10&#10;</span><span class=lnt> 11&#10;</span><span class=lnt> 12&#10;</span><span class=lnt> 13&#10;</span><span class=lnt> 14&#10;</span><span class=lnt> 15&#10;</span><span class=lnt> 16&#10;</span><span class=lnt> 17&#10;</span><span class=lnt> 18&#10;</span><span class=lnt> 19&#10;</span><span class=lnt> 20&#10;</span><span class=lnt> 21&#10;</span><span class=lnt> 22&#10;</span><span class=lnt> 23&#10;</span><span class=lnt> 24&#10;</span><span class=lnt> 25&#10;</span><span class=lnt> 26&#10;</span><span class=lnt> 27&#10;</span><span class=lnt> 28&#10;</span><span class=lnt> 29&#10;</span><span class=lnt> 30&#10;</span><span class=lnt> 31&#10;</span><span class=lnt> 32&#10;</span><span class=lnt> 33&#10;</span><span class=lnt> 34&#10;</span><span class=lnt> 35&#10;</span><span class=lnt> 36&#10;</span><span class=lnt> 37&#10;</span><span class=lnt> 38&#10;</span><span class=lnt> 39&#10;</span><span class=lnt> 40&#10;</span><span class=lnt> 41&#10;</span><span class=lnt> 42&#10;</span><span class=lnt> 43&#10;</span><span class=lnt> 44&#10;</span><span class=lnt> 45&#10;</span><span class=lnt> 46&#10;</span><span class=lnt> 47&#10;</span><span class=lnt> 48&#10;</span><span class=lnt> 49&#10;</span><span class=lnt> 50&#10;</span><span class=lnt> 51&#10;</span><span class=lnt> 52&#10;</span><span class=lnt> 53&#10;</span><span class=lnt> 54&#10;</span><span class=lnt> 55&#10;</span><span class=lnt> 56&#10;</span><span class=lnt> 57&#10;</span><span class=lnt> 58&#10;</span><span class=lnt> 59&#10;</span><span class=lnt> 60&#10;</span><span class=lnt> 61&#10;</span><span class=lnt> 62&#10;</span><span class=lnt> 63&#10;</span><span class=lnt> 64&#10;</span><span class=lnt> 65&#10;</span><span class=lnt> 66&#10;</span><span class=lnt> 67&#10;</span><span class=lnt> 68&#10;</span><span class=lnt> 69&#10;</span><span class=lnt> 70&#10;</span><span class=lnt> 71&#10;</span><span class=lnt> 72&#10;</span><span class=lnt> 73&#10;</span><span class=lnt> 74&#10;</span><span class=lnt> 75&#10;</span><span class=lnt> 76&#10;</span><span class=lnt> 77&#10;</span><span class=lnt> 78&#10;</span><span class=lnt> 79&#10;</span><span class=lnt> 80&#10;</span><span class=lnt> 81&#10;</span><span class=lnt> 82&#10;</span><span class=lnt> 83&#10;</span><span class=lnt> 84&#10;</span><span class=lnt> 85&#10;</span><span class=lnt> 86&#10;</span><span class=lnt> 87&#10;</span><span class=lnt> 88&#10;</span><span class=lnt> 89&#10;</span><span class=lnt> 90&#10;</span><span class=lnt> 91&#10;</span><span class=lnt> 92&#10;</span><span class=lnt> 93&#10;</span><span class=lnt> 94&#10;</span><span class=lnt> 95&#10;</span><span class=lnt> 96&#10;</span><span class=lnt> 97&#10;</span><span class=lnt> 98&#10;</span><span class=lnt> 99&#10;</span><span class=lnt>100&#10;</span><span class=lnt>101&#10;</span><span class=lnt>102&#10;</span><span class=lnt>103&#10;</span><span class=lnt>104&#10;</span><span class=lnt>105&#10;</span><span class=lnt>106&#10;</span><span class=lnt>107&#10;</span><span class=lnt>108&#10;</span><span class=lnt>109&#10;</span><span class=lnt>110&#10;</span><span class=lnt>111&#10;</span><span class=lnt>112&#10;</span><span class=lnt>113&#10;</span><span class=lnt>114&#10;</span><span class=lnt>115&#10;</span><span class=lnt>116&#10;</span><span class=lnt>117&#10;</span><span class=lnt>118&#10;</span><span class=lnt>119&#10;</span><span class=lnt>120&#10;</span><span class=lnt>121&#10;</span><span class=lnt>122&#10;</span><span class=lnt>123&#10;</span><span class=lnt>124&#10;</span><span class=lnt>125&#10;</span><span class=lnt>126&#10;</span><span class=lnt>127&#10;</span><span class=lnt>128&#10;</span><span class=lnt>129&#10;</span><span class=lnt>130&#10;</span><span class=lnt>131&#10;</span><span class=lnt>132&#10;</span><span class=lnt>133&#10;</span><span class=lnt>134&#10;</span><span class=lnt>135&#10;</span><span class=lnt>136&#10;</span><span class=lnt>137&#10;</span><span class=lnt>138&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ curl -v --cacert ca.crt <span class=s2>&#34;https://localhost/&#34;</span>&#10;*   Trying ::1...&#10;* TCP_NODELAY <span class=nb>set</span>&#10;* Connected to localhost <span class=o>(</span>::1<span class=o>)</span> port <span class=m>443</span> <span class=o>(</span><span class=c1>#0)</span>&#10;* ALPN, offering h2&#10;* ALPN, offering http/1.1&#10;* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH&#10;* successfully <span class=nb>set</span> certificate verify locations:&#10;*   CAfile: ca.crt&#10;  CApath: none&#10;* TLSv1.2 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Client hello <span class=o>(</span>1<span class=o>)</span>:&#10;* TLSv1.2 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server hello <span class=o>(</span>2<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Certificate <span class=o>(</span>11<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server key exchange <span class=o>(</span>12<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Request CERT <span class=o>(</span>13<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server finished <span class=o>(</span>14<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Certificate <span class=o>(</span>11<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Client key exchange <span class=o>(</span>16<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS change cipher, Client hello <span class=o>(</span>1<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Finished <span class=o>(</span>20<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Finished <span class=o>(</span>20<span class=o>)</span>:&#10;* SSL connection using TLSv1.0 / ECDHE-RSA-AES256-SHA&#10;* ALPN, server accepted to use http/1.1&#10;* Server certificate:&#10;*  subject: <span class=nv>C</span><span class=o>=</span>ES<span class=p>;</span> <span class=nv>ST</span><span class=o>=</span>Spain<span class=p>;</span> <span class=nv>O</span><span class=o>=</span>Blog Bitix<span class=p>;</span> <span class=nv>CN</span><span class=o>=</span>localhost&#10;*  start date: Jun <span class=m>16</span> 22:16:18 <span class=m>2017</span> GMT&#10;*  expire date: Jun <span class=m>15</span> 22:16:18 <span class=m>2022</span> GMT&#10;*  common name: localhost <span class=o>(</span>matched<span class=o>)</span>&#10;*  issuer: <span class=nv>C</span><span class=o>=</span>ES<span class=p>;</span> <span class=nv>ST</span><span class=o>=</span>Spain<span class=p>;</span> <span class=nv>O</span><span class=o>=</span>Blog Bitix Certiticate Authority&#10;*  SSL certificate verify ok.&#10;&gt; GET / HTTP/1.1&#10;&gt; Host: localhost&#10;&gt; User-Agent: curl/7.54.1&#10;&gt; Accept: */*&#10;&gt;&#10;&lt; HTTP/1.1 <span class=m>400</span> Bad Request&#10;&lt; Server: nginx/1.13.0&#10;&lt; Date: Fri, <span class=m>16</span> Jun <span class=m>2017</span> 22:30:49 GMT&#10;&lt; Content-Type: text/html&#10;&lt; Content-Length: <span class=m>253</span>&#10;&lt; Connection: close&#10;&lt;&#10;&lt;html&gt;&#10;&lt;head&gt;&lt;title&gt;400 No required SSL certificate was sent&lt;/title&gt;&lt;/head&gt;&#10;&lt;body <span class=nv>bgcolor</span><span class=o>=</span><span class=s2>&#34;white&#34;</span>&gt;&#10;&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;&#10;&lt;center&gt;No required SSL certificate was sent&lt;/center&gt;&#10;&lt;hr&gt;&lt;center&gt;nginx/1.13.0&lt;/center&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&#10;* Closing connection <span class=m>0</span>&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS alert, Client hello <span class=o>(</span>1<span class=o>)</span>:&#10;&#10;$ curl -v --cacert ca.crt --cert client-unknown.crt --key client-unknown.key <span class=s2>&#34;https://localhost/&#34;</span>&#10;*   Trying ::1...&#10;* TCP_NODELAY <span class=nb>set</span>&#10;* Connected to localhost <span class=o>(</span>::1<span class=o>)</span> port <span class=m>443</span> <span class=o>(</span><span class=c1>#0)</span>&#10;* ALPN, offering h2&#10;* ALPN, offering http/1.1&#10;* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH&#10;* successfully <span class=nb>set</span> certificate verify locations:&#10;*   CAfile: ca.crt&#10;  CApath: none&#10;* TLSv1.2 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Client hello <span class=o>(</span>1<span class=o>)</span>:&#10;* TLSv1.2 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server hello <span class=o>(</span>2<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Certificate <span class=o>(</span>11<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server key exchange <span class=o>(</span>12<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Request CERT <span class=o>(</span>13<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server finished <span class=o>(</span>14<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Certificate <span class=o>(</span>11<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Client key exchange <span class=o>(</span>16<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, CERT verify <span class=o>(</span>15<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS change cipher, Client hello <span class=o>(</span>1<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Finished <span class=o>(</span>20<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Finished <span class=o>(</span>20<span class=o>)</span>:&#10;* SSL connection using TLSv1.0 / ECDHE-RSA-AES256-SHA&#10;* ALPN, server accepted to use http/1.1&#10;* Server certificate:&#10;*  subject: <span class=nv>C</span><span class=o>=</span>ES<span class=p>;</span> <span class=nv>ST</span><span class=o>=</span>Spain<span class=p>;</span> <span class=nv>O</span><span class=o>=</span>Blog Bitix<span class=p>;</span> <span class=nv>CN</span><span class=o>=</span>localhost&#10;*  start date: Jun <span class=m>16</span> 22:16:18 <span class=m>2017</span> GMT&#10;*  expire date: Jun <span class=m>15</span> 22:16:18 <span class=m>2022</span> GMT&#10;*  common name: localhost <span class=o>(</span>matched<span class=o>)</span>&#10;*  issuer: <span class=nv>C</span><span class=o>=</span>ES<span class=p>;</span> <span class=nv>ST</span><span class=o>=</span>Spain<span class=p>;</span> <span class=nv>O</span><span class=o>=</span>Blog Bitix Certiticate Authority&#10;*  SSL certificate verify ok.&#10;&gt; GET / HTTP/1.1&#10;&gt; Host: localhost&#10;&gt; User-Agent: curl/7.54.1&#10;&gt; Accept: */*&#10;&gt;&#10;&lt; HTTP/1.1 <span class=m>400</span> Bad Request&#10;&lt; Server: nginx/1.13.0&#10;&lt; Date: Fri, <span class=m>16</span> Jun <span class=m>2017</span> 22:32:55 GMT&#10;&lt; Content-Type: text/html&#10;&lt; Content-Length: <span class=m>231</span>&#10;&lt; Connection: close&#10;&lt;&#10;&lt;html&gt;&#10;&lt;head&gt;&lt;title&gt;400 The SSL certificate error&lt;/title&gt;&lt;/head&gt;&#10;&lt;body <span class=nv>bgcolor</span><span class=o>=</span><span class=s2>&#34;white&#34;</span>&gt;&#10;&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;&#10;&lt;center&gt;The SSL certificate error&lt;/center&gt;&#10;&lt;hr&gt;&lt;center&gt;nginx/1.13.0&lt;/center&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&#10;* Closing connection <span class=m>0</span>&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS alert, Client hello <span class=o>(</span>1<span class=o>)</span>:&#10;&#10;$ curl -v --cacert ca-unknown.crt --cert client.crt --key client.key <span class=s2>&#34;https://localhost/&#34;</span>&#10;*   Trying ::1...&#10;* TCP_NODELAY <span class=nb>set</span>&#10;* Connected to localhost <span class=o>(</span>::1<span class=o>)</span> port <span class=m>443</span> <span class=o>(</span><span class=c1>#0)</span>&#10;* ALPN, offering h2&#10;* ALPN, offering http/1.1&#10;* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH&#10;* successfully <span class=nb>set</span> certificate verify locations:&#10;*   CAfile: ca-unknown.crt&#10;  CApath: none&#10;* TLSv1.2 <span class=o>(</span>OUT<span class=o>)</span>, TLS handshake, Client hello <span class=o>(</span>1<span class=o>)</span>:&#10;* TLSv1.2 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Server hello <span class=o>(</span>2<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>IN<span class=o>)</span>, TLS handshake, Certificate <span class=o>(</span>11<span class=o>)</span>:&#10;* TLSv1.0 <span class=o>(</span>OUT<span class=o>)</span>, TLS alert, Server hello <span class=o>(</span>2<span class=o>)</span>:&#10;* SSL certificate problem: unable to get <span class=nb>local</span> issuer certificate&#10;* stopped the pause stream!&#10;* Closing connection <span class=m>0</span>&#10;curl: <span class=o>(</span>60<span class=o>)</span> SSL certificate problem: unable to get <span class=nb>local</span> issuer certificate&#10;More details here: https://curl.haxx.se/docs/sslcerts.html&#10;&#10;curl performs SSL certificate verification by default, using a <span class=s2>&#34;bundle&#34;</span>&#10; of Certificate Authority <span class=o>(</span>CA<span class=o>)</span> public keys <span class=o>(</span>CA certs<span class=o>)</span>. If the default&#10; bundle file isn<span class=s1>&#39;t adequate, you can specify an alternate file&#10;</span><span class=s1> using the --cacert option.&#10;</span><span class=s1>If this HTTPS server uses a certificate signed by a CA represented in&#10;</span><span class=s1> the bundle, the certificate verification probably failed due to a&#10;</span><span class=s1> problem with the certificate (it might be expired, or the name might&#10;</span><span class=s1> not match the domain name in the URL).&#10;</span><span class=s1>If you&#39;</span>d like to turn off curl<span class=err>&#39;</span>s verification of the certificate, use&#10; the -k <span class=o>(</span>or --insecure<span class=o>)</span> option.&#10;HTTPS-proxy has similar options --proxy-cacert and --proxy-insecure.</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/curl-unknown.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/curl-unknown.sh target=_blank>curl-unknown.sh</a></div></div><p>El siguiente <em>script</em> escrito en lenguaje <a href=https://www.groovy-lang.org/>Groovy</a> muestra como desde un programa para la plataforma Java se realiza autenticación mutua y que error da cuando alguno de los certificados es inválido ya sea el del cliente o el del servidor. Generando previamente los <em>keystores</em> de la autoridad de certificado y del cliente introduciendo como clave en el ejemplo <em>password</em> cuando se solicita.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span><span class=lnt>2&#10;</span><span class=lnt>3&#10;</span><span class=lnt>4&#10;</span><span class=lnt>5&#10;</span><span class=lnt>6&#10;</span><span class=lnt>7&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ keytool -importcert -keystore ca.jks -trustcacerts -alias ca -file ca.crt&#10;$ openssl pkcs12 -export -out client.p12 -inkey client.key -in client.crt&#10;$ keytool -importkeystore -destkeystore client.jks -srckeystore client.p12 -srcstoretype pkcs12&#10;&#10;$ keytool -importcert -keystore ca-unknown.jks -trustcacerts -alias ca -file ca-unknown.crt&#10;$ openssl pkcs12 -export -out client-unknown.p12 -inkey client-unknown.key -in client-unknown.crt&#10;$ keytool -importkeystore -destkeystore client-unknown.jks -srckeystore client-unknown.p12 -srcstoretype pkcs12</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/keytool.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/keytool.sh target=_blank>keytool.sh</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span><span class=lnt>17&#10;</span><span class=lnt>18&#10;</span><span class=lnt>19&#10;</span><span class=lnt>20&#10;</span><span class=lnt>21&#10;</span><span class=lnt>22&#10;</span><span class=lnt>23&#10;</span><span class=lnt>24&#10;</span><span class=lnt>25&#10;</span><span class=lnt>26&#10;</span><span class=lnt>27&#10;</span><span class=lnt>28&#10;</span><span class=lnt>29&#10;</span><span class=lnt>30&#10;</span><span class=lnt>31&#10;</span><span class=lnt>32&#10;</span><span class=lnt>33&#10;</span><span class=lnt>34&#10;</span><span class=lnt>35&#10;</span><span class=lnt>36&#10;</span><span class=lnt>37&#10;</span><span class=lnt>38&#10;</span><span class=lnt>39&#10;</span><span class=lnt>40&#10;</span><span class=lnt>41&#10;</span><span class=lnt>42&#10;</span><span class=lnt>43&#10;</span><span class=lnt>44&#10;</span><span class=lnt>45&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-groovy data-lang=groovy><span class=nd>@Grab</span><span class=o>(</span><span class=n>group</span><span class=o>=</span><span class=s1>&#39;javax.activation&#39;</span><span class=o>,</span> <span class=n>module</span><span class=o>=</span><span class=s1>&#39;activation&#39;</span><span class=o>,</span> <span class=n>version</span><span class=o>=</span><span class=s1>&#39;1.1.1&#39;</span><span class=o>)</span> &#10;<span class=nd>@Grab</span><span class=o>(</span><span class=n>group</span><span class=o>=</span><span class=s1>&#39;javax&#39;</span><span class=o>,</span> <span class=n>module</span><span class=o>=</span><span class=s1>&#39;javaee-api&#39;</span><span class=o>,</span> <span class=n>version</span><span class=o>=</span><span class=s1>&#39;7.0&#39;</span><span class=o>)</span>&#10;<span class=nd>@Grab</span><span class=o>(</span><span class=n>group</span><span class=o>=</span><span class=s1>&#39;org.glassfish.jersey.core&#39;</span><span class=o>,</span> <span class=n>module</span><span class=o>=</span><span class=s1>&#39;jersey-client&#39;</span><span class=o>,</span> <span class=n>version</span><span class=o>=</span><span class=s1>&#39;2.25.1&#39;</span><span class=o>)</span>&#10;&#10;<span class=kn>import</span> <span class=nn>javax.net.ssl.KeyManagerFactory</span>&#10;<span class=kn>import</span> <span class=nn>javax.net.ssl.SSLContext</span>&#10;<span class=kn>import</span> <span class=nn>javax.net.ssl.TrustManagerFactory</span>&#10;<span class=kn>import</span> <span class=nn>javax.ws.rs.client.Client</span>&#10;<span class=kn>import</span> <span class=nn>javax.ws.rs.client.ClientBuilder</span>&#10;<span class=kn>import</span> <span class=nn>javax.ws.rs.client.Entity</span>&#10;<span class=kn>import</span> <span class=nn>javax.ws.rs.core.Response</span>&#10;<span class=kn>import</span> <span class=nn>java.security.KeyStore</span>&#10;&#10;<span class=kn>import</span> <span class=nn>org.glassfish.jersey.SslConfigurator</span>&#10;&#10;<span class=kd>class</span> <span class=nc>Main</span> <span class=o>{</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kt>void</span> <span class=nf>get</span><span class=o>(</span><span class=o>)</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>Response</span> <span class=n>response</span> <span class=o>=</span> <span class=n>buildSslClient</span><span class=o>(</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=na>target</span><span class=o>(</span><span class=s2>&#34;https://localhost&#34;</span><span class=o>)</span><span class=o>.</span><span class=na>path</span><span class=o>(</span><span class=s2>&#34;/&#34;</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=na>request</span><span class=o>(</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=na>header</span><span class=o>(</span><span class=s2>&#34;Accept&#34;</span><span class=o>,</span> <span class=s2>&#34;text/html&#34;</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=o>)</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>println</span><span class=o>(</span><span class=n>response</span><span class=o>.</span><span class=na>getStatus</span><span class=o>(</span><span class=o>)</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>println</span><span class=o>(</span><span class=n>response</span><span class=o>.</span><span class=na>readEntity</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>class</span><span class=o>)</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=n>Client</span> <span class=nf>buildSslClient</span><span class=o>(</span><span class=o>)</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>return</span> <span class=n>ClientBuilder</span><span class=o>.</span><span class=na>newBuilder</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>sslContext</span><span class=o>(</span><span class=n>buildSslContext</span><span class=o>(</span><span class=o>)</span><span class=o>)</span><span class=o>.</span><span class=na>build</span><span class=o>(</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=n>SSLContext</span> <span class=nf>buildSslContext</span><span class=o>(</span><span class=o>)</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>return</span> <span class=n>SslConfigurator</span><span class=o>.</span><span class=na>newInstance</span><span class=o>(</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=na>trustStoreFile</span><span class=o>(</span><span class=s2>&#34;ca.jks&#34;</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c1>//.trustStoreFile(&#34;ca-unknown.jks&#34;)&#10;</span><span class=c1></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=na>trustStorePassword</span><span class=o>(</span><span class=s2>&#34;password&#34;</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=na>keyStoreFile</span><span class=o>(</span><span class=s2>&#34;client.jks&#34;</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c1>//.keyStoreFile(&#34;client-unknown.jks&#34;)&#10;</span><span class=c1></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=na>keyPassword</span><span class=o>(</span><span class=s2>&#34;password&#34;</span><span class=o>)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=na>createSSLContext</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;<span class=o>}</span>&#10;&#10;<span class=k>new</span> <span class=nf>Main</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=o>)</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/MutualCertAuth.groovy target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/MutualCertAuth.groovy target=_blank>MutualCertAuth.groovy</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span><span class=lnt>17&#10;</span><span class=lnt>18&#10;</span><span class=lnt>19&#10;</span><span class=lnt>20&#10;</span><span class=lnt>21&#10;</span><span class=lnt>22&#10;</span><span class=lnt>23&#10;</span><span class=lnt>24&#10;</span><span class=lnt>25&#10;</span><span class=lnt>26&#10;</span><span class=lnt>27&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ groovy MutualCertAuth.groovy&#10;<span class=m>200</span>&#10;&lt;!DOCTYPE html&gt;&#10;&lt;html&gt;&#10;&lt;head&gt;&#10;&lt;title&gt;Welcome to nginx!&lt;/title&gt;&#10;&lt;style&gt;&#10;&nbsp;&nbsp;&nbsp;&nbsp;body <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width: 35em<span class=p>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin: <span class=m>0</span> auto<span class=p>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family: Tahoma, Verdana, Arial, sans-serif<span class=p>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&lt;/style&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;&#10;&lt;p&gt;If you see this page, the nginx web server is successfully installed and&#10;working. Further configuration is required.&lt;/p&gt;&#10;&#10;&lt;p&gt;For online documentation and support please refer to&#10;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;http://nginx.org/&#34;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;&#10;Commercial support is available at&#10;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;http://nginx.com/&#34;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;&#10;&#10;&lt;p&gt;&lt;em&gt;Thank you <span class=k>for</span> using nginx.&lt;/em&gt;&lt;/p&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/groovy.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/groovy.sh target=_blank>groovy.sh</a></div></div><p>En caso de que al usar un <em>keystore</em> con un certificado de una autoridad que no valida el certificado del servidor se producirán un error, también cuando el certificado del cliente no sea válido para el servidor.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span><span class=lnt>17&#10;</span><span class=lnt>18&#10;</span><span class=lnt>19&#10;</span><span class=lnt>20&#10;</span><span class=lnt>21&#10;</span><span class=lnt>22&#10;</span><span class=lnt>23&#10;</span><span class=lnt>24&#10;</span><span class=lnt>25&#10;</span><span class=lnt>26&#10;</span><span class=lnt>27&#10;</span><span class=lnt>28&#10;</span><span class=lnt>29&#10;</span><span class=lnt>30&#10;</span><span class=lnt>31&#10;</span><span class=lnt>32&#10;</span><span class=lnt>33&#10;</span><span class=lnt>34&#10;</span><span class=lnt>35&#10;</span><span class=lnt>36&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ groovy MutualCertAuth.groovy <span class=c1># with code change .trustStoreFile(&#34;ca-unknown.jks&#34;)</span>&#10;Caught: javax.ws.rs.ProcessingException: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&#10;javax.ws.rs.ProcessingException: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&#10;	at org.glassfish.jersey.client.internal.HttpUrlConnector.apply<span class=o>(</span>HttpUrlConnector.java:287<span class=o>)</span>&#10;	at org.glassfish.jersey.client.ClientRuntime.invoke<span class=o>(</span>ClientRuntime.java:252<span class=o>)</span>&#10;	at org.glassfish.jersey.client.JerseyInvocation<span class=nv>$1</span>.call<span class=o>(</span>JerseyInvocation.java:684<span class=o>)</span>&#10;	at org.glassfish.jersey.client.JerseyInvocation<span class=nv>$1</span>.call<span class=o>(</span>JerseyInvocation.java:681<span class=o>)</span>&#10;	at org.glassfish.jersey.internal.Errors.process<span class=o>(</span>Errors.java:315<span class=o>)</span>&#10;	at org.glassfish.jersey.internal.Errors.process<span class=o>(</span>Errors.java:297<span class=o>)</span>&#10;	at org.glassfish.jersey.internal.Errors.process<span class=o>(</span>Errors.java:228<span class=o>)</span>&#10;	at org.glassfish.jersey.process.internal.RequestScope.runInScope<span class=o>(</span>RequestScope.java:444<span class=o>)</span>&#10;	at org.glassfish.jersey.client.JerseyInvocation.invoke<span class=o>(</span>JerseyInvocation.java:681<span class=o>)</span>&#10;	at org.glassfish.jersey.client.JerseyInvocation<span class=nv>$Builder</span>.method<span class=o>(</span>JerseyInvocation.java:411<span class=o>)</span>&#10;	at org.glassfish.jersey.client.JerseyInvocation<span class=nv>$Builder</span>.get<span class=o>(</span>JerseyInvocation.java:311<span class=o>)</span>&#10;	at Main.get<span class=o>(</span>MutualCertAuth.groovy:19<span class=o>)</span>&#10;	at Main<span class=nv>$get</span>.call<span class=o>(</span>Unknown Source<span class=o>)</span>&#10;	at MutualCertAuth.run<span class=o>(</span>MutualCertAuth.groovy:43<span class=o>)</span>&#10;Caused by: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&#10;	at org.glassfish.jersey.client.internal.HttpUrlConnector._apply<span class=o>(</span>HttpUrlConnector.java:399<span class=o>)</span>&#10;	at org.glassfish.jersey.client.internal.HttpUrlConnector.apply<span class=o>(</span>HttpUrlConnector.java:285<span class=o>)</span>&#10;	... <span class=m>13</span> more&#10;Caused by: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&#10;	... <span class=m>15</span> more&#10;Caused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&#10;	... <span class=m>15</span> more&#10;&#10;$ groovy MutualCertAuth.groovy <span class=c1># with code change .keyStoreFile(&#34;client-unknown.jks&#34;)</span>&#10;<span class=m>400</span>&#10;&lt;html&gt;&#10;&lt;head&gt;&lt;title&gt;400 No required SSL certificate was sent&lt;/title&gt;&lt;/head&gt;&#10;&lt;body <span class=nv>bgcolor</span><span class=o>=</span><span class=s2>&#34;white&#34;</span>&gt;&#10;&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;&#10;&lt;center&gt;No required SSL certificate was sent&lt;/center&gt;&#10;&lt;hr&gt;&lt;center&gt;nginx/1.13.0&lt;/center&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/groovy-unknown.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/code/groovy-unknown.sh target=_blank>groovy-unknown.sh</a></div></div><p>Lo anterior es usando la herramienta <em>curl</em> o un un programa en la plataforma Java, en el caso de querer realizar autenticación mutua con un navegador web como <a href=https://www.mozilla.org/es-ES/firefox/new/>Firefox</a> hay que instalar el certificado del cliente y si es necesario el certificado de la autoridad de certificación para que el candado indicativo de la seguridad del protocolo HTTPS se muestre en verde y no indique ningún problema de seguridad en la autenticación del servidor. En Firefox los certificados se añaden en el menú <em>Preferencias > Avanzado > Ver certficados</em>. En la pestaña <em>Sus certificados</em> hay que importar el certificado del cliente en formato <em>PKCS12</em> y en la pestaña <em>Autoridades</em> el certificado de la autoridad que haya firmado el certificado del servidor, con el botón <em>Importar</em> se selecciona el archivo <em>crt</em> de la autoridad. Al introducir la URL y realizar la petición Firefox solicita mediante un diálogo seleccionar el certificado a usar para realizar la autenticación en el servidor.</p><div class=media><figure><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-bad-request_hu3d9115ae669622df0d998ed96444e229_29792_2560x1440_fit_box_2.png title="Autenticación mutua fallida" data-gallery=data-gallery><img data-src=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-bad-request_hu3d9115ae669622df0d998ed96444e229_29792_300x250_fit_box_2.png width=300 height=204 class=lozad></a>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-mutual-authorized_hu21193e48d3d482f312b4ea4a564e67fd_41438_2560x1440_fit_box_2.png title="Autenticación mutua correcta" data-gallery=data-gallery><img data-src=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-mutual-authorized_hu21193e48d3d482f312b4ea4a564e67fd_41438_300x250_fit_box_2.png width=300 height=204 class=lozad></a>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-server-cert_hu1d9bffb9f5c100af990526d53b88278c_39053_2560x1440_fit_box_2.png title="Certificado del servidor validado por la CA" data-gallery=data-gallery><img data-src=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-server-cert_hu1d9bffb9f5c100af990526d53b88278c_39053_300x250_fit_box_2.png width=300 height=204 class=lozad></a></figure></div><div class=media><figure><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-certs_hueb543905d41759bbe5a764bb74f95c42_34897_2560x1440_fit_box_2.png title="Certificados de cliente" data-gallery=data-gallery><img data-src=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-certs_hueb543905d41759bbe5a764bb74f95c42_34897_300x250_fit_box_2.png width=300 height=169 class=lozad></a>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-cas_huf2ba739f3324fedc682eb0901881a9fc_53688_2560x1440_fit_box_2.png title="Certificados de la autoridades de certificación" data-gallery=data-gallery><img data-src=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-cas_huf2ba739f3324fedc682eb0901881a9fc_53688_300x250_fit_box_2.png width=300 height=169 class=lozad></a>
<a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-ca_hu06fe95553699a7e0d101265d04edfdcb_36230_2560x1440_fit_box_2.png title="Añadir certificado de CA" data-gallery=data-gallery><img data-src=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-ca_hu06fe95553699a7e0d101265d04edfdcb_36230_300x250_fit_box_2.png width=300 height=165 class=lozad></a></figure></div><div class=media><figure><a href=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-select-cert_hu1debe2f021cf39b50ccef97256514718_46013_2560x1440_fit_box_2.png title="Selección de certificado de cliente" data-gallery=data-gallery><img data-src=/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/images/firefox-select-cert_hu1debe2f021cf39b50ccef97256514718_46013_300x250_fit_box_2.png width=265 height=250 class=lozad></a><figcaption>Autenticación mutua de cliente y servidor con el navegador web Firefox</figcaption></figure></div><p>El <a href=https://github.com/picodotdev/blog-ejemplos/tree/master/MutualCertAuth>código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en <a href=https://github.com/>GitHub</a> y probarlo en tu equipo ejecutando el comando <code>docker-compose up, groovy MutualCertAuth.groovy</code>.</p><div class=reference>Referencia:<br><ul><li><a href=https://picodotdev.github.io/blog-bitix/series/docker/>Serie de artículos sobre Docker</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2015/04/guardar-contrasenas-usando-salted-password-hashing-y-otras-formas-correctas/>Guardar contraseñas usando «Salted Password Hashing» y otras formas correctas</a></li></ul></div></div></article><div class="row serie"><div class=col-md-12><h3>Este artículo forma parte de la serie <strong>web</strong>:</h3><ol class=serie-articles><li><a href=https://picodotdev.github.io/blog-bitix/2014/02/generar-y-convertir-claves-y-certificados-con-openssl/>Generar y convertir claves y certificados con OpenSSL</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2014/02/configurar-ssl-en-un-servidor-tomcat-jboss-wildfly-lighttpd-nginx-apache/>Configurar SSL/TLS en un servidor Tomcat, JBoss, WildFly, Lighttpd, Nginx o Apache</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2015/04/certificado-ssl-de-empresa-wildcard-y-de-validacion-extendida/>Certificado SSL, de empresa, «wildcard» y de validación extendida</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2016/02/introduccion-al-protocolo-http-2/>Introducción al protocolo HTTP/2</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2016/02/configurar-http-2-en-nginx-apache-httpd-wildfly-o-jetty/>Configurar HTTP/2 en Nginx, Apache HTTPD, WildFly o Jetty</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2016/06/como-redirigir-peticiones-de-http-a-https-en-nginx-apache-tomcat-jetty-y-wildfly/>Cómo redirigir peticiones de HTTP a HTTPS en Nginx, Apache, Tomcat, Jetty y WildFly</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2016/07/como-optimizar-un-sitio-web-con-compresion-gzip-en-nginx-y-apache-httpd/>Cómo optimizar un sitio web con compresión GZIP en Nginx y Apache HTTPD</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2016/07/configurar-nginx-como-balanceador-de-carga/>Configurar Nginx como balanceador de carga</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2016/07/como-crear-un-proxy-inverso-entre-el-servidor-web-nginx-y-un-servidor-de-aplicaciones-java/>Cómo crear un proxy inverso entre el servidor web Nginx y un servidor de aplicaciones Java</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2016/07/las-cabeceras-de-cache-del-protocolo-http/>Las cabeceras de cache del protocolo HTTP</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2016/07/configurar-nginx-para-cachear-respuestas-del-servidor-de-aplicaciones/>Configurar Nginx para cachear respuestas del servidor de aplicaciones</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2016/08/como-y-por-que-redirigir-trafico-web-del-dominio-raiz-al-subdominio-www/>Cómo y por que redirigir tráfico web del dominio raíz al subdominio www (o viceversa)</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/>Autenticación mutua de cliente y servidor con certificados</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2017/08/instalar-y-renovar-un-certificado-de-lets-encrypt-en-nginx/>Instalar y renovar un certificado de Let's Encrypt en Nginx</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2019/06/pruebas-de-carga-y-rendimiento-de-un-servicio-web-con-apache-bench/>Pruebas de carga y rendimiento de un servicio web con Apache Bench</a></li><li><a href=https://picodotdev.github.io/blog-bitix/2019/06/comprobar-la-seguridad-de-un-sitio-web-que-use-ssl-tls/>Comprobar la seguridad de un sitio web que use SSL/TLS</a></li></ol></div></div><div class=row><div class=col-md-12><div class=sharethis-inline-share-buttons></div></div></div><div class=row><div class="col-12 text-center"><a id=pageBottom></a><ins class=adsbygoogle style=display:inline-block;width:970px;height:250px data-ad-client=ca-pub-3533636310991304 data-ad-slot=2975854584 data-type=billboard></ins></div></div><div class=row><div class=col-md-12><a id=comments></a><div id=disqus_thread></div></div></div><script type=text/javascript async>var disqus_shortname='blog-bitix';var disqus_identifier='blog-bitix-241';var disqus_url='https:\/\/picodotdev.github.io\/blog-bitix\/2017\/06\/autenticacion-mutua-de-cliente-y-servidor-con-certificados\/';var disqus_script='embed.js';</script></div></div><div class=row><div class=col-12><hr></div></div><footer><div class=row><div class="col-12 col-sm-4"><p><strong>Blog Bitix</strong></p><p>Blog dedicado a la distribución GNU/Linux que uso habitualmente, Arch Linux, a mis andanzas alrededor del software libre, la programación y a otros temas relacionados con la tecnología y la informática.</p><p>Publicando de uno a tres artículos únicos a la semana desde el año 2010.</p></div><div class="col-12 col-sm-4 text-center menu"><ul class=list-unstyled><li><a href=/blog-bitix/tags/java/>Java</a></li><li><a href=/blog-bitix/tags/gnu-linux/>GNU/Linux</a></li><li><a href=/blog-bitix/tags/javascript/>JavaScript</a></li><li><a href=/blog-bitix/tags/tapestry/>Tapestry</a></li><li><a href=/blog-bitix/archive/>Archivo y hemeroteca</a></li><li><a href=/blog-bitix/pages/links/>Enlaces</a></li><li><a href=/blog-bitix/pages/advertising/>Publicidad</a></li><li><a href=/blog-bitix/pages/donate/>Donaciones</a></li><li><a href=/blog-bitix/pages/about/>Acerca de...</a></li></ul></div><div class="col-12 col-sm-4 text-center links"><a href=index.xml title="¡Suscríbete a Blog Bitix!"><img src=assets/images/rss.png class=icon></a>
<a href=https://twitter.com/picodotdev/ title="¡Sígueme en twitter!"><img src=assets/images/twitter.svg class=icon></a>
<a href=https://github.com/picodotdev/blog-ejemplos/ title="¡Obtén el código fuente de los ejemplos!"><img src=assets/images/github.svg class=icon></a></div></div><div class=row><div class=col-12>Copyleft <span class=copyleft>&copy;</span> 2020 - <a href=https://creativecommons.org/licenses/by-sa/4.0/ rel=nofollow rel=license><img alt="Licencia de Creative Commons" title="Licencia de Creative Commons" style=border-width:0 src=https://licensebuttons.net/l/by-sa/4.0/80x15.png class=licencia></a><br><a href=https://www.planetacodigo.com/ rel=nofollow><img src=https://picodotdev.github.io/blog-bitix/assets/images/planeta-codigo.png alt="Planeta código" title="Planeta código"></a><br><span xmlns:dct=http://purl.org/dc/terms/ property="dct:title"><a href=https://picodotdev.github.io/blog-bitix/ rel=nofollow>Blog Bitix</a></span> by <a xmlns:cc=https://creativecommons.org/ns# href=https://picodotdev.github.io/blog-bitix/ property="cc:attributionName" rel=cc:attributionurl>pico.dev</a> is licensed under a <a rel=license href=https://creativecommons.org/licenses/by-sa/4.0/>Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional License</a>.<br><span class=credit>Powered by <a href=https://gohugo.io/ rel=nofollow title="A fast and modern static website engine">Hugo</a> and <a href=https://pages.github.com/ title="Websites for you and your projects">GitHub Pages</a>.</span>
<span class=credit>Background patterns from <a href=https://www.toptal.com/designers/subtlepatterns/ rel=nofollow>Subtle Patterns</a>.</span></div></div></footer></div><div class=blueimp-gallery-container><div id=blueimp-gallery class="blueimp-gallery blueimp-gallery-controls" data-use-bootstrap-modal=false><div class=slides></div><h3 class=title></h3><a class=prev>‹</a>
<a class=next>›</a>
<a class=close>×</a>
<a class=play-pause></a><ol class=indicator></ol><div class="modal fade"><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close aria-hidden=true>&#215;</button><h4 class=modal-title></h4></div><div class="modal-body next"></div><div class=modal-footer><button type=button class="btn btn-default pull-left prev">
<i class="glyphicon glyphicon-chevron-left"></i>Anterior</button>
<button type=button class="btn btn-primary next">
Siguiente
<i class="glyphicon glyphicon-chevron-right"></i></button></div></div></div></div></div></div><script type=text/javascript>window.cookieconsent_options={"message":"Esta bitácora te informa de la obviedad de que utiliza «cookies», propias y de servicios como Google Analytics y Google AdSense entre otros.","dismiss":"Aceptar","learnMore":"Más información","link":null,"theme":"dark-bottom"};</script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js async></script></body></html>