









<!DOCTYPE html>
<html amp lang="es">
<head>
  <meta charset="utf-8">
  <meta name="base" content="/blog-bitix/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="picodotdev">
  <meta name="keywords" content="java, programacion, software, hardware, tapestry, software libre, gnu, linux, gnu/linux, unix, arch, arch linux, html, css, javascript">
  <meta name="description" content="Arch Linux es una de las distribuciones más personalizables de GNU/Linux pero cuya instalación requiere leer una buena cantidad de documentación para saber que comandos ejecutar en el prompt del sistema en el que te deja se medio de instalación. Algunos usuarios eligen una distribución como Antergos, KaOS o Manjaro con un instalalador gráfico y guiado simplemente por el hecho de no enfrentarse al instalador de Arch Linux. Ejecutar un comando y esperar a que termine para introducir otro es lento y requiere de atención. &hellip;">
  

  <title>Script de instalación de Arch Linux desatendido, automatizado y personalizable</title>

  <link rel="shortcut icon" href="/blog-bitix/assets/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog-bitix/assets/apple-touch-icon-144-precomposed.png">
  <link rel="canonical" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/">
  
  <link rel="humans" type="text/plain" href="/blog-bitix/humans.txt">
  <link href="https://fonts.googleapis.com/css?family=PT+Serif:400,400i,700,700i&display=swap" rel="stylesheet"> 

  <!-- Social -->
<meta property="og:title" content="Script de instalación de Arch Linux desatendido, automatizado y personalizable">
<meta property="og:url" content="https://picodotdev.github.io/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/index-amp.html">
<meta property="og:image" content="https://picodotdev.github.io/blog-bitix/https://picodotdev.github.io/blog-bitix/assets/images/structured-data/blogbitix-1200.png">

<meta property="og:site_name" content="Blog Bitix">
<meta property="og:description" content="Arch Linux es una de las distribuciones más personalizables de GNU/Linux pero cuya instalación requiere leer una buena cantidad de documentación para saber que comandos ejecutar en el prompt del sistema en el que te deja se medio de instalación. Algunos usuarios eligen una distribución como Antergos, KaOS o Manjaro con un instalalador gráfico y guiado simplemente por el hecho de no enfrentarse al instalador de Arch Linux. Ejecutar un comando y esperar a que termine para introducir otro es lento y requiere de atención. &hellip;">
<meta property="og:type" content="article">

<meta name="twitter:card" content="summary_large_image">
<meta property="og:image" content="https://picodotdev.github.io/blog-bitix/https://picodotdev.github.io/blog-bitix/assets/images/structured-data/blogbitix-1200.png">

<meta name="twitter:site" content="@picodotdev">
<meta name="twitter:title" content="Script de instalación de Arch Linux desatendido, automatizado y personalizable">
<meta name="twitter:description" content="Arch Linux es una de las distribuciones más personalizables de GNU/Linux pero cuya instalación requiere leer una buena cantidad de documentación para saber que comandos ejecutar en el prompt del sistema en el que te deja se medio de instalación. Algunos usuarios eligen una distribución como Antergos, KaOS o Manjaro con un instalalador gráfico y guiado simplemente por el hecho de no enfrentarse al instalador de Arch Linux. Ejecutar un comando y esperar a que termine para introducir otro es lento y requiere de atención. &hellip;">
<meta name="twitter:creator" content="@picodotdev">

  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://picodotdev.github.io/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/index-amp.html"
    },
    "headline": "Script de instalación de Arch Linux desatendido, automatizado y personalizable",
    "image": {
        "@type": "ImageObject",
          "url": "https://picodotdev.github.io/blog-bitix/assets/images/structured-data/blogbitix-1200.png"
        
      },
    "datePublished": "2017-01-13T00:00:00+01:00",
    "dateModified": "2018-07-26T12:00:00+02:00",
    "inLanguage": "es",
    
    "wordCount": "4131",
    "license": "https://creativecommons.org/licenses/by-sa/4.0/",
    "author": {
        "@type": "Person",
        "name": "picodotdev",
        "url": "https://twitter.com/picodotdev/"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Blog Bitix",
        "logo": {
        "@type": "ImageObject",
        "url": "https://picodotdev.github.io/blog-bitix/assets/images/structured-data/blogbitix-1200.png"
        }
    },
    "description": "Arch Linux es una de las distribuciones más personalizables de GNU/Linux pero cuya instalación requiere leer una buena cantidad de documentación para saber que comandos ejecutar en el <em>prompt</em> del sistema en el que te deja se medio de instalación. Algunos usuarios eligen una distribución como Antergos, KaOS o Manjaro con un instalalador gráfico y guiado simplemente por el hecho de no enfrentarse al instalador de Arch Linux. Ejecutar un comando y esperar a que termine para introducir otro es lento y requiere de atención."
}
  </script>
  

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Blog Bitix",
    "url": "https://picodotdev.github.io/blog-bitix/",
    "logo": {
        "@type": "ImageObject",
        "url": "https://picodotdev.github.io/blog-bitix/assets/images/structured-data/blogbitix-1200.png"
    }
}
  </script>

  <!-- boilerplate -->
  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>

  <!-- css -->
  <!-- theme -->
  <style amp-custom> 
  *,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,aside,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}hr{box-sizing:content-box;height:0;overflow:visible}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}abbr[data-original-title],abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;border-bottom:0;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}figure{margin:0 0 1rem}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}caption{padding-top:.75rem;padding-bottom:.75rem;color:#6c757d;text-align:left;caption-side:bottom}th{text-align:inherit}label{display:inline-block;margin-bottom:.5rem}button{border-radius:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,input{overflow:visible}button,select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{padding:0;border-style:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=date],input[type=datetime-local],input[type=month],input[type=time]{-webkit-appearance:listbox}textarea{overflow:auto;resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{display:block;width:100%;max-width:100%;padding:0;margin-bottom:.5rem;font-size:1.5rem;line-height:inherit;color:inherit;white-space:normal}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}summary{display:list-item;cursor:pointer}template{display:none}[hidden]{display:none}:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,aside,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}hr{box-sizing:content-box;height:0;overflow:visible}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}abbr[data-original-title],abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;border-bottom:0;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}figure{margin:0 0 1rem}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}caption{padding-top:.75rem;padding-bottom:.75rem;color:#6c757d;text-align:left;caption-side:bottom}th{text-align:inherit}label{display:inline-block;margin-bottom:.5rem}button{border-radius:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,input{overflow:visible}button,select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{padding:0;border-style:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=date],input[type=datetime-local],input[type=month],input[type=time]{-webkit-appearance:listbox}textarea{overflow:auto;resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{display:block;width:100%;max-width:100%;padding:0;margin-bottom:.5rem;font-size:1.5rem;line-height:inherit;color:inherit;white-space:normal}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}summary{display:list-item;cursor:pointer}template{display:none}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2.5rem}.h2,h2{font-size:2rem}.h3,h3{font-size:1.75rem}.h4,h4{font-size:1.5rem}.h5,h5{font-size:1.25rem}.h6,h6{font-size:1rem}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}hr{margin-top:1rem;margin-bottom:1rem;border:0;border-top:1px solid rgba(0,0,0,.1)}.small,small{font-size:80%;font-weight:400}.mark,mark{padding:.2em;background-color:#fcf8e3}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;list-style:none}.list-inline-item{display:inline-block}.list-inline-item:not(:last-child){margin-right:.5rem}.initialism{font-size:90%;text-transform:uppercase}.blockquote{margin-bottom:1rem;font-size:1.25rem}.blockquote-footer{display:block;font-size:80%;color:#6c757d}.blockquote-footer::before{content:"\2014\00A0"}.img-fluid{max-width:100%;height:auto}.img-thumbnail{padding:.25rem;background-color:#fff;border:1px solid #dee2e6;border-radius:.25rem;max-width:100%;height:auto}.figure{display:inline-block}.figure-img{margin-bottom:.5rem;line-height:1}.figure-caption{font-size:90%;color:#6c757d}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:87.5%;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:100%;font-weight:700}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.pre-scrollable{max-height:340px;overflow-y:scroll}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width:576px){.container{max-width:540px}}@media (min-width:768px){.container{max-width:720px}}@media (min-width:992px){.container{max-width:960px}}@media (min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md,.container-sm,.container-xl{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width:576px){.container,.container-sm{max-width:540px}}@media (min-width:768px){.container,.container-md,.container-sm{max-width:720px}}@media (min-width:992px){.container,.container-lg,.container-md,.container-sm{max-width:960px}}@media (min-width:1200px){.container,.container-lg,.container-md,.container-sm,.container-xl{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.no-gutters{margin-right:0;margin-left:0}.no-gutters>.col,.no-gutters>[class*=col-]{padding-right:0;padding-left:0}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-auto,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-auto,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-auto,.col-sm,.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-auto,.col-xl,.col-xl-1,.col-xl-10,.col-xl-11,.col-xl-12,.col-xl-2,.col-xl-3,.col-xl-4,.col-xl-5,.col-xl-6,.col-xl-7,.col-xl-8,.col-xl-9,.col-xl-auto{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.row-cols-1>*{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.row-cols-2>*{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.row-cols-3>*{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.row-cols-4>*{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.row-cols-5>*{-ms-flex:0 0 20%;flex:0 0 20%;max-width:20%}.row-cols-6>*{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-auto{-ms-flex:0 0 auto;flex:0 0 auto;width:auto;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}@media (min-width:576px){.col-sm{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.row-cols-sm-1>*{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.row-cols-sm-2>*{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.row-cols-sm-3>*{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.row-cols-sm-4>*{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.row-cols-sm-5>*{-ms-flex:0 0 20%;flex:0 0 20%;max-width:20%}.row-cols-sm-6>*{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-sm-auto{-ms-flex:0 0 auto;flex:0 0 auto;width:auto;max-width:100%}.col-sm-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-sm-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-sm-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-sm-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-sm-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-sm-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-sm-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-sm-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-sm-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-sm-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-sm-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-sm-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}}@media (min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.row-cols-md-1>*{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.row-cols-md-2>*{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.row-cols-md-3>*{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.row-cols-md-4>*{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.row-cols-md-5>*{-ms-flex:0 0 20%;flex:0 0 20%;max-width:20%}.row-cols-md-6>*{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-auto{-ms-flex:0 0 auto;flex:0 0 auto;width:auto;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}}.table{width:100%;margin-bottom:1rem;color:#212529}.table td,.table th{padding:.75rem;vertical-align:top;border-top:1px solid #dee2e6}.table thead th{vertical-align:bottom;border-bottom:2px solid #dee2e6}.table tbody+tbody{border-top:2px solid #dee2e6}.table-light,.table-light>td,.table-light>th{background-color:#fdfdfe}.table-light tbody+tbody,.table-light td,.table-light th,.table-light thead th{border-color:#fbfcfc}.table-dark,.table-dark>td,.table-dark>th{background-color:#c6c8ca}.table-dark tbody+tbody,.table-dark td,.table-dark th,.table-dark thead th{border-color:#95999c}.table .thead-dark th{color:#fff;background-color:#343a40;border-color:#454d55}.table .thead-light th{color:#495057;background-color:#e9ecef;border-color:#dee2e6}.table-dark{color:#fff;background-color:#343a40}.table-dark td,.table-dark th,.table-dark thead th{border-color:#454d55}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}.btn:hover{color:#212529;text-decoration:none}.btn-success{color:#fff;background-color:#28a745;border-color:#28a745}.btn-success:hover{color:#fff;background-color:#218838;border-color:#1e7e34}.btn-success.focus,.btn-success:focus{color:#fff;background-color:#218838;border-color:#1e7e34;box-shadow:0 0 0 .2rem rgba(72,180,97,.5)}.btn-success.disabled,.btn-success:disabled{color:#fff;background-color:#28a745;border-color:#28a745}.btn-success:not(:disabled):not(.disabled).active,.btn-success:not(:disabled):not(.disabled):active,.show>.btn-success.dropdown-toggle{color:#fff;background-color:#1e7e34;border-color:#1c7430}.btn-success:not(:disabled):not(.disabled).active:focus,.btn-success:not(:disabled):not(.disabled):active:focus,.show>.btn-success.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(72,180,97,.5)}.nav{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding-left:0;margin-bottom:0;list-style:none}.nav-link{display:block;padding:.5rem 1rem}.nav-link:focus,.nav-link:hover{text-decoration:none}.nav-link.disabled{color:#6c757d;pointer-events:none;cursor:default}.navbar{position:relative;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;padding:.5rem 1rem}.navbar .container,.navbar .container-fluid,.navbar .container-lg,.navbar .container-md,.navbar .container-sm,.navbar .container-xl{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between}.nav-pills .nav-link{border-radius:.25rem}.nav-pills .nav-link.active,.nav-pills .show>.nav-link{color:#fff;background-color:#007bff}.nav-fill .nav-item{-ms-flex:1 1 auto;flex:1 1 auto;text-align:center}.text-monospace{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}.text-justify{text-align:justify}.text-wrap{white-space:normal}.text-nowrap{white-space:nowrap}.text-truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-dismissible{padding-right:4rem}.alert-dismissible .close{position:absolute;top:0;right:0;padding:.75rem 1.25rem;color:inherit}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary hr{border-top-color:#9fcdff}.alert-primary .alert-link{color:#002752}.alert-secondary{color:#383d41;background-color:#e2e3e5;border-color:#d6d8db}.alert-secondary hr{border-top-color:#c8cbcf}.alert-secondary .alert-link{color:#202326}.alert-success{color:#155724;background-color:#d4edda;border-color:#c3e6cb}.alert-success hr{border-top-color:#b1dfbb}.alert-success .alert-link{color:#0b2e13}.alert-info{color:#0c5460;background-color:#d1ecf1;border-color:#bee5eb}.alert-info hr{border-top-color:#abdde5}.alert-info .alert-link{color:#062c33}.alert-warning{color:#856404;background-color:#fff3cd;border-color:#ffeeba}.alert-warning hr{border-top-color:#ffe8a1}.alert-warning .alert-link{color:#533f03}.alert-danger{color:#721c24;background-color:#f8d7da;border-color:#f5c6cb}.alert-danger hr{border-top-color:#f1b0b7}.alert-danger .alert-link{color:#491217}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light hr{border-top-color:#ececf6}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark hr{border-top-color:#b9bbbe}.alert-dark .alert-link{color:#040505}

  .chroma{background-color:#fff}.chroma .err{color:#a61717;background-color:#e3d2d2}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.chroma .hl{display:block;width:100%;background-color:#ffc}.chroma .lnt{margin-right:.4em;padding:0 .4em 0 .4em;color:#7f7f7f}.chroma .ln{margin-right:.4em;padding:0 .4em 0 .4em;color:#7f7f7f}.chroma .k{color:#000;font-weight:700}.chroma .kc{color:#000;font-weight:700}.chroma .kd{color:#000;font-weight:700}.chroma .kn{color:#000;font-weight:700}.chroma .kp{color:#000;font-weight:700}.chroma .kr{color:#000;font-weight:700}.chroma .kt{color:#458;font-weight:700}.chroma .na{color:teal}.chroma .nb{color:#0086b3}.chroma .bp{color:#999}.chroma .nc{color:#458;font-weight:700}.chroma .no{color:teal}.chroma .nd{color:#3c5d5d;font-weight:700}.chroma .ni{color:purple}.chroma .ne{color:#900;font-weight:700}.chroma .nf{color:#900;font-weight:700}.chroma .nl{color:#900;font-weight:700}.chroma .nn{color:#555}.chroma .nt{color:navy}.chroma .nv{color:teal}.chroma .vc{color:teal}.chroma .vg{color:teal}.chroma .vi{color:teal}.chroma .s{color:#d14}.chroma .sa{color:#d14}.chroma .sb{color:#d14}.chroma .sc{color:#d14}.chroma .dl{color:#d14}.chroma .sd{color:#d14}.chroma .s2{color:#d14}.chroma .se{color:#d14}.chroma .sh{color:#d14}.chroma .si{color:#d14}.chroma .sx{color:#d14}.chroma .sr{color:#009926}.chroma .s1{color:#d14}.chroma .ss{color:#990073}.chroma .m{color:#099}.chroma .mb{color:#099}.chroma .mf{color:#099}.chroma .mh{color:#099}.chroma .mi{color:#099}.chroma .il{color:#099}.chroma .mo{color:#099}.chroma .o{color:#000;font-weight:700}.chroma .ow{color:#000;font-weight:700}.chroma .c{color:#998;font-style:italic}.chroma .ch{color:#998;font-style:italic}.chroma .cm{color:#998;font-style:italic}.chroma .c1{color:#998;font-style:italic}.chroma .cs{color:#999;font-weight:700;font-style:italic}.chroma .cp{color:#999;font-weight:700;font-style:italic}.chroma .cpf{color:#999;font-weight:700;font-style:italic}.chroma .gd{color:#000;background-color:#fdd}.chroma .ge{color:#000;font-style:italic}.chroma .gr{color:#a00}.chroma .gh{color:#999}.chroma .gi{color:#000;background-color:#dfd}.chroma .go{color:#888}.chroma .gp{color:#555}.chroma .gs{font-weight:700}.chroma .gu{color:#aaa}.chroma .gt{color:#a00}.chroma .gl{text-decoration:underline}.chroma .w{color:#bbb}

  html{font-size:16px}body{color:#222;font-family:'PT Serif','Times New Roman',Times,serif;font-size:1.2em;font-weight:400;margin-bottom:50px;background-color:#f8f8f8;background-image:url(/blog-bitix/assets/images/backgrounds/grey.png)}::-moz-selection{background-color:#61b135;color:#fff}::selection{background-color:#61b135;color:#fff}a{color:#569d2f}a:visited{color:#7aca4e}a:hover{color:#4b8929}a:active{color:#569d2f}h1,h2,h3,h4,h5,h6{margin-top:20px;margin-bottom:10px;font-weight:700;clear:both}hr{border-top:3px dotted #ccc;width:60%}hr.separator{border-top:0 dotted #ccc}abbr[title]{border-bottom:1px dotted}pre{margin-bottom:0}ul.recents{font-size:.9em}ul.recents hr{margin-top:10px;margin-bottom:10px;border-top:1px dotted #ccc}ul.tags{columns:5 8em;column-gap:1em}ul.library{columns:4 12em;column-gap:1em}ul.list-columns{columns:4 12em;column-gap:1em}div.container{background-color:#fff;border-left:1px solid #f8f8f8;border-right:1px solid #f8f8f8;padding:0 1em;max-width:1080px}header{text-align:center;margin-bottom:10px}header h2{font-size:2.6em;font-weight:700}header h2 a,header h2 a:active,header h2 a:hover,header h2 a:visited{color:#222}header nav{font-weight:700;margin-top:10px}header nav.nav-pills a:hover{background-color:#e2f3d8}header nav.nav-pills a.active,header nav.nav-pills a.active:hover{background-color:#569d2f;color:#fff}header form.search{margin-top:20px;display:inline-block}article h1{font-size:2.6em}@media (max-width:576px){article h1{font-size:1.8em}}article p.information,article span.information{font-size:.9em}article p.summary{font-weight:700}article table{margin-bottom:20px}article blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}article div.logotypes{margin-left:1.5em;text-align:right;float:right;clear:right;max-width:400px;min-width:150px}@media (max-width:576px){article div.logotypes{width:125px}}article div.logotypes amp-img,article div.logotypes img{background-color:#fff;border:.5em solid #fff;border-radius:.3em;box-shadow:0 1px 4px rgba(0,0,0,.15);box-sizing:border-box}@media (max-width:576px){article div.logotypes amp-img,article div.logotypes img{width:125px}}article div.code{border:1px solid #ddd;border-radius:3px;margin-bottom:1em}article div.code div.highlight{font-size:.8em;border-bottom:1px solid #ddd}article div.code div.highlight table{overflow:auto}article div.code div.highlight-meta{font-size:.8em;background-color:#f7f7f7;padding:6px}article div.code div.highlight-meta span.raw{float:right}article div.code div.highlight-meta a,article div.code div.highlight-meta span{color:#666;font-weight:600;text-decoration:none;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:.8em}article div.media{display:block;text-align:center;margin-bottom:1em}article div.media amp-iframe[id^=asciicast-iframe],article div.media iframe[id^=asciicast-iframe]{border:0 solid #fff;box-shadow:0 0 0 rgba(0,0,0,.15)}article div.media amp-ad,article div.media amp-iframe,article div.media amp-img,article div.media iframe,article div.media img{background-color:#fff;border:.5em solid #fff;border-radius:.3em;box-shadow:0 1px 4px rgba(0,0,0,.15);box-sizing:content-box;max-width:100%;max-height:100%;object-fit:contain;vertical-align:middle}article div.media figure{clear:both}article div.media figure figcaption{font-size:.8em}article div.media-amazon.float-right{margin-left:20px}article div.media-twitter{text-align:left}article div.buttons{text-align:center;margin-bottom:20px}article div.buttons a.btn{color:#fff}article div.alert h1,article div.alert h2,article div.alert h3,article div.alert h4,article div.alert h5,article div.alert h6{clear:none}article div.alert p{margin-bottom:0}article div.reference{font-size:.9em}article div.blueimp-gallery-container{position:absolute}article div.blueimp-gallery div.modal{overflow:hidden}div.page-header{min-height:300px;max-height:300px;margin-bottom:20px;overflow:hidden;display:flex;justify-content:center;align-items:center}div.page-header img{min-width:100%;max-width:100%}div.sharethis-inline-share-buttons{margin-top:1em;margin-bottom:1em}div.related,div.serie{font-size:.9em}div.related h3,div.serie h3{font-size:1em;font-weight:400}footer{font-size:.8em;padding-top:10px;padding-bottom:30px}footer span.copyleft{transform:rotate(180deg);display:inline-block}div.banner{margin-bottom:10px}div.featured{background-color:#fff;text-align:center;font-size:.9em;font-weight:700;margin-bottom:10px;width:150px;border-radius:.3em;box-shadow:0 1px 4px rgba(0,0,0,.15);border:.3em solid #fff}div.featured img{width:100%}div.featured a{color:#222}div.links img.icon{width:50px}div.adblock-container{left:0;right:0;margin-left:auto;margin-right:auto}div.adblock{background-color:#eee;border:1px solid gray;font-size:.9em;padding:15px}div.adblock-sidebar-container{position:sticky;position:-webkit-sticky;top:15px;height:0;display:none;overflow:visible}div.adblock-sidebar-container-left{height:600px;max-height:600px;overflow:hidden}div.adblock-sidebar-container-left div.adsense-vertical{display:inline-block;text-align:right;height:600px;max-height:600px;width:100%}div.adblock-sidebar-container-left div.adsense-vertical ins.adsbygoogle{display:inline-block;text-align:right;height:600px;max-height:600px;width:100%}div.adblock-sidebar-container-right{height:600px;max-height:600px;overflow:hidden}div.adblock-sidebar-container-right div.adsense-vertical{display:inline-block;text-align:left;height:600px;max-height:600px;width:100%}div.adblock-sidebar-container-right div.adsense-vertical ins.adsbygoogle{display:inline-block;text-align:left;height:600px;max-height:600px;width:100%}div.adsense{line-height:0}div.adsense ins.adsbygoogle{line-height:0}div.adsense-billboard{display:inline-block;text-align:center;height:250px;min-height:250px;max-height:300px;width:100%;max-width:970px}div.adsense-billboard ins.adsbygoogle{display:inline-block;text-align:center;height:250px;min-height:250px;max-height:300px;width:100%;max-width:970px}div.adsense-leaderboard{display:inline-block;text-align:left;height:90px;min-height:90px;max-height:300px;width:100%;max-width:728px}div.adsense-leaderboard ins.adsbygoogle{display:inline-block;text-align:left;height:90px;min-height:90px;max-height:300px;width:100%;max-width:728px}@media (min-width:1366px){div.adblock-sidebar-container{display:flex;justify-content:space-between}div.adblock-sidebar-container-left{transform:translateX(-155px);width:120px}div.adblock-sidebar-container-right{transform:translateX(155px);width:120px}}@media (min-width:1440px){div.adblock-sidebar-container-left{transform:translateX(-195px);width:160px}div.adblock-sidebar-container-right{transform:translateX(195px);width:160px}}@media (min-width:1750px){div.adblock-sidebar-container-left{transform:translateX(-335px);width:300px}div.adblock-sidebar-container-right{transform:translateX(335px);width:300px}}

  </style>

  <!-- scripts -->
  <script async src="https://cdn.ampproject.org/v0.js"></script>
  <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
  <script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>
  <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
  <script async custom-element="amp-twitter" src="https://cdn.ampproject.org/v0/amp-twitter-0.1.js"></script>
  <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>  

  

  
  
</head>
<body>
  <div class="container">
    <div class="row">
      <div class="col-12">
        





<header>
  <div class="row">
    <div class="col-12 col-lg-4"></div>
    <div class="col-12 col-lg-4">
      <h2 class="title"><a href="https://picodotdev.github.io/blog-bitix/index-amp.html">Blog Bitix</a></h2>
      <div class="links">
        
          <a href="https://picodotdev.github.io/blog-bitix/index.xml" title="¡Suscríbete a Blog Bitix!"><amp-img src="/blog-bitix/assets/images/rss.png" width="50" height="50" class="icon"></amp-img></a>
        
        
          <a href="https://twitter.com/picodotdev/" title="¡Sígueme en twitter!"><amp-img src="/blog-bitix/assets/images/twitter.svg" width="50" height="50" class="icon"></amp-img></a>
        
        
          <a href="https://github.com/picodotdev/blog-ejemplos/" title="¡Obtén el código fuente de los ejemplos!"><amp-img src="/blog-bitix/assets/images/github.svg" width="50" height="50" class="icon"></amp-img></a>
        
        
        
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      
<nav class="nav nav-pills nav-fill">
  <a href="/blog-bitix/tags/java/index-amp.html" class="nav-item nav-link">Java</a>
  <a href="/blog-bitix/tags/gnu-linux/index-amp.html" class="nav-item nav-link">GNU/Linux</a>
  <a href="/blog-bitix/tags/javascript/index-amp.html" class="nav-item nav-link">JavaScript</a>
  <a href="/blog-bitix/tags/tapestry/index-amp.html" class="nav-item nav-link">Tapestry</a>
  <a href="/blog-bitix/archive/index-amp.html" class="nav-item nav-link">Archivo y hemeroteca</a>
  <a href="/blog-bitix/pages/links/index-amp.html" class="nav-item nav-link">Enlaces</a>
  <a href="/blog-bitix/pages/about/index-amp.html" class="nav-item nav-link">Acerca de...</a>
  
</nav>

    </div>
  </div>
</header>
      </div>
    </div>
    <div class="row">
      <div class="col-12 text-center">
        <div class="adsense adsense-billboard">
    <amp-ad
        layout="fill"
        type="adsense"
        data-ad-client="ca-pub-3533636310991304"
        data-ad-slot="4052324337"
        data-auto-format="auto"
        data-full-width="">
        <div overflow=""></div>
    </amp-ad>
</div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-12">
        
<article>
    <h1>Script de instalación de Arch Linux desatendido, automatizado y personalizable</h1>
    <p class="information">
      
        Escrito por
       
      <span>picodotdev</span> el <time>13/01/2017</time>, actualizado el <time>26/07/2018</time>.
      
        <br>
        
          <a href="/blog-bitix/tags/gnu-linux/index-amp.html">gnu-linux</a>
        
          <a href="/blog-bitix/tags/planeta-codigo/index-amp.html">planeta-codigo</a>
        
          <a href="/blog-bitix/tags/software-libre/index-amp.html">software-libre</a>
        
      
      <br>
      <a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/index-amp.html">Enlace permanente</a>
      
        <a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/index-amp.html#comments">Comentarios</a>
      
      
    </p>

    
      <p class="summary">Arch Linux es una de las distribuciones más personalizables de GNU/Linux pero cuya instalación requiere leer una buena cantidad de documentación para saber que comandos ejecutar en el <em>prompt</em> del sistema en el que te deja se medio de instalación. Algunos usuarios eligen una distribución como Antergos, KaOS o Manjaro con un instalalador gráfico y guiado simplemente por el hecho de no enfrentarse al instalador de Arch Linux. Ejecutar un comando y esperar a que termine para introducir otro es lento y requiere de atención.</p>
    
    

    
      <div>
        <div class="adsense adsense-leaderboard">
    <amp-ad
        layout="fill"
        type="adsense"
        data-ad-client="ca-pub-3533636310991304"
        data-ad-slot="8238629013"
        data-auto-format="auto"
        data-full-width="">
        <div overflow=""></div>
    </amp-ad>
</div>
      </div>
    

    <div class="content">
      


      <div class="logotypes" style="min-width: 250px;">
<p><amp-img src="/blog-bitix/assets/images/logotypes/archlinux.svg" width="1.3392156862745097" height="1" alt="Arch Linux" title="Arch Linux" layout="responsive"  class="lozad"></amp-img></p>
</div>
<div class="logotypes" style="min-width: 200px;">
<p><amp-img src="/blog-bitix/assets/images/logotypes/linux.svg" width="0.8617283950617284" height="1" alt="Linux" title="Linux" layout="responsive"  class="lozad"></amp-img></p>
</div>
<p>Hace tiempo que instalar una distribución <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> no tiene más dificultad que instalar un sistema operativo como <a href="https://www.microsoft.com/es-es/windows/">Windows</a>, que consiste en descargar la imagen ISO del CD o DVD, grabarla en un CD, DVD o memoria USB e iniciar el sistema con el medio. Las <a href="https://picodotdev.github.io/blog-bitix/2016/10/elegir-una-distribucion-gnu-linux-segun-el-usuario-uso-o-equipo/index-amp.html">distribuciones aconsejadas para usuarios que provienen de Windows o macOS</a> o no tiene muchos conocimientos informáticos poseen instaladores gráficos o basados en texto y guiados en varios pasos hasta completar la instalación en menos de una hora. Distribuciones como <a href="https://www.ubuntu.com/">Ubuntu</a>, <a href="https://elementary.io/es/">elementary OS</a> o <a href="https://www.linuxmint.com/">Linux Mint</a> hacen que la instalación no requiera muchos conocimientos y sea completada con éxito por cualquier usuario.</p>
<div class="media">
<figure>
<p><a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/debian-installer-text_hu24823266aaadbd5ea03f13734b295699_7331_2560x1440_fit_box_2.png" data-gallery="data-gallery"><amp-img src="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/debian-installer-text_hu24823266aaadbd5ea03f13734b295699_7331_300x200_fit_box_2.png" width="267" height="200" alt="Instalador de Debian en modo texto" title="Instalador de Debian en modo texto"  class="lozad"></amp-img></a>
<a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/debian-installer-graphics_hu57b39c5df8bb0f15d502613ed89fe1b4_28647_2560x1440_fit_box_2.png" data-gallery="data-gallery"><amp-img src="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/debian-installer-graphics_hu57b39c5df8bb0f15d502613ed89fe1b4_28647_300x200_fit_box_2.png" width="267" height="200" alt="Instalador de Debian en modo gráfico" title="Instalador de Debian en modo gráfico"  class="lozad"></amp-img></a></p>
<figcaption>Instalación guíada de Debian basada en texto y gráfica</figcaption>
</figure>
</div>
<p>Otras distribuciones basadas en principios diferentes y usuarios a los que está destinadas con otras necesidades o preferencias puede que requieran algo más de conocimientos a cambio de realizar configuraciones más avanzadas como el particionado del disco, cifrado del disco o software que se instala. Algunas distribuciones como <a href="https://www.archlinux.org/">Arch Linux</a> incluso no proporcionan ningún instalador.</p>
<blockquote>
<p>It is targeted at the proficient GNU/Linux user, or anyone with a do-it-yourself attitude who is
willing to read the documentation, and solve their own problems.</p>
</blockquote>
<p>En Arch Linux con su <a href="https://wiki.archlinux.org/index.php/Arch_Linux">forma de hacer las cosas</a> deja al usuario el poder de personalizar el sistema completamente a sus necesidades y preferencias únicamente limitado por su determinación de conseguirlo. Solo proporciona <a href="https://www.archlinux.org/download/">el medio con el que iniciar la instalación</a> que comienza con una terminal y un <em>prompt</em> del sistema, una <a href="https://wiki.archlinux.org/index.php/Installation_guide">guía de instalación</a> junto con las <a href="https://wiki.archlinux.org/index.php/General_recommendations">recomendaciones generales</a> y <a href="https://wiki.archlinux.org/">una de las mejores fuentes de información en GNU/Linux</a> además de completa de cada aspecto que necesitemos en la instalación. Después de haber leído las páginas relevantes de la wiki de Arch Linux, seguramente más de una y dos veces, hasta comprenderla en su mayor parte se empieza a realizar la receta que contenga los comandos necesarios hasta completar la instalación.</p>
<p>En multitud de blogs y vídeos de YouTube hay guías que contienen los comandos y las explicaciones necesarias. Cualquier usuario de Arch Linux con un blog seguramente ha publicado un artículo con su guía de instalación (sí, <a href="https://picodotdev.github.io/blog-bitix/2014/05/anexo-a-la-guia-de-instalacion-y-del-principiante-de-arch-linux/index-amp.html">yo también publiqué la mía</a>). Un usuario que quiera instalar Arch Linux debe leer varios de esos artículos además de la guía oficial de instalación. Según la filosofía de Arch Linux este proceso de aprendizaje se considera necesario y permite una mayor compresión del sistema. Pero saber los comandos que hay que introducir para realizar la instalación de Arch Linux no evita tener que teclearlos uno de tras de otro y esperar a que termine el anterior para introducir el siguiente. Tampoco todas las personas tienen el tiempo para realizarlo. Varias <a href="https://wiki.archlinux.org/index.php/Arch-based_distributions">distribuciones derivadas de Arch Linux</a> como <a href="https://antergos.com/">Antergos</a>, <a href="https://kaosx.us/">KaOS</a> o <a href="https://manjaro.org/">Manjaro</a> ofrecen los instaladores gráficos y guiados más amigables que atraen a algunos usuarios buscando usar Arch Linux pero no pasar por su poco amigable proceso de instalación. Por fortuna al ser una distribución <em>rolling release</em> (en constante actualización) solo hay que hacer una única instalación por equipo en principio durante toda su vida de uso. Pero incluso para los usuarios de Arch Linux realizar una segunda instalación en un nuevo equipo es cansina.</p>
<p>Hace unos meses conocí <a href="https://arch-anywhere.org/">arch-anywhere</a> que básicamente es un <em>script</em> de bash, con un instalador guiado y basado en texto que hace menos laboriosa la instalación de Arch Linux de forma similar a las existentes en otras distribuciones más amigables. Sin embargo, hay un dos cosas que no me convencen de <em>arch-anywhere</em>, una es que no es desatendido requiriendo contestar a varias preguntas de forma interactiva, esperar a que termine ejecute algún comando según la contestación anterior y contestar a la siguiente pregunta. Por lo demás, ofrece un buen nivel de personalización cubriendo las necesidades más comunes de los usuarios como personalizar el particionado, elegir el sistema de archivos, si se quiere LVM, cifrado, el entorno de escritorio (GNOME, KDE, XFCE, &hellip;), kernel, cargador de arranque (GRUB) y programas a instalar. Otra cosa que no me convence es que usa una imagen ISO propia y no la original de Arch Linux.</p>
<p>Basándome en <em>arch-anywhere</em> y dedicando un poco de tiempo he creado un <em>script</em> en <a href="https://es.wikipedia.org/wiki/Bash">bash</a> para instalar Arch Linux de forma automatizada, desatendida y personalizable hasta cierto punto aunque siendo útil para los casos de configuraciones más comunes. Algunas de las funcionalidades que soporta son:</p>
<ul>
<li>BIOS con <a href="https://wiki.archlinux.org/index.php/Partitioning">particionado</a> GPT</li>
<li><a href="https://wiki.archlinux.org/index.php/Unified_Extensible_Firmware_Interface">UEFI</a></li>
<li><a href="https://wiki.archlinux.org/index.php/LVM">LVM</a> y no LVM</li>
<li>Partición <em>root</em> <a href="https://wiki.archlinux.org/index.php/Dm-crypt/Encrypting_an_entire_system">cifrada</a> y sin cifrar</li>
<li><a href="https://wiki.archlinux.org/index.php/File_systems">Sistemas de archivos</a> ext4, btrfs (sin swap) o xfs</li>
<li><a href="https://wiki.archlinux.org/index.php/Swap">swap</a> con archivo</li>
<li>Instalación con <a href="https://wiki.archlinux.org/index.php/Wireless_network_configuration">red WIFI</a> WPA</li>
<li><a href="https://wiki.archlinux.org/index.php/Solid_State_Drives">Soporte TRIM</a> para discos SSD</li>
<li>Utilidades como invitado de <a href="https://wiki.archlinux.org/index.php/VirtualBox">VirtualBox</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Microcode">Microcódigo</a> para procesadores Intel</li>
<li>Creación de usuario</li>
<li>Instalación de utilidad para AUR (aurman, yay)</li>
<li>Instalación de paquetes</li>
<li>Instalación de entorno de escritorio (<a href="https://wiki.archlinux.org/index.php/GNOME">GNOME</a>, <a href="https://wiki.archlinux.org/index.php/KDE">KDE</a>, <a href="https://wiki.archlinux.org/index.php/Xfce">Xfce</a>, <a href="https://wiki.archlinux.org/index.php/MATE">Mate</a>, <a href="https://wiki.archlinux.org/index.php/Cinnamon">Cinnamon</a>, <a href="https://wiki.archlinux.org/index.php/LXDE">LXDE</a>) y gestor de sesiones (<a href="https://wiki.archlinux.org/index.php/GDM">gdm</a>, <a href="https://wiki.archlinux.org/index.php/SDDM">sddm</a>, <a href="https://wiki.archlinux.org/index.php/LightDM">lightdm</a>, <a href="https://wiki.archlinux.org/index.php/LXDM">lxdm</a>)</li>
<li>Instalación base sin entorno de escritorio</li>
<li>Instalación de <a href="https://wiki.archlinux.org/index.php/Kernels">kernels</a> adicionales (linux-lts, linux-grsec, linux-zen)</li>
<li>Instalación de controlador gráfico (intel, nvidia, amd)</li>
<li>Cargador de arranque con <a href="https://wiki.archlinux.org/index.php/GRUB">GRUB</a></li>
<li>Grabar la instalación con <a href="https://asciinema.org/">asciinema</a> y archivo de <em>log</em></li>
<li>Reinicio después de la instalación y posibilidad de abortar el reinicio</li>
<li>Script para entrar en modo recuperación</li>
</ul>
<p>La forma aconsejada de instalar Arch Linux es aprendiendo cuales son los comandos a ejecutar y que hace cada uno de ellos, primero lee la guía oficial de instalación de Arch Linux y comprende que hacen los comandos del <em>script</em>. Este <em>script</em> no es oficial y por ello en el <a href="https://foros.archlinux-es.org/">foro de Arch Linux en español</a> o <a href="https://bbs.archlinux.org/">en inglés</a> no podrán darte soporte aunque yo en los comentarios de este artículo te ayudaré si preguntas. Ten en cuenta que de momento solo lo he probado en <a href="https://www.virtualbox.org/">VirtualBox</a> no en un sistema real y que este <em>script</em> elimina toda la información del dispositivo de instalación. Si lo pruebas deja un comentario al final de artículo.</p>
<p>Iniciado el sistema con la imagen ISO de Arch Linux de instalación, hay que descargar el <em>script</em>, editar algunas variables de entorno para la configuración de alis e iniciar el proceso de instalación. Dependiendo del entorno de escritorio preferido, si se desea LVM, el tipo del sistema de archivos, si se desea cifrar el sistema de archivos y paquetes a instalar los valores de las variables variarán según las preferencias que inicialmente tienes unos valores comunes. Dos variables que hay que modificar al menos son <em>USER_NAME</em> y <em>USER_PASSWORD</em> con el nombre del usuario y su contraseña que vaya a utilizar el sistema.</p>
<p>El tiempo requerido de instalación varía según el ancho de banda de la conexión y del tipo de almacenamiento, en mi caso con ADSL con una descarga de 1.2 MiB/s y SSD la instalación del sistema base sin entorno de escritorio me tarda aproximandamente 20 minutos. Con una conexión de fibra tardará sensiblemente menos tiempo. El <em>script</em> de instalación contiene con los mismos comandos que serían necesarios para realizar la instalación manualmente de forma interactiva.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># loadkeys es</span>&#10;<span class="c1"># curl -sL https://bit.ly/2F3CATp | bash</span>&#10;<span class="c1"># vim alis.conf</span>&#10;<span class="c1"># ./alis.sh</span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>alis-install.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span><span class="lnt">39&#10;</span><span class="lnt">40&#10;</span><span class="lnt">41&#10;</span><span class="lnt">42&#10;</span><span class="lnt">43&#10;</span><span class="lnt">44&#10;</span><span class="lnt">45&#10;</span><span class="lnt">46&#10;</span><span class="lnt">47&#10;</span><span class="lnt">48&#10;</span><span class="lnt">49&#10;</span><span class="lnt">50&#10;</span><span class="lnt">51&#10;</span><span class="lnt">52&#10;</span><span class="lnt">53&#10;</span><span class="lnt">54&#10;</span><span class="lnt">55&#10;</span><span class="lnt">56&#10;</span><span class="lnt">57&#10;</span><span class="lnt">58&#10;</span><span class="lnt">59&#10;</span><span class="lnt">60&#10;</span><span class="lnt">61&#10;</span><span class="lnt">62&#10;</span><span class="lnt">63&#10;</span><span class="lnt">64&#10;</span><span class="lnt">65&#10;</span><span class="lnt">66&#10;</span><span class="lnt">67&#10;</span><span class="lnt">68&#10;</span><span class="lnt">69&#10;</span><span class="lnt">70&#10;</span><span class="lnt">71&#10;</span><span class="lnt">72&#10;</span><span class="lnt">73&#10;</span><span class="lnt">74&#10;</span><span class="lnt">75&#10;</span><span class="lnt">76&#10;</span><span class="lnt">77&#10;</span><span class="lnt">78&#10;</span><span class="lnt">79&#10;</span><span class="lnt">80&#10;</span><span class="lnt">81&#10;</span><span class="lnt">82&#10;</span><span class="lnt">83&#10;</span><span class="lnt">84&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># init</span>&#10;<span class="nv">KEYS</span><span class="o">=</span><span class="s2">&#34;es&#34;</span>&#10;<span class="nv">LOG</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;&#10;<span class="c1"># partition</span>&#10;<span class="nv">DEVICE</span><span class="o">=</span><span class="s2">&#34;/dev/sda !/dev/nvme0n1&#34;</span> <span class="c1"># sata nvme</span>&#10;<span class="nv">DEVICE_TRIM</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;<span class="nv">LVM</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;<span class="nv">PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="o">=</span><span class="s2">&#34;archlinux&#34;</span> <span class="c1"># Warning: change it!</span>&#10;<span class="nv">PARTITION_ROOT_ENCRYPTION_PASSWORD_RETYPE</span><span class="o">=</span><span class="s2">&#34;archlinux&#34;</span>&#10;<span class="nv">FILE_SYSTEM_TYPE</span><span class="o">=</span><span class="s2">&#34;ext4 !btrfs !xfs&#34;</span>&#10;<span class="nv">SWAP_SIZE</span><span class="o">=</span><span class="s2">&#34;!2GiB !4GiB !8GiB&#34;</span> <span class="c1"># 2GiB 4GiB 8GiB (not supported in btrfs)</span>&#10;&#10;<span class="c1"># network_install</span>&#10;<span class="nv">WIFI_INTERFACE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">WIFI_ESSID</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">WIFI_KEY</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">WIFI_HIDDEN</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PING_HOSTNAME</span><span class="o">=</span><span class="s2">&#34;mirrors.kernel.org&#34;</span>&#10;&#10;<span class="c1"># install (precede with ! for not install)</span>&#10;<span class="nv">PACMAN_MIRROR</span><span class="o">=</span><span class="s2">&#34;https://mirrors.kernel.org/archlinux/\$repo/os/\$arch&#34;</span>&#10;<span class="nv">KERNELS</span><span class="o">=</span><span class="s2">&#34;!linux-lts !linux-lts-headers !linux-hardened !linux-hardened-headers !linux-zen !linux-zen-headers&#34;</span>&#10;<span class="nv">KERNELS_COMPRESSION</span><span class="o">=</span><span class="s2">&#34;!gzip !bzip2 !lzma !xz !lzop !lz4&#34;</span>&#10;&#10;<span class="c1"># config</span>&#10;<span class="nv">TIMEZONE</span><span class="o">=</span><span class="s2">&#34;/usr/share/zoneinfo/Europe/Madrid&#34;</span>&#10;<span class="nv">LOCALE</span><span class="o">=</span><span class="s2">&#34;es_ES.UTF-8 UTF-8&#34;</span>&#10;<span class="nv">LANG</span><span class="o">=</span><span class="s2">&#34;LANG=es_ES.UTF-8&#34;</span>&#10;<span class="nv">LANGUAGE</span><span class="o">=</span><span class="s2">&#34;LANGUAGE=es_ES:es:en_GB:en&#34;</span>&#10;<span class="nv">KEYMAP</span><span class="o">=</span><span class="s2">&#34;KEYMAP=es&#34;</span>&#10;<span class="nv">FONT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">FONT_MAP</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">HOSTNAME</span><span class="o">=</span><span class="s2">&#34;archlinux&#34;</span>&#10;<span class="nv">ROOT_PASSWORD</span><span class="o">=</span><span class="s2">&#34;archlinux&#34;</span> <span class="c1"># Warning: change it!</span>&#10;<span class="nv">ROOT_PASSWORD_RETYPE</span><span class="o">=</span><span class="s2">&#34;archlinux&#34;</span>&#10;&#10;<span class="c1"># user</span>&#10;<span class="nv">USER_NAME</span><span class="o">=</span><span class="s2">&#34;picodotdev&#34;</span>&#10;<span class="nv">USER_PASSWORD</span><span class="o">=</span><span class="s2">&#34;archlinux&#34;</span> <span class="c1"># Warning: change it!</span>&#10;<span class="nv">USER_PASSWORD_RETYPE</span><span class="o">=</span><span class="s2">&#34;archlinux&#34;</span>&#10;<span class="nv">ADDITIONAL_USER_NAMES</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="c1"># list separated by space</span>&#10;<span class="nv">ADDITIONAL_USER_PASSWORDS</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="c1"># list separated by space</span>&#10;&#10;<span class="c1"># bootloader</span>&#10;<span class="nv">BOOTLOADER</span><span class="o">=</span><span class="s2">&#34;grub&#34;</span> <span class="c1"># grub refind systemd</span>&#10;&#10;<span class="c1"># desktop (precede package name with ! for not install)</span>&#10;<span class="nv">DESKTOP_ENVIRONMENT</span><span class="o">=</span><span class="s2">&#34;!gnome !kde !xfce !mate !cinnamon !lxde&#34;</span>&#10;<span class="nv">DISPLAY_DRIVER</span><span class="o">=</span><span class="s2">&#34;!intel !amdgpu !ati !nvidia !nvidia-lts !nvidia-390xx !nvidia-390xx-lts !nvidia-340xx !nvidia-340xx-lts !nouveau&#34;</span>&#10;<span class="nv">KMS</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;<span class="nv">DISPLAY_DRIVER_DDX</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;<span class="nv">VULKAN</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;<span class="nv">DISPLAY_DRIVER_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;<span class="nv">DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="o">=</span><span class="s2">&#34;!intel-media-driver !libva-intel-driver&#34;</span>&#10;&#10;<span class="c1"># packages (precede package name with ! for not install)</span>&#10;<span class="nv">PACKAGES_PACMAN_INTERNET</span><span class="o">=</span><span class="s2">&#34;!firefox !chromium !apache !nginx !curl !wget !filezilla !sshfs !openssh !transmission-gtk !transmission-qt !amule !geary !thunderbird !empathy !kopete !polari !konversation !liferea !hugo !gnome-boxes&#34;</span>&#10;<span class="nv">PACKAGES_PACMAN_MULTIMEDIA</span><span class="o">=</span><span class="s2">&#34;!gthumb !gimp !imagemagick !krita !inkscape !blender !cmus !vlc !easytag !ardour !audacity !ffmpeg !gnome-phone-manager !kdeconnect !gstreamer !gst-plugins-good !gst-plugins-bad !gst-plugins-ugly !bluez !bluez-utils&#34;</span>&#10;<span class="nv">PACKAGES_PACMAN_UTILITIES</span><span class="o">=</span><span class="s2">&#34;!gnome-initial-setup !code !eclipse-java !intellij-idea-community-edition !gradle !maven !lz4 !meld !dosfstools !ntfs-3g !exfat-utils&#34;</span>&#10;<span class="nv">PACKAGES_PACMAN_DOCUMENTS_AND_TEXT</span><span class="o">=</span><span class="s2">&#34;!libreoffice-fresh !calligra !discount !lyx !vim !calibre&#34;</span>&#10;<span class="nv">PACKAGES_PACMAN_SECURITY</span><span class="o">=</span><span class="s2">&#34;!rsync !gnupg !keepassxc&#34;</span>&#10;<span class="nv">PACKAGES_PACMAN_SCIENCE</span><span class="o">=</span><span class="s2">&#34;!geogebra !octave&#34;</span>&#10;<span class="nv">PACKAGES_PACMAN_OTHERS</span><span class="o">=</span><span class="s2">&#34;!klavaro !tmux&#34;</span>&#10;<span class="nv">PACKAGES_PACMAN_DEVELOPER</span><span class="o">=</span><span class="s2">&#34;!jdk-openjdk !python !dotnet-sdk !php !rust !go !virtualbox !docker !ansible !vagrant&#34;</span>&#10;<span class="nv">PACKAGES_PACMAN_CUSTOM</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&#10;<span class="nv">AUR</span><span class="o">=</span><span class="s2">&#34;!yay !aurman&#34;</span>&#10;&#10;<span class="nv">PACKAGES_AUR_INTERNET</span><span class="o">=</span><span class="s2">&#34;!dropbox&#34;</span>&#10;<span class="nv">PACKAGES_AUR_MULTIMEDIA</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PACKAGES_AUR_UTILITIES</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PACKAGES_AUR_DOCUMENTS_AND_TEXT</span><span class="o">=</span><span class="s2">&#34;!wps-office&#34;</span>&#10;<span class="nv">PACKAGES_AUR_SECURITY</span><span class="o">=</span><span class="s2">&#34;!freefilesync&#34;</span>&#10;<span class="nv">PACKAGES_AUR_SCIENCE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PACKAGES_AUR_OTHERS</span><span class="o">=</span><span class="s2">&#34;!gnucash&#34;</span>&#10;<span class="nv">PACKAGES_AUR_DEVELOPER</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PACKAGES_AUR_CUSTOM</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&#10;<span class="nv">PACKAGES_PACMAN</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PACKAGES_PACMAN_INTERNET</span><span class="s2"> </span><span class="nv">$PACKAGES_PACMAN_MULTIMEDIA</span><span class="s2"> </span><span class="nv">$PACKAGES_PACMAN_UTILITIES</span><span class="s2"> </span><span class="nv">$PACKAGES_PACMAN_DOCUMENTS_AND_TEXT</span><span class="s2"> </span><span class="nv">$PACKAGES_PACMAN_SECURITY</span><span class="s2"> </span><span class="nv">$PACKAGES_PACMAN_SCIENCE</span><span class="s2"> </span><span class="nv">$PACKAGES_PACMAN_OTHERS</span><span class="s2"> </span><span class="nv">$PACKAGES_PACMAN_DEVELOPER</span><span class="s2"> </span><span class="nv">$PACKAGES_PACMAN_CUSTOM</span><span class="s2">&#34;</span>&#10;<span class="nv">PACKAGES_AUR</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PACKAGES_AUR_INTERNET</span><span class="s2"> </span><span class="nv">$PACKAGES_AUR_MULTIMEDIA</span><span class="s2"> </span><span class="nv">$PACKAGES_AUR_UTILITIES</span><span class="s2"> </span><span class="nv">$PACKAGES_AUR_DOCUMENTS_AND_TEXT</span><span class="s2"> </span><span class="nv">$PACKAGES_AUR_SECURITY</span><span class="s2"> </span><span class="nv">$PACKAGES_AUR_SCIENCE</span><span class="s2"> </span><span class="nv">$PACKAGES_AUR_OTHERS</span><span class="s2"> </span><span class="nv">$PACKAGES_AUR_DEVELOPER</span><span class="s2"> </span><span class="nv">$PACKAGES_AUR_CUSTOM</span><span class="s2">&#34;</span>&#10;&#10;<span class="c1">#reboot</span>&#10;<span class="nv">REBOOT</span><span class="o">=</span><span class="s2">&#34;true&#34;</span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>alis.conf</span>
    </div>
</div>
<p>Estas son algunas capturas de pantalla con diferentes entornos de escritorio que he probado con VirtualBox y un vídeo grabado con asciinema con el proceso completo de instalación.</p>
<div class="media">
<figure>
<p><a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-gnome_hu9b320e0da9c3f7b53e055de7bd0dea05_59051_2560x1440_fit_q90_box.jpg" data-gallery="data-gallery"><amp-img src="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-gnome_hu9b320e0da9c3f7b53e055de7bd0dea05_59051_300x200_fit_q90_box.jpg" width="267" height="200" alt="GNOME" title="GNOME"  class="lozad"></amp-img></a>
<a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-kde_huc1033173311b1fe983324c1eed546025_77308_2560x1440_fit_q90_box.jpg" data-gallery="data-gallery"><amp-img src="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-kde_huc1033173311b1fe983324c1eed546025_77308_300x200_fit_q90_box.jpg" width="267" height="200" alt="KDE" title="KDE"  class="lozad"></amp-img></a></p>
<figcaption>Entornos de escritorio GNOME y KDE</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-xfce_hu207a5cc7835aaa368efdd5626136b4e2_50488_2560x1440_fit_q90_box.jpg" data-gallery="data-gallery"><amp-img src="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-xfce_hu207a5cc7835aaa368efdd5626136b4e2_50488_300x200_fit_q90_box.jpg" width="267" height="200" alt="XFCE" title="XFCE"  class="lozad"></amp-img></a>
<a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-cinnamon_huada952b2201e9040ea05142b38c6dec4_57971_2560x1440_fit_q90_box.jpg" data-gallery="data-gallery"><amp-img src="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-cinnamon_huada952b2201e9040ea05142b38c6dec4_57971_300x200_fit_q90_box.jpg" width="267" height="200" alt="Cinnamon" title="Cinnamon"  class="lozad"></amp-img></a></p>
<figcaption>Entornos de escritorio Xfce y Cinnamon</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-lxde_huafe9060d5dbd54d661872c90b35b3c3e_60009_2560x1440_fit_q90_box.jpg" data-gallery="data-gallery"><amp-img src="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-lxde_huafe9060d5dbd54d661872c90b35b3c3e_60009_300x200_fit_q90_box.jpg" width="267" height="200" alt="LXDE" title="LXDE"  class="lozad"></amp-img></a>
<a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-mate_huc99153c03fd4a5e1c154432239083495_26705_2560x1440_fit_q90_box.jpg" data-gallery="data-gallery"><amp-img src="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-mate_huc99153c03fd4a5e1c154432239083495_26705_300x200_fit_q90_box.jpg" width="267" height="200" alt="Mate" title="Mate"  class="lozad"></amp-img></a></p>
<figcaption>Entornos de escritorio LXDE y Mate</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-root-password_hubb5350839af640196e4dc7ade488175e_3831_2560x1440_fit_box_2.png" data-gallery="data-gallery"><amp-img src="/blog-bitix/2017/01/script-de-instalacion-de-arch-linux-desatendido-automatizado-y-personalizable/images/archlinux-root-password_hubb5350839af640196e4dc7ade488175e_3831_300x200_fit_box_2.png" width="267" height="200" alt="Solicitud de contraseña para descifrar partición root" title="Solicitud de contraseña para descifrar partición root"  class="lozad"></amp-img></a></p>
<figcaption>Solicitud de contraseña para descifrar partición root</figcaption>
</figure>
</div>
<div class="media">
<a href="https://asciinema.org/a/192880" target="_blank"><amp-img src="https://asciinema.org/a/192880.png" width="650" height="563" class="lozad"></amp-img></a>
</div>
<p>El código del instalador no es muy complicado y mucho más sencillo que el <a href="https://github.com/AnarchyLinux/installer">código de AnarchyLinux</a> al no estar mezclado con los mensajes interactivos que hacen preguntas y esperan respuestas, además despues de configurar las variables e iniciado el proceso de instalación la misma se realiza de forma desatendida hasta completarse sin requerir que el usuario intruduzca más datos de forma interactiva. Los comandos que he recopilado de la receta son los que ejecutaríamos uno detrás de otro con únicamente el medio de instalación de Arch Linux. La función <em>main</em> contiene los pasos en los que consiste la instalación, desde el paticionado y cifrado del disco hasta el reinicio una vez completada la instalación, el resto de las funciones los comandos de ese paso de la instalación.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre class="chroma"><code><span class="lnt">   1&#10;</span><span class="lnt">   2&#10;</span><span class="lnt">   3&#10;</span><span class="lnt">   4&#10;</span><span class="lnt">   5&#10;</span><span class="lnt">   6&#10;</span><span class="lnt">   7&#10;</span><span class="lnt">   8&#10;</span><span class="lnt">   9&#10;</span><span class="lnt">  10&#10;</span><span class="lnt">  11&#10;</span><span class="lnt">  12&#10;</span><span class="lnt">  13&#10;</span><span class="lnt">  14&#10;</span><span class="lnt">  15&#10;</span><span class="lnt">  16&#10;</span><span class="lnt">  17&#10;</span><span class="lnt">  18&#10;</span><span class="lnt">  19&#10;</span><span class="lnt">  20&#10;</span><span class="lnt">  21&#10;</span><span class="lnt">  22&#10;</span><span class="lnt">  23&#10;</span><span class="lnt">  24&#10;</span><span class="lnt">  25&#10;</span><span class="lnt">  26&#10;</span><span class="lnt">  27&#10;</span><span class="lnt">  28&#10;</span><span class="lnt">  29&#10;</span><span class="lnt">  30&#10;</span><span class="lnt">  31&#10;</span><span class="lnt">  32&#10;</span><span class="lnt">  33&#10;</span><span class="lnt">  34&#10;</span><span class="lnt">  35&#10;</span><span class="lnt">  36&#10;</span><span class="lnt">  37&#10;</span><span class="lnt">  38&#10;</span><span class="lnt">  39&#10;</span><span class="lnt">  40&#10;</span><span class="lnt">  41&#10;</span><span class="lnt">  42&#10;</span><span class="lnt">  43&#10;</span><span class="lnt">  44&#10;</span><span class="lnt">  45&#10;</span><span class="lnt">  46&#10;</span><span class="lnt">  47&#10;</span><span class="lnt">  48&#10;</span><span class="lnt">  49&#10;</span><span class="lnt">  50&#10;</span><span class="lnt">  51&#10;</span><span class="lnt">  52&#10;</span><span class="lnt">  53&#10;</span><span class="lnt">  54&#10;</span><span class="lnt">  55&#10;</span><span class="lnt">  56&#10;</span><span class="lnt">  57&#10;</span><span class="lnt">  58&#10;</span><span class="lnt">  59&#10;</span><span class="lnt">  60&#10;</span><span class="lnt">  61&#10;</span><span class="lnt">  62&#10;</span><span class="lnt">  63&#10;</span><span class="lnt">  64&#10;</span><span class="lnt">  65&#10;</span><span class="lnt">  66&#10;</span><span class="lnt">  67&#10;</span><span class="lnt">  68&#10;</span><span class="lnt">  69&#10;</span><span class="lnt">  70&#10;</span><span class="lnt">  71&#10;</span><span class="lnt">  72&#10;</span><span class="lnt">  73&#10;</span><span class="lnt">  74&#10;</span><span class="lnt">  75&#10;</span><span class="lnt">  76&#10;</span><span class="lnt">  77&#10;</span><span class="lnt">  78&#10;</span><span class="lnt">  79&#10;</span><span class="lnt">  80&#10;</span><span class="lnt">  81&#10;</span><span class="lnt">  82&#10;</span><span class="lnt">  83&#10;</span><span class="lnt">  84&#10;</span><span class="lnt">  85&#10;</span><span class="lnt">  86&#10;</span><span class="lnt">  87&#10;</span><span class="lnt">  88&#10;</span><span class="lnt">  89&#10;</span><span class="lnt">  90&#10;</span><span class="lnt">  91&#10;</span><span class="lnt">  92&#10;</span><span class="lnt">  93&#10;</span><span class="lnt">  94&#10;</span><span class="lnt">  95&#10;</span><span class="lnt">  96&#10;</span><span class="lnt">  97&#10;</span><span class="lnt">  98&#10;</span><span class="lnt">  99&#10;</span><span class="lnt"> 100&#10;</span><span class="lnt"> 101&#10;</span><span class="lnt"> 102&#10;</span><span class="lnt"> 103&#10;</span><span class="lnt"> 104&#10;</span><span class="lnt"> 105&#10;</span><span class="lnt"> 106&#10;</span><span class="lnt"> 107&#10;</span><span class="lnt"> 108&#10;</span><span class="lnt"> 109&#10;</span><span class="lnt"> 110&#10;</span><span class="lnt"> 111&#10;</span><span class="lnt"> 112&#10;</span><span class="lnt"> 113&#10;</span><span class="lnt"> 114&#10;</span><span class="lnt"> 115&#10;</span><span class="lnt"> 116&#10;</span><span class="lnt"> 117&#10;</span><span class="lnt"> 118&#10;</span><span class="lnt"> 119&#10;</span><span class="lnt"> 120&#10;</span><span class="lnt"> 121&#10;</span><span class="lnt"> 122&#10;</span><span class="lnt"> 123&#10;</span><span class="lnt"> 124&#10;</span><span class="lnt"> 125&#10;</span><span class="lnt"> 126&#10;</span><span class="lnt"> 127&#10;</span><span class="lnt"> 128&#10;</span><span class="lnt"> 129&#10;</span><span class="lnt"> 130&#10;</span><span class="lnt"> 131&#10;</span><span class="lnt"> 132&#10;</span><span class="lnt"> 133&#10;</span><span class="lnt"> 134&#10;</span><span class="lnt"> 135&#10;</span><span class="lnt"> 136&#10;</span><span class="lnt"> 137&#10;</span><span class="lnt"> 138&#10;</span><span class="lnt"> 139&#10;</span><span class="lnt"> 140&#10;</span><span class="lnt"> 141&#10;</span><span class="lnt"> 142&#10;</span><span class="lnt"> 143&#10;</span><span class="lnt"> 144&#10;</span><span class="lnt"> 145&#10;</span><span class="lnt"> 146&#10;</span><span class="lnt"> 147&#10;</span><span class="lnt"> 148&#10;</span><span class="lnt"> 149&#10;</span><span class="lnt"> 150&#10;</span><span class="lnt"> 151&#10;</span><span class="lnt"> 152&#10;</span><span class="lnt"> 153&#10;</span><span class="lnt"> 154&#10;</span><span class="lnt"> 155&#10;</span><span class="lnt"> 156&#10;</span><span class="lnt"> 157&#10;</span><span class="lnt"> 158&#10;</span><span class="lnt"> 159&#10;</span><span class="lnt"> 160&#10;</span><span class="lnt"> 161&#10;</span><span class="lnt"> 162&#10;</span><span class="lnt"> 163&#10;</span><span class="lnt"> 164&#10;</span><span class="lnt"> 165&#10;</span><span class="lnt"> 166&#10;</span><span class="lnt"> 167&#10;</span><span class="lnt"> 168&#10;</span><span class="lnt"> 169&#10;</span><span class="lnt"> 170&#10;</span><span class="lnt"> 171&#10;</span><span class="lnt"> 172&#10;</span><span class="lnt"> 173&#10;</span><span class="lnt"> 174&#10;</span><span class="lnt"> 175&#10;</span><span class="lnt"> 176&#10;</span><span class="lnt"> 177&#10;</span><span class="lnt"> 178&#10;</span><span class="lnt"> 179&#10;</span><span class="lnt"> 180&#10;</span><span class="lnt"> 181&#10;</span><span class="lnt"> 182&#10;</span><span class="lnt"> 183&#10;</span><span class="lnt"> 184&#10;</span><span class="lnt"> 185&#10;</span><span class="lnt"> 186&#10;</span><span class="lnt"> 187&#10;</span><span class="lnt"> 188&#10;</span><span class="lnt"> 189&#10;</span><span class="lnt"> 190&#10;</span><span class="lnt"> 191&#10;</span><span class="lnt"> 192&#10;</span><span class="lnt"> 193&#10;</span><span class="lnt"> 194&#10;</span><span class="lnt"> 195&#10;</span><span class="lnt"> 196&#10;</span><span class="lnt"> 197&#10;</span><span class="lnt"> 198&#10;</span><span class="lnt"> 199&#10;</span><span class="lnt"> 200&#10;</span><span class="lnt"> 201&#10;</span><span class="lnt"> 202&#10;</span><span class="lnt"> 203&#10;</span><span class="lnt"> 204&#10;</span><span class="lnt"> 205&#10;</span><span class="lnt"> 206&#10;</span><span class="lnt"> 207&#10;</span><span class="lnt"> 208&#10;</span><span class="lnt"> 209&#10;</span><span class="lnt"> 210&#10;</span><span class="lnt"> 211&#10;</span><span class="lnt"> 212&#10;</span><span class="lnt"> 213&#10;</span><span class="lnt"> 214&#10;</span><span class="lnt"> 215&#10;</span><span class="lnt"> 216&#10;</span><span class="lnt"> 217&#10;</span><span class="lnt"> 218&#10;</span><span class="lnt"> 219&#10;</span><span class="lnt"> 220&#10;</span><span class="lnt"> 221&#10;</span><span class="lnt"> 222&#10;</span><span class="lnt"> 223&#10;</span><span class="lnt"> 224&#10;</span><span class="lnt"> 225&#10;</span><span class="lnt"> 226&#10;</span><span class="lnt"> 227&#10;</span><span class="lnt"> 228&#10;</span><span class="lnt"> 229&#10;</span><span class="lnt"> 230&#10;</span><span class="lnt"> 231&#10;</span><span class="lnt"> 232&#10;</span><span class="lnt"> 233&#10;</span><span class="lnt"> 234&#10;</span><span class="lnt"> 235&#10;</span><span class="lnt"> 236&#10;</span><span class="lnt"> 237&#10;</span><span class="lnt"> 238&#10;</span><span class="lnt"> 239&#10;</span><span class="lnt"> 240&#10;</span><span class="lnt"> 241&#10;</span><span class="lnt"> 242&#10;</span><span class="lnt"> 243&#10;</span><span class="lnt"> 244&#10;</span><span class="lnt"> 245&#10;</span><span class="lnt"> 246&#10;</span><span class="lnt"> 247&#10;</span><span class="lnt"> 248&#10;</span><span class="lnt"> 249&#10;</span><span class="lnt"> 250&#10;</span><span class="lnt"> 251&#10;</span><span class="lnt"> 252&#10;</span><span class="lnt"> 253&#10;</span><span class="lnt"> 254&#10;</span><span class="lnt"> 255&#10;</span><span class="lnt"> 256&#10;</span><span class="lnt"> 257&#10;</span><span class="lnt"> 258&#10;</span><span class="lnt"> 259&#10;</span><span class="lnt"> 260&#10;</span><span class="lnt"> 261&#10;</span><span class="lnt"> 262&#10;</span><span class="lnt"> 263&#10;</span><span class="lnt"> 264&#10;</span><span class="lnt"> 265&#10;</span><span class="lnt"> 266&#10;</span><span class="lnt"> 267&#10;</span><span class="lnt"> 268&#10;</span><span class="lnt"> 269&#10;</span><span class="lnt"> 270&#10;</span><span class="lnt"> 271&#10;</span><span class="lnt"> 272&#10;</span><span class="lnt"> 273&#10;</span><span class="lnt"> 274&#10;</span><span class="lnt"> 275&#10;</span><span class="lnt"> 276&#10;</span><span class="lnt"> 277&#10;</span><span class="lnt"> 278&#10;</span><span class="lnt"> 279&#10;</span><span class="lnt"> 280&#10;</span><span class="lnt"> 281&#10;</span><span class="lnt"> 282&#10;</span><span class="lnt"> 283&#10;</span><span class="lnt"> 284&#10;</span><span class="lnt"> 285&#10;</span><span class="lnt"> 286&#10;</span><span class="lnt"> 287&#10;</span><span class="lnt"> 288&#10;</span><span class="lnt"> 289&#10;</span><span class="lnt"> 290&#10;</span><span class="lnt"> 291&#10;</span><span class="lnt"> 292&#10;</span><span class="lnt"> 293&#10;</span><span class="lnt"> 294&#10;</span><span class="lnt"> 295&#10;</span><span class="lnt"> 296&#10;</span><span class="lnt"> 297&#10;</span><span class="lnt"> 298&#10;</span><span class="lnt"> 299&#10;</span><span class="lnt"> 300&#10;</span><span class="lnt"> 301&#10;</span><span class="lnt"> 302&#10;</span><span class="lnt"> 303&#10;</span><span class="lnt"> 304&#10;</span><span class="lnt"> 305&#10;</span><span class="lnt"> 306&#10;</span><span class="lnt"> 307&#10;</span><span class="lnt"> 308&#10;</span><span class="lnt"> 309&#10;</span><span class="lnt"> 310&#10;</span><span class="lnt"> 311&#10;</span><span class="lnt"> 312&#10;</span><span class="lnt"> 313&#10;</span><span class="lnt"> 314&#10;</span><span class="lnt"> 315&#10;</span><span class="lnt"> 316&#10;</span><span class="lnt"> 317&#10;</span><span class="lnt"> 318&#10;</span><span class="lnt"> 319&#10;</span><span class="lnt"> 320&#10;</span><span class="lnt"> 321&#10;</span><span class="lnt"> 322&#10;</span><span class="lnt"> 323&#10;</span><span class="lnt"> 324&#10;</span><span class="lnt"> 325&#10;</span><span class="lnt"> 326&#10;</span><span class="lnt"> 327&#10;</span><span class="lnt"> 328&#10;</span><span class="lnt"> 329&#10;</span><span class="lnt"> 330&#10;</span><span class="lnt"> 331&#10;</span><span class="lnt"> 332&#10;</span><span class="lnt"> 333&#10;</span><span class="lnt"> 334&#10;</span><span class="lnt"> 335&#10;</span><span class="lnt"> 336&#10;</span><span class="lnt"> 337&#10;</span><span class="lnt"> 338&#10;</span><span class="lnt"> 339&#10;</span><span class="lnt"> 340&#10;</span><span class="lnt"> 341&#10;</span><span class="lnt"> 342&#10;</span><span class="lnt"> 343&#10;</span><span class="lnt"> 344&#10;</span><span class="lnt"> 345&#10;</span><span class="lnt"> 346&#10;</span><span class="lnt"> 347&#10;</span><span class="lnt"> 348&#10;</span><span class="lnt"> 349&#10;</span><span class="lnt"> 350&#10;</span><span class="lnt"> 351&#10;</span><span class="lnt"> 352&#10;</span><span class="lnt"> 353&#10;</span><span class="lnt"> 354&#10;</span><span class="lnt"> 355&#10;</span><span class="lnt"> 356&#10;</span><span class="lnt"> 357&#10;</span><span class="lnt"> 358&#10;</span><span class="lnt"> 359&#10;</span><span class="lnt"> 360&#10;</span><span class="lnt"> 361&#10;</span><span class="lnt"> 362&#10;</span><span class="lnt"> 363&#10;</span><span class="lnt"> 364&#10;</span><span class="lnt"> 365&#10;</span><span class="lnt"> 366&#10;</span><span class="lnt"> 367&#10;</span><span class="lnt"> 368&#10;</span><span class="lnt"> 369&#10;</span><span class="lnt"> 370&#10;</span><span class="lnt"> 371&#10;</span><span class="lnt"> 372&#10;</span><span class="lnt"> 373&#10;</span><span class="lnt"> 374&#10;</span><span class="lnt"> 375&#10;</span><span class="lnt"> 376&#10;</span><span class="lnt"> 377&#10;</span><span class="lnt"> 378&#10;</span><span class="lnt"> 379&#10;</span><span class="lnt"> 380&#10;</span><span class="lnt"> 381&#10;</span><span class="lnt"> 382&#10;</span><span class="lnt"> 383&#10;</span><span class="lnt"> 384&#10;</span><span class="lnt"> 385&#10;</span><span class="lnt"> 386&#10;</span><span class="lnt"> 387&#10;</span><span class="lnt"> 388&#10;</span><span class="lnt"> 389&#10;</span><span class="lnt"> 390&#10;</span><span class="lnt"> 391&#10;</span><span class="lnt"> 392&#10;</span><span class="lnt"> 393&#10;</span><span class="lnt"> 394&#10;</span><span class="lnt"> 395&#10;</span><span class="lnt"> 396&#10;</span><span class="lnt"> 397&#10;</span><span class="lnt"> 398&#10;</span><span class="lnt"> 399&#10;</span><span class="lnt"> 400&#10;</span><span class="lnt"> 401&#10;</span><span class="lnt"> 402&#10;</span><span class="lnt"> 403&#10;</span><span class="lnt"> 404&#10;</span><span class="lnt"> 405&#10;</span><span class="lnt"> 406&#10;</span><span class="lnt"> 407&#10;</span><span class="lnt"> 408&#10;</span><span class="lnt"> 409&#10;</span><span class="lnt"> 410&#10;</span><span class="lnt"> 411&#10;</span><span class="lnt"> 412&#10;</span><span class="lnt"> 413&#10;</span><span class="lnt"> 414&#10;</span><span class="lnt"> 415&#10;</span><span class="lnt"> 416&#10;</span><span class="lnt"> 417&#10;</span><span class="lnt"> 418&#10;</span><span class="lnt"> 419&#10;</span><span class="lnt"> 420&#10;</span><span class="lnt"> 421&#10;</span><span class="lnt"> 422&#10;</span><span class="lnt"> 423&#10;</span><span class="lnt"> 424&#10;</span><span class="lnt"> 425&#10;</span><span class="lnt"> 426&#10;</span><span class="lnt"> 427&#10;</span><span class="lnt"> 428&#10;</span><span class="lnt"> 429&#10;</span><span class="lnt"> 430&#10;</span><span class="lnt"> 431&#10;</span><span class="lnt"> 432&#10;</span><span class="lnt"> 433&#10;</span><span class="lnt"> 434&#10;</span><span class="lnt"> 435&#10;</span><span class="lnt"> 436&#10;</span><span class="lnt"> 437&#10;</span><span class="lnt"> 438&#10;</span><span class="lnt"> 439&#10;</span><span class="lnt"> 440&#10;</span><span class="lnt"> 441&#10;</span><span class="lnt"> 442&#10;</span><span class="lnt"> 443&#10;</span><span class="lnt"> 444&#10;</span><span class="lnt"> 445&#10;</span><span class="lnt"> 446&#10;</span><span class="lnt"> 447&#10;</span><span class="lnt"> 448&#10;</span><span class="lnt"> 449&#10;</span><span class="lnt"> 450&#10;</span><span class="lnt"> 451&#10;</span><span class="lnt"> 452&#10;</span><span class="lnt"> 453&#10;</span><span class="lnt"> 454&#10;</span><span class="lnt"> 455&#10;</span><span class="lnt"> 456&#10;</span><span class="lnt"> 457&#10;</span><span class="lnt"> 458&#10;</span><span class="lnt"> 459&#10;</span><span class="lnt"> 460&#10;</span><span class="lnt"> 461&#10;</span><span class="lnt"> 462&#10;</span><span class="lnt"> 463&#10;</span><span class="lnt"> 464&#10;</span><span class="lnt"> 465&#10;</span><span class="lnt"> 466&#10;</span><span class="lnt"> 467&#10;</span><span class="lnt"> 468&#10;</span><span class="lnt"> 469&#10;</span><span class="lnt"> 470&#10;</span><span class="lnt"> 471&#10;</span><span class="lnt"> 472&#10;</span><span class="lnt"> 473&#10;</span><span class="lnt"> 474&#10;</span><span class="lnt"> 475&#10;</span><span class="lnt"> 476&#10;</span><span class="lnt"> 477&#10;</span><span class="lnt"> 478&#10;</span><span class="lnt"> 479&#10;</span><span class="lnt"> 480&#10;</span><span class="lnt"> 481&#10;</span><span class="lnt"> 482&#10;</span><span class="lnt"> 483&#10;</span><span class="lnt"> 484&#10;</span><span class="lnt"> 485&#10;</span><span class="lnt"> 486&#10;</span><span class="lnt"> 487&#10;</span><span class="lnt"> 488&#10;</span><span class="lnt"> 489&#10;</span><span class="lnt"> 490&#10;</span><span class="lnt"> 491&#10;</span><span class="lnt"> 492&#10;</span><span class="lnt"> 493&#10;</span><span class="lnt"> 494&#10;</span><span class="lnt"> 495&#10;</span><span class="lnt"> 496&#10;</span><span class="lnt"> 497&#10;</span><span class="lnt"> 498&#10;</span><span class="lnt"> 499&#10;</span><span class="lnt"> 500&#10;</span><span class="lnt"> 501&#10;</span><span class="lnt"> 502&#10;</span><span class="lnt"> 503&#10;</span><span class="lnt"> 504&#10;</span><span class="lnt"> 505&#10;</span><span class="lnt"> 506&#10;</span><span class="lnt"> 507&#10;</span><span class="lnt"> 508&#10;</span><span class="lnt"> 509&#10;</span><span class="lnt"> 510&#10;</span><span class="lnt"> 511&#10;</span><span class="lnt"> 512&#10;</span><span class="lnt"> 513&#10;</span><span class="lnt"> 514&#10;</span><span class="lnt"> 515&#10;</span><span class="lnt"> 516&#10;</span><span class="lnt"> 517&#10;</span><span class="lnt"> 518&#10;</span><span class="lnt"> 519&#10;</span><span class="lnt"> 520&#10;</span><span class="lnt"> 521&#10;</span><span class="lnt"> 522&#10;</span><span class="lnt"> 523&#10;</span><span class="lnt"> 524&#10;</span><span class="lnt"> 525&#10;</span><span class="lnt"> 526&#10;</span><span class="lnt"> 527&#10;</span><span class="lnt"> 528&#10;</span><span class="lnt"> 529&#10;</span><span class="lnt"> 530&#10;</span><span class="lnt"> 531&#10;</span><span class="lnt"> 532&#10;</span><span class="lnt"> 533&#10;</span><span class="lnt"> 534&#10;</span><span class="lnt"> 535&#10;</span><span class="lnt"> 536&#10;</span><span class="lnt"> 537&#10;</span><span class="lnt"> 538&#10;</span><span class="lnt"> 539&#10;</span><span class="lnt"> 540&#10;</span><span class="lnt"> 541&#10;</span><span class="lnt"> 542&#10;</span><span class="lnt"> 543&#10;</span><span class="lnt"> 544&#10;</span><span class="lnt"> 545&#10;</span><span class="lnt"> 546&#10;</span><span class="lnt"> 547&#10;</span><span class="lnt"> 548&#10;</span><span class="lnt"> 549&#10;</span><span class="lnt"> 550&#10;</span><span class="lnt"> 551&#10;</span><span class="lnt"> 552&#10;</span><span class="lnt"> 553&#10;</span><span class="lnt"> 554&#10;</span><span class="lnt"> 555&#10;</span><span class="lnt"> 556&#10;</span><span class="lnt"> 557&#10;</span><span class="lnt"> 558&#10;</span><span class="lnt"> 559&#10;</span><span class="lnt"> 560&#10;</span><span class="lnt"> 561&#10;</span><span class="lnt"> 562&#10;</span><span class="lnt"> 563&#10;</span><span class="lnt"> 564&#10;</span><span class="lnt"> 565&#10;</span><span class="lnt"> 566&#10;</span><span class="lnt"> 567&#10;</span><span class="lnt"> 568&#10;</span><span class="lnt"> 569&#10;</span><span class="lnt"> 570&#10;</span><span class="lnt"> 571&#10;</span><span class="lnt"> 572&#10;</span><span class="lnt"> 573&#10;</span><span class="lnt"> 574&#10;</span><span class="lnt"> 575&#10;</span><span class="lnt"> 576&#10;</span><span class="lnt"> 577&#10;</span><span class="lnt"> 578&#10;</span><span class="lnt"> 579&#10;</span><span class="lnt"> 580&#10;</span><span class="lnt"> 581&#10;</span><span class="lnt"> 582&#10;</span><span class="lnt"> 583&#10;</span><span class="lnt"> 584&#10;</span><span class="lnt"> 585&#10;</span><span class="lnt"> 586&#10;</span><span class="lnt"> 587&#10;</span><span class="lnt"> 588&#10;</span><span class="lnt"> 589&#10;</span><span class="lnt"> 590&#10;</span><span class="lnt"> 591&#10;</span><span class="lnt"> 592&#10;</span><span class="lnt"> 593&#10;</span><span class="lnt"> 594&#10;</span><span class="lnt"> 595&#10;</span><span class="lnt"> 596&#10;</span><span class="lnt"> 597&#10;</span><span class="lnt"> 598&#10;</span><span class="lnt"> 599&#10;</span><span class="lnt"> 600&#10;</span><span class="lnt"> 601&#10;</span><span class="lnt"> 602&#10;</span><span class="lnt"> 603&#10;</span><span class="lnt"> 604&#10;</span><span class="lnt"> 605&#10;</span><span class="lnt"> 606&#10;</span><span class="lnt"> 607&#10;</span><span class="lnt"> 608&#10;</span><span class="lnt"> 609&#10;</span><span class="lnt"> 610&#10;</span><span class="lnt"> 611&#10;</span><span class="lnt"> 612&#10;</span><span class="lnt"> 613&#10;</span><span class="lnt"> 614&#10;</span><span class="lnt"> 615&#10;</span><span class="lnt"> 616&#10;</span><span class="lnt"> 617&#10;</span><span class="lnt"> 618&#10;</span><span class="lnt"> 619&#10;</span><span class="lnt"> 620&#10;</span><span class="lnt"> 621&#10;</span><span class="lnt"> 622&#10;</span><span class="lnt"> 623&#10;</span><span class="lnt"> 624&#10;</span><span class="lnt"> 625&#10;</span><span class="lnt"> 626&#10;</span><span class="lnt"> 627&#10;</span><span class="lnt"> 628&#10;</span><span class="lnt"> 629&#10;</span><span class="lnt"> 630&#10;</span><span class="lnt"> 631&#10;</span><span class="lnt"> 632&#10;</span><span class="lnt"> 633&#10;</span><span class="lnt"> 634&#10;</span><span class="lnt"> 635&#10;</span><span class="lnt"> 636&#10;</span><span class="lnt"> 637&#10;</span><span class="lnt"> 638&#10;</span><span class="lnt"> 639&#10;</span><span class="lnt"> 640&#10;</span><span class="lnt"> 641&#10;</span><span class="lnt"> 642&#10;</span><span class="lnt"> 643&#10;</span><span class="lnt"> 644&#10;</span><span class="lnt"> 645&#10;</span><span class="lnt"> 646&#10;</span><span class="lnt"> 647&#10;</span><span class="lnt"> 648&#10;</span><span class="lnt"> 649&#10;</span><span class="lnt"> 650&#10;</span><span class="lnt"> 651&#10;</span><span class="lnt"> 652&#10;</span><span class="lnt"> 653&#10;</span><span class="lnt"> 654&#10;</span><span class="lnt"> 655&#10;</span><span class="lnt"> 656&#10;</span><span class="lnt"> 657&#10;</span><span class="lnt"> 658&#10;</span><span class="lnt"> 659&#10;</span><span class="lnt"> 660&#10;</span><span class="lnt"> 661&#10;</span><span class="lnt"> 662&#10;</span><span class="lnt"> 663&#10;</span><span class="lnt"> 664&#10;</span><span class="lnt"> 665&#10;</span><span class="lnt"> 666&#10;</span><span class="lnt"> 667&#10;</span><span class="lnt"> 668&#10;</span><span class="lnt"> 669&#10;</span><span class="lnt"> 670&#10;</span><span class="lnt"> 671&#10;</span><span class="lnt"> 672&#10;</span><span class="lnt"> 673&#10;</span><span class="lnt"> 674&#10;</span><span class="lnt"> 675&#10;</span><span class="lnt"> 676&#10;</span><span class="lnt"> 677&#10;</span><span class="lnt"> 678&#10;</span><span class="lnt"> 679&#10;</span><span class="lnt"> 680&#10;</span><span class="lnt"> 681&#10;</span><span class="lnt"> 682&#10;</span><span class="lnt"> 683&#10;</span><span class="lnt"> 684&#10;</span><span class="lnt"> 685&#10;</span><span class="lnt"> 686&#10;</span><span class="lnt"> 687&#10;</span><span class="lnt"> 688&#10;</span><span class="lnt"> 689&#10;</span><span class="lnt"> 690&#10;</span><span class="lnt"> 691&#10;</span><span class="lnt"> 692&#10;</span><span class="lnt"> 693&#10;</span><span class="lnt"> 694&#10;</span><span class="lnt"> 695&#10;</span><span class="lnt"> 696&#10;</span><span class="lnt"> 697&#10;</span><span class="lnt"> 698&#10;</span><span class="lnt"> 699&#10;</span><span class="lnt"> 700&#10;</span><span class="lnt"> 701&#10;</span><span class="lnt"> 702&#10;</span><span class="lnt"> 703&#10;</span><span class="lnt"> 704&#10;</span><span class="lnt"> 705&#10;</span><span class="lnt"> 706&#10;</span><span class="lnt"> 707&#10;</span><span class="lnt"> 708&#10;</span><span class="lnt"> 709&#10;</span><span class="lnt"> 710&#10;</span><span class="lnt"> 711&#10;</span><span class="lnt"> 712&#10;</span><span class="lnt"> 713&#10;</span><span class="lnt"> 714&#10;</span><span class="lnt"> 715&#10;</span><span class="lnt"> 716&#10;</span><span class="lnt"> 717&#10;</span><span class="lnt"> 718&#10;</span><span class="lnt"> 719&#10;</span><span class="lnt"> 720&#10;</span><span class="lnt"> 721&#10;</span><span class="lnt"> 722&#10;</span><span class="lnt"> 723&#10;</span><span class="lnt"> 724&#10;</span><span class="lnt"> 725&#10;</span><span class="lnt"> 726&#10;</span><span class="lnt"> 727&#10;</span><span class="lnt"> 728&#10;</span><span class="lnt"> 729&#10;</span><span class="lnt"> 730&#10;</span><span class="lnt"> 731&#10;</span><span class="lnt"> 732&#10;</span><span class="lnt"> 733&#10;</span><span class="lnt"> 734&#10;</span><span class="lnt"> 735&#10;</span><span class="lnt"> 736&#10;</span><span class="lnt"> 737&#10;</span><span class="lnt"> 738&#10;</span><span class="lnt"> 739&#10;</span><span class="lnt"> 740&#10;</span><span class="lnt"> 741&#10;</span><span class="lnt"> 742&#10;</span><span class="lnt"> 743&#10;</span><span class="lnt"> 744&#10;</span><span class="lnt"> 745&#10;</span><span class="lnt"> 746&#10;</span><span class="lnt"> 747&#10;</span><span class="lnt"> 748&#10;</span><span class="lnt"> 749&#10;</span><span class="lnt"> 750&#10;</span><span class="lnt"> 751&#10;</span><span class="lnt"> 752&#10;</span><span class="lnt"> 753&#10;</span><span class="lnt"> 754&#10;</span><span class="lnt"> 755&#10;</span><span class="lnt"> 756&#10;</span><span class="lnt"> 757&#10;</span><span class="lnt"> 758&#10;</span><span class="lnt"> 759&#10;</span><span class="lnt"> 760&#10;</span><span class="lnt"> 761&#10;</span><span class="lnt"> 762&#10;</span><span class="lnt"> 763&#10;</span><span class="lnt"> 764&#10;</span><span class="lnt"> 765&#10;</span><span class="lnt"> 766&#10;</span><span class="lnt"> 767&#10;</span><span class="lnt"> 768&#10;</span><span class="lnt"> 769&#10;</span><span class="lnt"> 770&#10;</span><span class="lnt"> 771&#10;</span><span class="lnt"> 772&#10;</span><span class="lnt"> 773&#10;</span><span class="lnt"> 774&#10;</span><span class="lnt"> 775&#10;</span><span class="lnt"> 776&#10;</span><span class="lnt"> 777&#10;</span><span class="lnt"> 778&#10;</span><span class="lnt"> 779&#10;</span><span class="lnt"> 780&#10;</span><span class="lnt"> 781&#10;</span><span class="lnt"> 782&#10;</span><span class="lnt"> 783&#10;</span><span class="lnt"> 784&#10;</span><span class="lnt"> 785&#10;</span><span class="lnt"> 786&#10;</span><span class="lnt"> 787&#10;</span><span class="lnt"> 788&#10;</span><span class="lnt"> 789&#10;</span><span class="lnt"> 790&#10;</span><span class="lnt"> 791&#10;</span><span class="lnt"> 792&#10;</span><span class="lnt"> 793&#10;</span><span class="lnt"> 794&#10;</span><span class="lnt"> 795&#10;</span><span class="lnt"> 796&#10;</span><span class="lnt"> 797&#10;</span><span class="lnt"> 798&#10;</span><span class="lnt"> 799&#10;</span><span class="lnt"> 800&#10;</span><span class="lnt"> 801&#10;</span><span class="lnt"> 802&#10;</span><span class="lnt"> 803&#10;</span><span class="lnt"> 804&#10;</span><span class="lnt"> 805&#10;</span><span class="lnt"> 806&#10;</span><span class="lnt"> 807&#10;</span><span class="lnt"> 808&#10;</span><span class="lnt"> 809&#10;</span><span class="lnt"> 810&#10;</span><span class="lnt"> 811&#10;</span><span class="lnt"> 812&#10;</span><span class="lnt"> 813&#10;</span><span class="lnt"> 814&#10;</span><span class="lnt"> 815&#10;</span><span class="lnt"> 816&#10;</span><span class="lnt"> 817&#10;</span><span class="lnt"> 818&#10;</span><span class="lnt"> 819&#10;</span><span class="lnt"> 820&#10;</span><span class="lnt"> 821&#10;</span><span class="lnt"> 822&#10;</span><span class="lnt"> 823&#10;</span><span class="lnt"> 824&#10;</span><span class="lnt"> 825&#10;</span><span class="lnt"> 826&#10;</span><span class="lnt"> 827&#10;</span><span class="lnt"> 828&#10;</span><span class="lnt"> 829&#10;</span><span class="lnt"> 830&#10;</span><span class="lnt"> 831&#10;</span><span class="lnt"> 832&#10;</span><span class="lnt"> 833&#10;</span><span class="lnt"> 834&#10;</span><span class="lnt"> 835&#10;</span><span class="lnt"> 836&#10;</span><span class="lnt"> 837&#10;</span><span class="lnt"> 838&#10;</span><span class="lnt"> 839&#10;</span><span class="lnt"> 840&#10;</span><span class="lnt"> 841&#10;</span><span class="lnt"> 842&#10;</span><span class="lnt"> 843&#10;</span><span class="lnt"> 844&#10;</span><span class="lnt"> 845&#10;</span><span class="lnt"> 846&#10;</span><span class="lnt"> 847&#10;</span><span class="lnt"> 848&#10;</span><span class="lnt"> 849&#10;</span><span class="lnt"> 850&#10;</span><span class="lnt"> 851&#10;</span><span class="lnt"> 852&#10;</span><span class="lnt"> 853&#10;</span><span class="lnt"> 854&#10;</span><span class="lnt"> 855&#10;</span><span class="lnt"> 856&#10;</span><span class="lnt"> 857&#10;</span><span class="lnt"> 858&#10;</span><span class="lnt"> 859&#10;</span><span class="lnt"> 860&#10;</span><span class="lnt"> 861&#10;</span><span class="lnt"> 862&#10;</span><span class="lnt"> 863&#10;</span><span class="lnt"> 864&#10;</span><span class="lnt"> 865&#10;</span><span class="lnt"> 866&#10;</span><span class="lnt"> 867&#10;</span><span class="lnt"> 868&#10;</span><span class="lnt"> 869&#10;</span><span class="lnt"> 870&#10;</span><span class="lnt"> 871&#10;</span><span class="lnt"> 872&#10;</span><span class="lnt"> 873&#10;</span><span class="lnt"> 874&#10;</span><span class="lnt"> 875&#10;</span><span class="lnt"> 876&#10;</span><span class="lnt"> 877&#10;</span><span class="lnt"> 878&#10;</span><span class="lnt"> 879&#10;</span><span class="lnt"> 880&#10;</span><span class="lnt"> 881&#10;</span><span class="lnt"> 882&#10;</span><span class="lnt"> 883&#10;</span><span class="lnt"> 884&#10;</span><span class="lnt"> 885&#10;</span><span class="lnt"> 886&#10;</span><span class="lnt"> 887&#10;</span><span class="lnt"> 888&#10;</span><span class="lnt"> 889&#10;</span><span class="lnt"> 890&#10;</span><span class="lnt"> 891&#10;</span><span class="lnt"> 892&#10;</span><span class="lnt"> 893&#10;</span><span class="lnt"> 894&#10;</span><span class="lnt"> 895&#10;</span><span class="lnt"> 896&#10;</span><span class="lnt"> 897&#10;</span><span class="lnt"> 898&#10;</span><span class="lnt"> 899&#10;</span><span class="lnt"> 900&#10;</span><span class="lnt"> 901&#10;</span><span class="lnt"> 902&#10;</span><span class="lnt"> 903&#10;</span><span class="lnt"> 904&#10;</span><span class="lnt"> 905&#10;</span><span class="lnt"> 906&#10;</span><span class="lnt"> 907&#10;</span><span class="lnt"> 908&#10;</span><span class="lnt"> 909&#10;</span><span class="lnt"> 910&#10;</span><span class="lnt"> 911&#10;</span><span class="lnt"> 912&#10;</span><span class="lnt"> 913&#10;</span><span class="lnt"> 914&#10;</span><span class="lnt"> 915&#10;</span><span class="lnt"> 916&#10;</span><span class="lnt"> 917&#10;</span><span class="lnt"> 918&#10;</span><span class="lnt"> 919&#10;</span><span class="lnt"> 920&#10;</span><span class="lnt"> 921&#10;</span><span class="lnt"> 922&#10;</span><span class="lnt"> 923&#10;</span><span class="lnt"> 924&#10;</span><span class="lnt"> 925&#10;</span><span class="lnt"> 926&#10;</span><span class="lnt"> 927&#10;</span><span class="lnt"> 928&#10;</span><span class="lnt"> 929&#10;</span><span class="lnt"> 930&#10;</span><span class="lnt"> 931&#10;</span><span class="lnt"> 932&#10;</span><span class="lnt"> 933&#10;</span><span class="lnt"> 934&#10;</span><span class="lnt"> 935&#10;</span><span class="lnt"> 936&#10;</span><span class="lnt"> 937&#10;</span><span class="lnt"> 938&#10;</span><span class="lnt"> 939&#10;</span><span class="lnt"> 940&#10;</span><span class="lnt"> 941&#10;</span><span class="lnt"> 942&#10;</span><span class="lnt"> 943&#10;</span><span class="lnt"> 944&#10;</span><span class="lnt"> 945&#10;</span><span class="lnt"> 946&#10;</span><span class="lnt"> 947&#10;</span><span class="lnt"> 948&#10;</span><span class="lnt"> 949&#10;</span><span class="lnt"> 950&#10;</span><span class="lnt"> 951&#10;</span><span class="lnt"> 952&#10;</span><span class="lnt"> 953&#10;</span><span class="lnt"> 954&#10;</span><span class="lnt"> 955&#10;</span><span class="lnt"> 956&#10;</span><span class="lnt"> 957&#10;</span><span class="lnt"> 958&#10;</span><span class="lnt"> 959&#10;</span><span class="lnt"> 960&#10;</span><span class="lnt"> 961&#10;</span><span class="lnt"> 962&#10;</span><span class="lnt"> 963&#10;</span><span class="lnt"> 964&#10;</span><span class="lnt"> 965&#10;</span><span class="lnt"> 966&#10;</span><span class="lnt"> 967&#10;</span><span class="lnt"> 968&#10;</span><span class="lnt"> 969&#10;</span><span class="lnt"> 970&#10;</span><span class="lnt"> 971&#10;</span><span class="lnt"> 972&#10;</span><span class="lnt"> 973&#10;</span><span class="lnt"> 974&#10;</span><span class="lnt"> 975&#10;</span><span class="lnt"> 976&#10;</span><span class="lnt"> 977&#10;</span><span class="lnt"> 978&#10;</span><span class="lnt"> 979&#10;</span><span class="lnt"> 980&#10;</span><span class="lnt"> 981&#10;</span><span class="lnt"> 982&#10;</span><span class="lnt"> 983&#10;</span><span class="lnt"> 984&#10;</span><span class="lnt"> 985&#10;</span><span class="lnt"> 986&#10;</span><span class="lnt"> 987&#10;</span><span class="lnt"> 988&#10;</span><span class="lnt"> 989&#10;</span><span class="lnt"> 990&#10;</span><span class="lnt"> 991&#10;</span><span class="lnt"> 992&#10;</span><span class="lnt"> 993&#10;</span><span class="lnt"> 994&#10;</span><span class="lnt"> 995&#10;</span><span class="lnt"> 996&#10;</span><span class="lnt"> 997&#10;</span><span class="lnt"> 998&#10;</span><span class="lnt"> 999&#10;</span><span class="lnt">1000&#10;</span><span class="lnt">1001&#10;</span><span class="lnt">1002&#10;</span><span class="lnt">1003&#10;</span><span class="lnt">1004&#10;</span><span class="lnt">1005&#10;</span><span class="lnt">1006&#10;</span><span class="lnt">1007&#10;</span><span class="lnt">1008&#10;</span><span class="lnt">1009&#10;</span><span class="lnt">1010&#10;</span><span class="lnt">1011&#10;</span><span class="lnt">1012&#10;</span><span class="lnt">1013&#10;</span><span class="lnt">1014&#10;</span><span class="lnt">1015&#10;</span><span class="lnt">1016&#10;</span><span class="lnt">1017&#10;</span><span class="lnt">1018&#10;</span><span class="lnt">1019&#10;</span><span class="lnt">1020&#10;</span><span class="lnt">1021&#10;</span><span class="lnt">1022&#10;</span><span class="lnt">1023&#10;</span><span class="lnt">1024&#10;</span><span class="lnt">1025&#10;</span><span class="lnt">1026&#10;</span><span class="lnt">1027&#10;</span><span class="lnt">1028&#10;</span><span class="lnt">1029&#10;</span><span class="lnt">1030&#10;</span><span class="lnt">1031&#10;</span><span class="lnt">1032&#10;</span><span class="lnt">1033&#10;</span><span class="lnt">1034&#10;</span><span class="lnt">1035&#10;</span><span class="lnt">1036&#10;</span><span class="lnt">1037&#10;</span><span class="lnt">1038&#10;</span><span class="lnt">1039&#10;</span><span class="lnt">1040&#10;</span><span class="lnt">1041&#10;</span><span class="lnt">1042&#10;</span><span class="lnt">1043&#10;</span><span class="lnt">1044&#10;</span><span class="lnt">1045&#10;</span><span class="lnt">1046&#10;</span><span class="lnt">1047&#10;</span><span class="lnt">1048&#10;</span><span class="lnt">1049&#10;</span><span class="lnt">1050&#10;</span><span class="lnt">1051&#10;</span><span class="lnt">1052&#10;</span><span class="lnt">1053&#10;</span><span class="lnt">1054&#10;</span><span class="lnt">1055&#10;</span><span class="lnt">1056&#10;</span><span class="lnt">1057&#10;</span><span class="lnt">1058&#10;</span><span class="lnt">1059&#10;</span><span class="lnt">1060&#10;</span><span class="lnt">1061&#10;</span><span class="lnt">1062&#10;</span><span class="lnt">1063&#10;</span><span class="lnt">1064&#10;</span><span class="lnt">1065&#10;</span><span class="lnt">1066&#10;</span><span class="lnt">1067&#10;</span><span class="lnt">1068&#10;</span><span class="lnt">1069&#10;</span><span class="lnt">1070&#10;</span><span class="lnt">1071&#10;</span><span class="lnt">1072&#10;</span><span class="lnt">1073&#10;</span><span class="lnt">1074&#10;</span><span class="lnt">1075&#10;</span><span class="lnt">1076&#10;</span><span class="lnt">1077&#10;</span><span class="lnt">1078&#10;</span><span class="lnt">1079&#10;</span><span class="lnt">1080&#10;</span><span class="lnt">1081&#10;</span><span class="lnt">1082&#10;</span><span class="lnt">1083&#10;</span><span class="lnt">1084&#10;</span><span class="lnt">1085&#10;</span><span class="lnt">1086&#10;</span><span class="lnt">1087&#10;</span><span class="lnt">1088&#10;</span><span class="lnt">1089&#10;</span><span class="lnt">1090&#10;</span><span class="lnt">1091&#10;</span><span class="lnt">1092&#10;</span><span class="lnt">1093&#10;</span><span class="lnt">1094&#10;</span><span class="lnt">1095&#10;</span><span class="lnt">1096&#10;</span><span class="lnt">1097&#10;</span><span class="lnt">1098&#10;</span><span class="lnt">1099&#10;</span><span class="lnt">1100&#10;</span><span class="lnt">1101&#10;</span><span class="lnt">1102&#10;</span><span class="lnt">1103&#10;</span><span class="lnt">1104&#10;</span><span class="lnt">1105&#10;</span><span class="lnt">1106&#10;</span><span class="lnt">1107&#10;</span><span class="lnt">1108&#10;</span><span class="lnt">1109&#10;</span><span class="lnt">1110&#10;</span><span class="lnt">1111&#10;</span><span class="lnt">1112&#10;</span><span class="lnt">1113&#10;</span><span class="lnt">1114&#10;</span><span class="lnt">1115&#10;</span><span class="lnt">1116&#10;</span><span class="lnt">1117&#10;</span><span class="lnt">1118&#10;</span><span class="lnt">1119&#10;</span><span class="lnt">1120&#10;</span><span class="lnt">1121&#10;</span><span class="lnt">1122&#10;</span><span class="lnt">1123&#10;</span><span class="lnt">1124&#10;</span><span class="lnt">1125&#10;</span><span class="lnt">1126&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/usr/bin/env bash&#10;</span><span class="cp"></span><span class="nb">set</span> -e&#10;&#10;<span class="c1"># Arch Linux Install Script (alis) installs unattended, automated</span>&#10;<span class="c1"># and customized Arch Linux system.</span>&#10;<span class="c1"># Copyright (C) 2018 picodotdev</span>&#10;&#10;<span class="c1"># This program is free software: you can redistribute it and/or modify</span>&#10;<span class="c1"># it under the terms of the GNU General Public License as published by</span>&#10;<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>&#10;<span class="c1"># (at your option) any later version.</span>&#10;#&#10;<span class="c1"># This program is distributed in the hope that it will be useful,</span>&#10;<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>&#10;<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>&#10;<span class="c1"># GNU General Public License for more details.</span>&#10;#&#10;<span class="c1"># You should have received a copy of the GNU General Public License</span>&#10;<span class="c1"># along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>&#10;&#10;<span class="c1"># This script is hosted at https://github.com/picodotdev/alis. For new features,</span>&#10;<span class="c1"># improvements and bugs fill an issue in GitHub or make a pull request.</span>&#10;<span class="c1"># Pull Request are welcome!</span>&#10;#&#10;<span class="c1"># If you test it in real hardware please send me an email to pico.dev@gmail.com with</span>&#10;<span class="c1"># the machine description and tell me if somethig goes wrong or all works fine.</span>&#10;#&#10;<span class="c1"># Please, don&#39;t ask for support for this script in Arch Linux forums, first read</span>&#10;<span class="c1"># the Arch Linux wiki [1], the Installation Guide [2] and the General</span>&#10;<span class="c1"># Recomendations [3], later compare the commands with those of this script.</span>&#10;#&#10;<span class="c1"># [1] https://wiki.archlinux.org</span>&#10;<span class="c1"># [2] https://wiki.archlinux.org/index.php/Installation_guide</span>&#10;<span class="c1"># [3] https://wiki.archlinux.org/index.php/General_recommendations</span>&#10;&#10;<span class="c1"># Usage:</span>&#10;<span class="c1"># # loadkeys es</span>&#10;<span class="c1"># # curl https://raw.githubusercontent.com/picodotdev/alis/master/download.sh | bash, or with URL shortener curl -sL https://bit.ly/2F3CATp | bash</span>&#10;<span class="c1"># # vim alis.conf</span>&#10;<span class="c1"># # ./alis.sh</span>&#10;&#10;<span class="c1"># global variables (no configuration, don&#39;t edit)</span>&#10;<span class="nv">ASCIINEMA</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">BIOS_TYPE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PARTITION_BIOS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">LVM_VOLUME_PHISICAL</span><span class="o">=</span><span class="s2">&#34;lvm&#34;</span>&#10;<span class="nv">LVM_VOLUME_GROUP</span><span class="o">=</span><span class="s2">&#34;vg&#34;</span>&#10;<span class="nv">LVM_VOLUME_LOGICAL</span><span class="o">=</span><span class="s2">&#34;root&#34;</span>&#10;<span class="nv">BOOT_DIRECTORY</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">ESP_DIRECTORY</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="c1">#PARTITION_BOOT_NUMBER=0</span>&#10;<span class="nv">UUID_BOOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">UUID_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PARTUUID_BOOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">PARTUUID_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">DEVICE_SATA</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">DEVICE_NVME</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">CPU_INTEL</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">VIRTUALBOX</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">CMDLINE_LINUX_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;<span class="nv">ADDITIONAL_USER_NAMES_ARRAY</span><span class="o">=</span><span class="o">(</span><span class="o">)</span>&#10;<span class="nv">ADDITIONAL_USER_PASSWORDS_ARRAY</span><span class="o">=</span><span class="o">(</span><span class="o">)</span>&#10;&#10;<span class="nv">LOG</span><span class="o">=</span><span class="s2">&#34;alis.log&#34;</span>&#10;<span class="nv">RED</span><span class="o">=</span><span class="s1">&#39;\033[0;31m&#39;</span>&#10;<span class="nv">GREEN</span><span class="o">=</span><span class="s1">&#39;\033[0;32m&#39;</span>&#10;<span class="nv">LIGHT_BLUE</span><span class="o">=</span><span class="s1">&#39;\033[1;34m&#39;</span>&#10;<span class="nv">NC</span><span class="o">=</span><span class="s1">&#39;\033[0m&#39;</span>&#10;&#10;<span class="k">function</span> configuration_install<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">source</span> alis.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ADDITIONAL_USER_NAMES_ARRAY</span><span class="o">=</span><span class="o">(</span><span class="nv">$ADDITIONAL_USER_NAMES</span><span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ADDITIONAL_USER_PASSWORDS_ARRAY</span><span class="o">=</span><span class="o">(</span><span class="nv">$ADDITIONAL_USER_PASSWORDS</span><span class="o">)</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> sanitize_variables<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$DEVICE</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">FILE_SYSTEM_TYPE</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SWAP_SIZE</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$SWAP_SIZE</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">KERNELS</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">KERNELS_COMPRESSION</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DESKTOP_ENVIRONMENT</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$DESKTOP_ENVIRONMENT</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DISPLAY_DRIVER</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_PACMAN</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$PACKAGES_PACMAN</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">AUR</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$AUR</span><span class="s2">&#34;</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_AUR</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$PACKAGES_AUR</span><span class="s2">&#34;</span><span class="k">)</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> sanitize_variable<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="nv">$1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$VARIABLE</span> <span class="p">|</span> sed <span class="s2">&#34;s/![^ ]*//g&#34;</span><span class="k">)</span> <span class="c1"># remove disabled</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$VARIABLE</span> <span class="p">|</span> sed <span class="s2">&#34;s/ {2,}/ /g&#34;</span><span class="k">)</span> <span class="c1"># remove unnecessary white spaces</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$VARIABLE</span> <span class="p">|</span> sed <span class="s1">&#39;s/^[[:space:]]*//&#39;</span><span class="k">)</span> <span class="c1"># trim leading</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$VARIABLE</span> <span class="p">|</span> sed <span class="s1">&#39;s/[[:space:]]*$//&#39;</span><span class="k">)</span> <span class="c1"># trim trailing</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$VARIABLE</span><span class="s2">&#34;</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> check_variables<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;KEYS&#34;</span> <span class="s2">&#34;</span><span class="nv">$KEYS</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;LOG&#34;</span> <span class="s2">&#34;</span><span class="nv">$LOG</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;DEVICE&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;LVM&#34;</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_equals <span class="s2">&#34;PARTITION_ROOT_ENCRYPTION_PASSWORD&#34;</span> <span class="s2">&#34;PARTITION_ROOT_ENCRYPTION_PASSWORD_RETYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD_RETYPE</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;FILE_SYSTEM_TYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="s2">&#34;ext4 btrfs xfs&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;PING_HOSTNAME&#34;</span> <span class="s2">&#34;</span><span class="nv">$PING_HOSTNAME</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;PACMAN_MIRROR&#34;</span> <span class="s2">&#34;</span><span class="nv">$PACMAN_MIRROR</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;KERNELS&#34;</span> <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span> <span class="s2">&#34;linux-lts linux-lts-headers linux-hardened linux-hardened-headers linux-zen linux-zen-headers&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;KERNELS_COMPRESSION&#34;</span> <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> <span class="s2">&#34;gzip bzip2 lzma xz lzop lz4&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;TIMEZONE&#34;</span> <span class="s2">&#34;</span><span class="nv">$TIMEZONE</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;LOCALE&#34;</span> <span class="s2">&#34;</span><span class="nv">$LOCALE</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;LANG&#34;</span> <span class="s2">&#34;</span><span class="nv">$LANG</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;KEYMAP&#34;</span> <span class="s2">&#34;</span><span class="nv">$KEYMAP</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;HOSTNAME&#34;</span> <span class="s2">&#34;</span><span class="nv">$HOSTNAME</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;USER_NAME&#34;</span> <span class="s2">&#34;</span><span class="nv">$USER_NAME</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;USER_PASSWORD&#34;</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_equals <span class="s2">&#34;ROOT_PASSWORD&#34;</span> <span class="s2">&#34;ROOT_PASSWORD_RETYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$ROOT_PASSWORD</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$ROOT_PASSWORD_RETYPE</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_equals <span class="s2">&#34;USER_PASSWORD&#34;</span> <span class="s2">&#34;USER_PASSWORD_RETYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD_RETYPE</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_size <span class="s2">&#34;ADDITIONAL_USER_PASSWORDS&#34;</span> <span class="s2">&#34;</span><span class="si">${#</span><span class="nv">ADDITIONAL_USER_NAMES_ARRAY</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${#</span><span class="nv">ADDITIONAL_USER_PASSWORDS_ARRAY</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;BOOTLOADER&#34;</span> <span class="s2">&#34;</span><span class="nv">$BOOTLOADER</span><span class="s2">&#34;</span> <span class="s2">&#34;grub refind systemd&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;AUR&#34;</span> <span class="s2">&#34;</span><span class="nv">$AUR</span><span class="s2">&#34;</span> <span class="s2">&#34;aurman yay&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;DESKTOP_ENVIRONMENT&#34;</span> <span class="s2">&#34;</span><span class="nv">$DESKTOP_ENVIRONMENT</span><span class="s2">&#34;</span> <span class="s2">&#34;gnome kde xfce mate cinnamon lxde&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;DISPLAY_DRIVER&#34;</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> <span class="s2">&#34;intel amdgpu ati nvidia nvidia-lts nvidia-390xx nvidia-390xx-lts nvidia-340xx nvidia-340xx-lts nouveau&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;KMS&#34;</span> <span class="s2">&#34;</span><span class="nv">$KMS</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;DISPLAY_DRIVER_DDX&#34;</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_DDX</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;DISPLAY_DRIVER_HARDWARE_ACCELERATION&#34;</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL&#34;</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="s2">&#34;</span> <span class="s2">&#34;intel-media-driver libva-intel-driver&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;REBOOT&#34;</span> <span class="s2">&#34;</span><span class="nv">$REBOOT</span><span class="s2">&#34;</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> check_variables_value<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME</span><span class="o">=</span><span class="nv">$1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE</span><span class="o">=</span><span class="nv">$2</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2"> environment variable must have a value.</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> check_variables_boolean<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME</span><span class="o">=</span><span class="nv">$1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE</span><span class="o">=</span><span class="nv">$2</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span> <span class="s2">&#34;true false&#34;</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> check_variables_list<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME</span><span class="o">=</span><span class="nv">$1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE</span><span class="o">=</span><span class="nv">$2</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUES</span><span class="o">=</span><span class="nv">$3</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REQUIRED</span><span class="o">=</span><span class="nv">$4</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$REQUIRED</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;&#34;</span> -o <span class="s2">&#34;</span><span class="nv">$REQUIRED</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;&#34;</span> -a -z <span class="s2">&#34;</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$VALUES</span><span class="s2">&#34;</span> <span class="p">|</span> grep -F -w <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2"> environment variable value [</span><span class="nv">$VALUE</span><span class="s2">] must be in [</span><span class="nv">$VALUES</span><span class="s2">].</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> check_variables_equals<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME1</span><span class="o">=</span><span class="nv">$1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME2</span><span class="o">=</span><span class="nv">$2</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE1</span><span class="o">=</span><span class="nv">$3</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE2</span><span class="o">=</span><span class="nv">$4</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VALUE1</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;</span><span class="nv">$VALUE2</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NAME1</span><span class="s2"> and </span><span class="nv">$NAME2</span><span class="s2"> must be equal [</span><span class="nv">$VALUE1</span><span class="s2">, </span><span class="nv">$VALUE2</span><span class="s2">].</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> check_variables_size<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME</span><span class="o">=</span><span class="nv">$1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SIZE_EXPECT</span><span class="o">=</span><span class="nv">$2</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SIZE</span><span class="o">=</span><span class="nv">$3</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SIZE_EXPECT</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;</span><span class="nv">$SIZE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2"> array size [</span><span class="nv">$SIZE</span><span class="s2">] must be [</span><span class="nv">$SIZE_EXPECT</span><span class="s2">].</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> warning<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2">Welcome to Arch Linux Install Script</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">Warning</span><span class="s2">&#34;</span><span class="s1">&#39;!&#39;</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">This script deletes all partitions of the persistent</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">storage and continuing all your data in it will be lost.</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -p <span class="s2">&#34;Do you want to continue? [y/N] &#34;</span> yn&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="nv">$yn</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">[</span>Yy<span class="o">]</span>* <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">[</span>Nn<span class="o">]</span>* <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> init<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># init() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;init_log&#10;&nbsp;&nbsp;&nbsp;&nbsp;loadkeys <span class="nv">$KEYS</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> init_log<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LOG</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exec</span> &gt; &gt;<span class="o">(</span>tee -a <span class="nv">$LOG</span><span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exec</span> 2&gt; &gt;<span class="o">(</span>tee -a <span class="nv">$LOG</span> &gt;<span class="p">&amp;</span>2<span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> -o xtrace&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> facts<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># facts() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -d /sys/firmware/efi <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BIOS_TYPE</span><span class="o">=</span><span class="s2">&#34;uefi&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BIOS_TYPE</span><span class="o">=</span><span class="s2">&#34;bios&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -f alis.asciinema <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ASCIINEMA</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ASCIINEMA</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_SATA</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_NVME</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$DEVICE</span> <span class="p">|</span> grep <span class="s2">&#34;^/dev/sda&#34;</span><span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_SATA</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$DEVICE</span> <span class="p">|</span> grep <span class="s2">&#34;^/dev/nvme&#34;</span><span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_NVME</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span>lscpu <span class="p">|</span> grep GenuineIntel<span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CPU_INTEL</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span>lspci <span class="p">|</span> grep -i virtualbox<span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VIRTUALBOX</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> check_facts<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BOOTLOADER</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;refind&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;BIOS_TYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="s2">&#34;uefi&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BOOTLOADER</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;systemd&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;BIOS_TYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="s2">&#34;uefi&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> prepare<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># prepare() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;configure_time&#10;&nbsp;&nbsp;&nbsp;&nbsp;prepare_partition&#10;&nbsp;&nbsp;&nbsp;&nbsp;configure_network&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> configure_time<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;timedatectl set-ntp <span class="nb">true</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> prepare_partition<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -d /mnt/boot <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umount /mnt/boot&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umount /mnt&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -e <span class="s2">&#34;</span><span class="s2">/dev/mapper/</span><span class="nv">$LVM_VOLUME_LOGICAL</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptsetup close <span class="nv">$LVM_VOLUME_LOGICAL</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -e <span class="s2">&#34;</span><span class="s2">/dev/mapper/</span><span class="nv">$LVM_VOLUME_PHISICAL</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvremove --force <span class="s2">&#34;</span><span class="nv">$LVM_VOLUME_GROUP</span><span class="s2">-</span><span class="nv">$LVM_VOLUME_LOGICAL</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vgremove --force <span class="s2">&#34;</span><span class="s2">/dev/mapper/</span><span class="nv">$LVM_VOLUME_GROUP</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pvremove <span class="s2">&#34;</span><span class="s2">/dev/mapper/</span><span class="nv">$LVM_VOLUME_PHISICAL</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptsetup close <span class="nv">$LVM_VOLUME_PHISICAL</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;partprobe <span class="nv">$DEVICE</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> configure_network<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$WIFI_INTERFACE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp /etc/netctl/examples/wireless-wpa /etc/netctl&#10;&nbsp;&nbsp;&nbsp;&nbsp;  	chmod <span class="m">600</span> /etc/netctl&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;  	sed -i <span class="s1">&#39;s/^Interface=.*/Interface=&#39;</span><span class="s2">&#34;</span><span class="nv">$WIFI_INTERFACE</span><span class="s2">&#34;</span><span class="s1">&#39;/&#39;</span> /etc/netctl&#10;&nbsp;&nbsp;&nbsp;&nbsp;  	sed -i <span class="s1">&#39;s/^ESSID=.*/ESSID=&#39;</span><span class="s2">&#34;</span><span class="nv">$WIFI_ESSID</span><span class="s2">&#34;</span><span class="s1">&#39;/&#39;</span> /etc/netctl&#10;&nbsp;&nbsp;&nbsp;&nbsp;  	sed -i <span class="s1">&#39;s/^Key=.*/Key=&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;$WIFI_KEY&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;/&#39;</span> /etc/netctl&#10;&nbsp;&nbsp;&nbsp;&nbsp;  	<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$WIFI_HIDDEN</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;  		sed -i <span class="s1">&#39;s/^#Hidden=.*/Hidden=yes/&#39;</span> /etc/netctl&#10;&nbsp;&nbsp;&nbsp;&nbsp;  	<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;  	netctl start wireless-wpa&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;ping -c <span class="m">5</span> <span class="nv">$PING_HOSTNAME</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Network ping check failed. Cannot continue.&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> partition<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># partition() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;sgdisk --zap-all <span class="nv">$DEVICE</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;wipefs -a <span class="nv">$DEVICE</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;uefi&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_SATA</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">1</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">2</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">#PARTITION_BOOT_NUMBER=1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">2</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_NVME</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p1</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">#PARTITION_BOOT_NUMBER=1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parted -s <span class="nv">$DEVICE</span> mklabel gpt mkpart primary fat32 1MiB 512MiB mkpart primary <span class="nv">$FILE_SYSTEM_TYPE</span> 512MiB 100% <span class="nb">set</span> <span class="m">1</span> boot on&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgdisk -t<span class="o">=</span>1:ef00 <span class="nv">$DEVICE</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgdisk -t<span class="o">=</span>2:8e00 <span class="nv">$DEVICE</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;bios&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_SATA</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BIOS</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">1</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">2</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">3</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">#PARTITION_BOOT_NUMBER=2</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">3</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_NVME</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BIOS</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p1</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p3</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">#PARTITION_BOOT_NUMBER=2</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p3</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parted -s <span class="nv">$DEVICE</span> mklabel gpt mkpart primary fat32 1MiB 128MiB mkpart primary <span class="nv">$FILE_SYSTEM_TYPE</span> 128MiB 512MiB mkpart primary <span class="nv">$FILE_SYSTEM_TYPE</span> 512MiB 100% <span class="nb">set</span> <span class="m">1</span> boot on&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgdisk -t<span class="o">=</span>1:ef02 <span class="nv">$DEVICE</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgdisk -t<span class="o">=</span>3:8e00 <span class="nv">$DEVICE</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="p">|</span> cryptsetup --key-size<span class="o">=</span><span class="m">512</span> --key-file<span class="o">=</span>- luksFormat --type luks2 <span class="nv">$PARTITION_ROOT</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="p">|</span> cryptsetup --key-file<span class="o">=</span>- open <span class="nv">$PARTITION_ROOT</span> <span class="nv">$LVM_VOLUME_PHISICAL</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep <span class="m">5</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pvcreate /dev/mapper/<span class="nv">$LVM_VOLUME_PHISICAL</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vgcreate <span class="nv">$LVM_VOLUME_GROUP</span> /dev/mapper/<span class="nv">$LVM_VOLUME_PHISICAL</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvcreate -l 100%FREE -n <span class="nv">$LVM_VOLUME_LOGICAL</span> <span class="nv">$LVM_VOLUME_GROUP</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">/dev/mapper/</span><span class="nv">$LVM_VOLUME_GROUP</span><span class="s2">-</span><span class="nv">$LVM_VOLUME_LOGICAL</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;uefi&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wipefs -a <span class="nv">$PARTITION_BOOT</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wipefs -a <span class="nv">$DEVICE_ROOT</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkfs.fat -n ESP -F32 <span class="nv">$PARTITION_BOOT</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkfs.<span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> -L root <span class="nv">$DEVICE_ROOT</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;bios&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wipefs -a <span class="nv">$PARTITION_BIOS</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wipefs -a <span class="nv">$PARTITION_BOOT</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wipefs -a <span class="nv">$DEVICE_ROOT</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkfs.fat -n BIOS -F32 <span class="nv">$PARTITION_BIOS</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkfs.<span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> -L boot <span class="nv">$PARTITION_BOOT</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkfs.<span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> -L root <span class="nv">$DEVICE_ROOT</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_OPTIONS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_TRIM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_OPTIONS</span><span class="o">=</span><span class="s2">&#34;defaults,noatime&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;</span><span class="nv">$PARTITION_OPTIONS</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span> /mnt&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;mkdir /mnt/boot&#10;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;</span><span class="nv">$PARTITION_OPTIONS</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_BOOT</span><span class="s2">&#34;</span> /mnt/boot&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SWAP_SIZE</span><span class="s2">&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;btrfs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fallocate -l <span class="nv">$SWAP_SIZE</span> /mnt/swap&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmod <span class="m">600</span> /mnt/swap&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkswap /mnt/swap&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BOOT_DIRECTORY</span><span class="o">=</span>/boot&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ESP_DIRECTORY</span><span class="o">=</span>/boot&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">UUID_BOOT</span><span class="o">=</span><span class="k">$(</span>blkid -s UUID -o value <span class="nv">$PARTITION_BOOT</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">UUID_ROOT</span><span class="o">=</span><span class="k">$(</span>blkid -s UUID -o value <span class="nv">$PARTITION_ROOT</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTUUID_BOOT</span><span class="o">=</span><span class="k">$(</span>blkid -s PARTUUID -o value <span class="nv">$PARTITION_BOOT</span><span class="k">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTUUID_ROOT</span><span class="o">=</span><span class="k">$(</span>blkid -s PARTUUID -o value <span class="nv">$PARTITION_ROOT</span><span class="k">)</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> install<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># install() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PACMAN_MIRROR</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">Server=</span><span class="nv">$PACMAN_MIRROR</span><span class="s2">&#34;</span> &gt; /etc/pacman.d/mirrorlist&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/#Color/Color/&#39;</span> /etc/pacman.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/#TotalDownload/TotalDownload/&#39;</span> /etc/pacman.conf&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacstrap /mnt base base-devel&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/#Color/Color/&#39;</span> /mnt/etc/pacman.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/#TotalDownload/TotalDownload/&#39;</span> /mnt/etc/pacman.conf&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_TRIM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> fstrim.timer&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> kernels<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># kernels() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;linux-headers&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> configuration<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># configuration() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;genfstab -U /mnt &gt;&gt; /mnt/etc/fstab&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SWAP_SIZE</span><span class="s2">&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;btrfs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;# swap&#34;</span> &gt;&gt; /mnt/etc/fstab&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;/swap none swap defaults 0 0&#34;</span> &gt;&gt; /mnt/etc/fstab&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; /mnt/etc/fstab&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_TRIM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/relatime/noatime/&#39;</span> /mnt/etc/fstab&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/issue_discards = 0/issue_discards = 1/&#39;</span> /mnt/etc/lvm/lvm.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt ln -s -f <span class="nv">$TIMEZONE</span> /etc/localtime&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt hwclock --systohc&#10;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;</span><span class="s2">s/#</span><span class="nv">$LOCALE</span><span class="s2">/</span><span class="nv">$LOCALE</span><span class="s2">/</span><span class="s2">&#34;</span> /mnt/etc/locale.gen&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt locale-gen&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$LANG</span><span class="s2">\n</span><span class="nv">$LANGUAGE</span><span class="s2">&#34;</span> &gt; /mnt/etc/locale.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$KEYMAP</span><span class="s2">\n</span><span class="nv">$FONT</span><span class="s2">\n</span><span class="nv">$FONT_MAP</span><span class="s2">&#34;</span> &gt; /mnt/etc/vconsole.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="nv">$HOSTNAME</span> &gt; /mnt/etc/hostname&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SWAP_SIZE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;vm.swappiness=10&#34;</span> &gt; /mnt/etc/sysctl.d/99-sysctl.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">printf</span> <span class="s2">&#34;</span><span class="nv">$ROOT_PASSWORD</span><span class="s2">\n</span><span class="nv">$ROOT_PASSWORD</span><span class="s2">&#34;</span> <span class="p">|</span> arch-chroot /mnt passwd&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> network<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># network() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;networkmanager&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> NetworkManager.service&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> virtualbox<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># virtualbox() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;virtualbox-guest-utils virtualbox-guest-modules-arch&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;virtualbox-guest-utils virtualbox-guest-dkms&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> mkinitcpio<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># mkinitcpio() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KMS</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;intel&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;i915&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-390xx&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-390xx-lts&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;nvidia nvidia_modeset nvidia_uvm nvidia_drm&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;amdgpu&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;amdgpu&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;ati&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;radeon&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nouveau&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;nouveau&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s2">&#34;</span><span class="s2">s/MODULES=()/MODULES=(</span><span class="nv">$MODULES</span><span class="s2">)/</span><span class="s2">&#34;</span> /etc/mkinitcpio.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> -a -n <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/ block / block keyboard keymap /&#39;</span> /etc/mkinitcpio.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/ filesystems keyboard / encrypt lvm2 filesystems /&#39;</span> /etc/mkinitcpio.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/ filesystems / lvm2 filesystems /&#39;</span> /etc/mkinitcpio.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/ block / block keyboard keymap /&#39;</span> /etc/mkinitcpio.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/ filesystems keyboard / encrypt filesystems /&#39;</span> /etc/mkinitcpio.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s2">&#34;</span><span class="s2">s/#COMPRESSION=\&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">\&#34;/COMPRESSION=\&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">\&#34;/</span><span class="s2">&#34;</span> /etc/mkinitcpio.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt mkinitcpio -P&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> bootloader<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># bootloader() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BOOTLOADER_ALLOW_DISCARDS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_INTEL</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;intel-ucode&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">root=</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">root=PARTUUID=</span><span class="nv">$PARTUUID_ROOT</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_TRIM</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BOOTLOADER_ALLOW_DISCARDS</span><span class="o">=</span><span class="s2">&#34;:allow-discards&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">cryptdevice=PARTUUID=</span><span class="nv">$PARTUUID_ROOT</span><span class="s2">:</span><span class="nv">$LVM_VOLUME_PHISICAL</span><span class="nv">$BOOTLOADER_ALLOW_DISCARDS</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KMS</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-390xx&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-390xx-lts&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> nvidia-drm.modeset=1</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$BOOTLOADER</span><span class="s2">&#34;</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;grub&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grub&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;refind&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refind&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;systemd&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;systemd&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> grub<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;grub dosfstools&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/GRUB_DEFAULT=0/GRUB_DEFAULT=saved/&#39;</span> /etc/default/grub&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/#GRUB_SAVEDEFAULT=&#34;true&#34;/GRUB_SAVEDEFAULT=&#34;true&#34;/&#39;</span> /etc/default/grub&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/GRUB_CMDLINE_LINUX_DEFAULT=&#34;quiet&#34;/GRUB_CMDLINE_LINUX_DEFAULT=&#34;&#34;/&#39;</span> /etc/default/grub&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/GRUB_CMDLINE_LINUX=&#34;&#34;/GRUB_CMDLINE_LINUX=&#34;&#39;</span><span class="nv">$CMDLINE_LINUX</span><span class="s1">&#39;&#34;/&#39;</span> /etc/default/grub&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; /mnt/etc/default/grub&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;# alis&#34;</span> &gt;&gt; /mnt/etc/default/grub&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;GRUB_DISABLE_SUBMENU=y&#34;</span> &gt;&gt; /mnt/etc/default/grub&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;uefi&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;efibootmgr&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt grub-install --target<span class="o">=</span>x86_64-efi --bootloader-id<span class="o">=</span>grub --efi-directory<span class="o">=</span><span class="nv">$ESP_DIRECTORY</span> --recheck&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">#arch-chroot /mnt efibootmgr --create --disk $DEVICE --part $PARTITION_BOOT_NUMBER --loader /EFI/grub/grubx64.efi --label &#34;GRUB Boot Manager&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;bios&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt grub-install --target<span class="o">=</span>i386-pc --recheck <span class="nv">$DEVICE</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt grub-mkconfig -o <span class="s2">&#34;</span><span class="nv">$BOOT_DIRECTORY</span><span class="s2">/grub/grub.cfg</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;\EFI\grub\grubx64.efi&#34;</span> &gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/startup.nsh</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> refind<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;refind-efi&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt refind-install&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt rm /boot/refind_linux.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/^timeout.*/timeout 5/&#39;</span> <span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/^#scan_all_linux_kernels.*/scan_all_linux_kernels false/&#39;</span> <span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">#arch-chroot /mnt sed -i &#39;s/^#default_selection &#34;+,bzImage,vmlinuz&#34;/default_selection &#34;+,bzImage,vmlinuz&#34;/&#39; &#34;$ESP_DIRECTORY/EFI/refind/refind.conf&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REFIND_MICROCODE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_INTEL</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REFIND_MICROCODE</span><span class="o">=</span><span class="s2">&#34;initrd=/intel-ucode.img&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;# alis&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;menuentry \&#34;Arch Linux\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">&nbsp;&nbsp;&nbsp;&nbsp;volume   </span><span class="nv">$PARTUUID_BOOT</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;loader   /vmlinuz-linux&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;initrd   /initramfs-linux.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;icon&nbsp;&nbsp;&nbsp;&nbsp; /EFI/refind/icons/os_arch.png&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">&nbsp;&nbsp;&nbsp;&nbsp;options  \&#34;</span><span class="nv">$REFIND_MICROCODE</span><span class="s2"> </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2">\&#34;</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;submenuentry \&#34;Boot using fallback initramfs\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;	&nbsp;&nbsp;&nbsp;&nbsp;  initrd /initramfs-linux-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;submenuentry \&#34;Boot to terminal\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;	&nbsp;&nbsp;&nbsp;&nbsp;  add_options \&#34;systemd.unit=multi-user.target\&#34;&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span><span class="o">[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-lts.* <span class="o">]</span><span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;menuentry \&#34;Arch Linux (lts)\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">&nbsp;&nbsp;&nbsp;&nbsp;volume   </span><span class="nv">$PARTUUID_BOOT</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;loader   /vmlinuz-linux-lts&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;initrd   /initramfs-linux-lts.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;icon&nbsp;&nbsp;&nbsp;&nbsp; /EFI/refind/icons/os_arch.png&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">&nbsp;&nbsp;&nbsp;&nbsp;options  \&#34;</span><span class="nv">$REFIND_MICROCODE</span><span class="s2"> </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2">\&#34;</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;submenuentry \&#34;Boot using fallback initramfs\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;	&nbsp;&nbsp;&nbsp;&nbsp;  initrd /initramfs-linux-lts-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;submenuentry \&#34;Boot to terminal\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;	&nbsp;&nbsp;&nbsp;&nbsp;  add_options \&#34;systemd.unit=multi-user.target\&#34;&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span><span class="o">[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-hardened.* <span class="o">]</span><span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;menuentry \&#34;Arch Linux (hardened)\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">&nbsp;&nbsp;&nbsp;&nbsp;volume   </span><span class="nv">$PARTUUID_BOOT</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;loader   /vmlinuz-linux-hardened&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;initrd   /initramfs-linux-hardened.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;icon&nbsp;&nbsp;&nbsp;&nbsp; /EFI/refind/icons/os_arch.png&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">&nbsp;&nbsp;&nbsp;&nbsp;options  \&#34;</span><span class="nv">$REFIND_MICROCODE</span><span class="s2"> </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2">\&#34;</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;submenuentry \&#34;Boot using fallback initramfs\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;	&nbsp;&nbsp;&nbsp;&nbsp;  initrd /initramfs-linux-hardened-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;submenuentry \&#34;Boot to terminal\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;	&nbsp;&nbsp;&nbsp;&nbsp;  add_options \&#34;systemd.unit=multi-user.target\&#34;&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span><span class="o">[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-zen.* <span class="o">]</span><span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;menuentry \&#34;Arch Linux (zen)\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">&nbsp;&nbsp;&nbsp;&nbsp;volume   </span><span class="nv">$PARTUUID_BOOT</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;loader   /vmlinuz-linux-zen&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;initrd   /initramfs-linux-zen.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;icon&nbsp;&nbsp;&nbsp;&nbsp; /EFI/refind/icons/os_arch.png&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">&nbsp;&nbsp;&nbsp;&nbsp;options  \&#34;</span><span class="nv">$REFIND_MICROCODE</span><span class="s2"> </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2">\&#34;</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;submenuentry \&#34;Boot using fallback initramfs\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;	&nbsp;&nbsp;&nbsp;&nbsp;  initrd /initramfs-linux-zen-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;submenuentry \&#34;Boot to terminal\&#34; {&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;	&nbsp;&nbsp;&nbsp;&nbsp;  add_options \&#34;systemd.unit=multi-user.target\&#34;&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;}&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;\EFI\refind\refind_x64.efi&#34;</span> &gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/startup.nsh</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> systemd<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt bootctl --path<span class="o">=</span><span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">&#34;</span> install&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt mkdir -p <span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt mkdir -p <span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;# alis&#34;</span> &gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/loader.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;timeout 5&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/loader.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;default archlinux&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/loader.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;editor 0&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/loader.conf</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt mkdir -p <span class="s2">&#34;/etc/pacman.d/hooks/&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;[Trigger]&#34;</span> &gt;&gt; /mnt/etc/pacman.d/hooks/systemd-boot.hook&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Type = Package&#34;</span> &gt;&gt; /mnt/etc/pacman.d/hooks/systemd-boot.hook&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Operation = Upgrade&#34;</span> &gt;&gt; /mnt/etc/pacman.d/hooks/systemd-boot.hook&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Target = systemd&#34;</span> &gt;&gt; /mnt/etc/pacman.d/hooks/systemd-boot.hook&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; /mnt/etc/pacman.d/hooks/systemd-boot.hook&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;[Action]&#34;</span> &gt;&gt; /mnt/etc/pacman.d/hooks/systemd-boot.hook&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Description = Updating systemd-boot...&#34;</span> &gt;&gt; /mnt/etc/pacman.d/hooks/systemd-boot.hook&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;When = PostTransaction&#34;</span> &gt;&gt; /mnt/etc/pacman.d/hooks/systemd-boot.hook&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Exec = /usr/bin/bootctl update&#34;</span> &gt;&gt; /mnt/etc/pacman.d/hooks/systemd-boot.hook&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SYSTEMD_MICROCODE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SYSTEMD_OPTIONS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_INTEL</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SYSTEMD_MICROCODE</span><span class="o">=</span><span class="s2">&#34;/intel-ucode.img&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT_ENCRYPTION_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;   <span class="nv">SYSTEMD_OPTIONS</span><span class="o">=</span><span class="s2">&#34;rd.luks.options=discard&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">options initrd=initramfs-linux.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (fallback)&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">options initrd=initramfs-linux-fallback.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span><span class="o">[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-lts.* <span class="o">]</span><span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (lts)&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-lts&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-lts.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">options initrd=initramfs-linux-lts.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts.conf</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (lts-fallback)&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-lts&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_INTEL</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-lts-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">options initrd=initramfs-linux-lts-fallback.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span><span class="o">[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-hardened.* <span class="o">]</span><span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (hardened)&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-hardened&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-hardened.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">options initrd=initramfs-linux-hardened.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened.conf</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (hardened-fallback)&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-hardened&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-hardened-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">options initrd=initramfs-linux-hardened-fallback.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span><span class="o">[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-zen.* <span class="o">]</span><span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (zen)&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-zen&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-zen.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">options initrd=initramfs-linux-zen.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen.conf</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (zen-fallback)&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-zen&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-zen-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="s2">options initrd=initramfs-linux-zen-fallback.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;\EFI\systemd\systemd-bootx64.efi&#34;</span> &gt; <span class="s2">&#34;</span><span class="s2">/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/startup.nsh</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> users<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;create_user <span class="nv">$USER_NAME</span> <span class="nv">$USER_PASSWORD</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> i in <span class="si">${</span><span class="p">!ADDITIONAL_USER_NAMES_ARRAY[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_user <span class="si">${</span><span class="nv">ADDITIONAL_USER_NAMES_ARRAY</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span> <span class="si">${</span><span class="nv">ADDITIONAL_USER_PASSWORDS_ARRAY</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;&#10;	arch-chroot /mnt sed -i <span class="s1">&#39;s/# %wheel ALL=(ALL) ALL/%wheel ALL=(ALL) ALL/&#39;</span> /etc/sudoers&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> create_user<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># create_user() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;	<span class="nv">USER_NAME</span><span class="o">=</span><span class="nv">$1</span>&#10;	<span class="nv">USER_PASSWORD</span><span class="o">=</span><span class="nv">$2</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt useradd -m -G wheel,storage,optical -s /bin/bash <span class="nv">$USER_NAME</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">printf</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">&#34;</span> <span class="p">|</span> arch-chroot /mnt passwd <span class="nv">$USER_NAME</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> desktop_environment<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># desktop_environment() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia nvidia-dkms&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-lts&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-lts nvidia-dkms&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-390xx nvidia-390xx-dkms&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx-lts&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-390xx-lts nvidia-390xx-dkms&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-340xx&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-340xx nvidia-340xx-dkms&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-340xx-lts&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-340xx-lts nvidia-340xx-dkms&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_DDX</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;intel&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;xf86-video-intel&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;amdgpu&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;xf86-video-amdgpu&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;ati&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;xf86-video-ati&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nouveau&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;xf86-video-nouveau&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VULKAN</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;intel&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;vulkan-icd-loader vulkan-intel&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;amdgpu&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;vulkan-icd-loader vulkan-radeon&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;ati&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nouveau&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;intel&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;intel-media-driver&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;amdgpu&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;ati&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;mesa-vdpau&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nouveau&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;</span><span class="s2">mesa </span><span class="nv">$PACKAGES_DRIVER</span><span class="s2"> </span><span class="nv">$PACKAGES_DDX</span><span class="s2"> </span><span class="nv">$PACKAGES_VULKAN</span><span class="s2"> </span><span class="nv">$PACKAGES_HARDWARE_ACCELERATION</span><span class="s2">&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DESKTOP_ENVIRONMENT</span><span class="s2">&#34;</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;gnome&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_gnome&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;kde&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_kde&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;xfce&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_xfce&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;mate&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_mate&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;cinnamon&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_cinnamon&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;lxde&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_lxde&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> desktop_environment_gnome<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;gnome gnome-extra&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> gdm.service&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> desktop_environment_kde<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;plasma-meta kde-applications-meta&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/Current=.*/Current=breeze/&#39;</span> /etc/sddm.conf&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> sddm.service&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> desktop_environment_xfce<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;xfce4 xfce4-goodies lightdm lightdm-gtk-greeter&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lightdm.service&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> desktop_environment_mate<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;mate mate-extra lightdm lightdm-gtk-greeter&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lightdm.service&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> desktop_environment_cinnamon<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;cinnamon lightdm lightdm-gtk-greeter&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lightdm.service&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> desktop_environment_lxde<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;clxde lxdm&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lxdm.service&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> packages<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># packages() step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;btrfs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;btrfs-progs&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PACKAGES_PACMAN</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;</span><span class="nv">$PACKAGES_PACMAN</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;packages_aur&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> packages_aur<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$AUR</span><span class="s2">&#34;</span> -o -n <span class="s2">&#34;</span><span class="nv">$PACKAGES_AUR</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;git&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/%wheel ALL=(ALL) ALL/%wheel ALL=(ALL) NOPASSWD: ALL/&#39;</span> /etc/sudoers&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$AUR</span><span class="s2">&#34;</span> in&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;aurman&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt bash -c <span class="s2">&#34;</span><span class="s2">echo -e \&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n\&#34; | su </span><span class="nv">$USER_NAME</span><span class="s2"> -c \&#34;cd /home/</span><span class="nv">$USER_NAME</span><span class="s2"> &amp;&amp; git clone https://aur.archlinux.org/</span><span class="nv">$AUR</span><span class="s2">.git &amp;&amp; gpg --recv-key 465022E743D71E39 &amp;&amp; (cd </span><span class="nv">$AUR</span><span class="s2"> &amp;&amp; makepkg -si --noconfirm) &amp;&amp; rm -rf </span><span class="nv">$AUR</span><span class="s2">\&#34;</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;yay&#34;</span> <span class="o">)</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt bash -c <span class="s2">&#34;</span><span class="s2">echo -e \&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n\&#34; | su </span><span class="nv">$USER_NAME</span><span class="s2"> -c \&#34;cd /home/</span><span class="nv">$USER_NAME</span><span class="s2"> &amp;&amp; git clone https://aur.archlinux.org/</span><span class="nv">$AUR</span><span class="s2">.git &amp;&amp; (cd </span><span class="nv">$AUR</span><span class="s2"> &amp;&amp; makepkg -si --noconfirm) &amp;&amp; rm -rf </span><span class="nv">$AUR</span><span class="s2">\&#34;</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;</span><span class="p">;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/%wheel ALL=(ALL) NOPASSWD: ALL/%wheel ALL=(ALL) ALL/&#39;</span> /etc/sudoers&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PACKAGES_AUR</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aur_install <span class="s2">&#34;</span><span class="nv">$PACKAGES_AUR</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> terminate<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LOG</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir -p /mnt/var/log&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp <span class="s2">&#34;</span><span class="nv">$LOG</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="s2">/mnt/var/log/</span><span class="nv">$LOG</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> end<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$REBOOT</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">Arch Linux installed successfully</span><span class="s2">&#34;</span><span class="s1">&#39;!&#39;</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REBOOT</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$ASCIINEMA</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;false&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> +e&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="o">(</span><span class="o">(</span> <span class="nv">i</span> <span class="o">=</span> 15<span class="p">;</span> i &gt;<span class="o">=</span> 1<span class="p">;</span> i-- <span class="o">)</span><span class="o">)</span><span class="p">;</span> <span class="k">do</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -r -s -n <span class="m">1</span> -t <span class="m">1</span> -p <span class="s2">&#34;</span><span class="s2">Rebooting in </span><span class="nv">$i</span><span class="s2"> seconds... Press any key to abort.</span><span class="s2">&#34;</span><span class="s1">$&#39;\n&#39;</span> KEY&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Restart aborted. You will must do a explicit reboot (./alis-reboot.sh).&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REBOOT</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">break</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> -e&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Restart aborted. You will must terminate asciinema recording and do a explicit reboot (exit, ./alis-reboot.sh).&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REBOOT</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$REBOOT</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s1">&#39;true&#39;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umount -R /mnt/boot&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umount -R /mnt&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reboot&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">Arch Linux installed successfully</span><span class="s2">&#34;</span><span class="s1">&#39;!&#39;</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$ASCIINEMA</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;false&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;You will must do a explicit reboot (./alis-reboot.sh).&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;You will must terminate asciinema recording and do a explicit reboot (exit, ./alis-reboot.sh).&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> pacman_install<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES</span><span class="o">=</span><span class="nv">$1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> VARIABLE in <span class="o">{</span>1..5<span class="o">}</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">do</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt pacman -Syu --noconfirm <span class="nv">$PACKAGES</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="o">=</span><span class="o">=</span> <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">break</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep <span class="m">10</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> aur_install<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES</span><span class="o">=</span><span class="nv">$1</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> VARIABLE in <span class="o">{</span>1..5<span class="o">}</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">do</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt bash -c <span class="s2">&#34;</span><span class="s2">echo -e \&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n</span><span class="nv">$USER_PASSWORD</span><span class="s2">\n\&#34; | su </span><span class="nv">$USER_NAME</span><span class="s2"> -c \&#34;</span><span class="nv">$AUR</span><span class="s2"> -Syu --noconfirm --needed </span><span class="nv">$PACKAGES</span><span class="s2">\&#34;</span><span class="s2">&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="o">=</span><span class="o">=</span> <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">break</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep <span class="m">10</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;<span class="o">}</span>&#10;&#10;<span class="k">function</span> main<span class="o">(</span><span class="o">)</span> <span class="o">{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;configuration_install&#10;&nbsp;&nbsp;&nbsp;&nbsp;sanitize_variables&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_variables&#10;&nbsp;&nbsp;&nbsp;&nbsp;warning&#10;&nbsp;&nbsp;&nbsp;&nbsp;init&#10;&nbsp;&nbsp;&nbsp;&nbsp;facts&#10;&nbsp;&nbsp;&nbsp;&nbsp;check_facts&#10;&nbsp;&nbsp;&nbsp;&nbsp;prepare&#10;&nbsp;&nbsp;&nbsp;&nbsp;partition&#10;&nbsp;&nbsp;&nbsp;&nbsp;install&#10;&nbsp;&nbsp;&nbsp;&nbsp;kernels&#10;&nbsp;&nbsp;&nbsp;&nbsp;configuration&#10;&nbsp;&nbsp;&nbsp;&nbsp;network&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> <span class="o">=</span><span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;virtualbox&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;users&#10;&nbsp;&nbsp;&nbsp;&nbsp;mkinitcpio&#10;&nbsp;&nbsp;&nbsp;&nbsp;bootloader&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DESKTOP_ENVIRONMENT</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;packages&#10;&nbsp;&nbsp;&nbsp;&nbsp;terminate&#10;&nbsp;&nbsp;&nbsp;&nbsp;end&#10;<span class="o">}</span>&#10;&#10;main</code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>alis.sh</span>
    </div>
</div>
<p>
    El <a href="https://github.com/picodotdev/alis/tree/master/">código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en <a href="https://github.com/">GitHub</a>. 
</p>

    </div>
  </article>
        

        
    
    
    <div class="row related">
        <div class="col-md-12">
            Artículos relacionados:
            <ul>
                <li><a href="/blog-bitix/2016/12/hemeroteca-10/index-amp.html">Hemeroteca #10</a></li>
                <li><a href="/blog-bitix/2016/10/elegir-una-distribucion-gnu-linux-segun-el-usuario-uso-o-equipo/index-amp.html">Elegir una distribución GNU/Linux según el usuario, uso o equipo</a></li>
                <li><a href="/blog-bitix/2016/07/guia-basica-del-interprete-de-comandos-bash/index-amp.html">Guía básica del intérprete de comandos Bash</a></li>
                <li><a href="/blog-bitix/2016/07/comandos-basicos-de-gnu-linux/index-amp.html">Comandos básicos de GNU/Linux</a></li>
                <li><a href="/blog-bitix/2016/07/hemeroteca-9/index-amp.html">Hemeroteca #9</a></li>
                
            </ul>
        </div>
    </div>
    

        
<div class="row">
  <div class="col-md-12">
    <div class="sharethis-inline-share-buttons"></div>
  </div>
</div>


        <div class="row">
          <div class="col-12 text-center">
            <a id="pageBottom"></a>
            <div class="adsense adsense-billboard">
    <amp-ad
        layout="fill"
        type="adsense"
        data-ad-client="ca-pub-3533636310991304"
        data-ad-slot="4052324337"
        data-auto-format="auto"
        data-full-width="">
        <div overflow=""></div>
    </amp-ad>
</div>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-12">
        <hr>
      </div>
    </div>
    





<footer>
  <div class="row">
    <div class="col-12 col-sm-4">
      <p><strong>Blog Bitix</strong></p>
      <p>Blog dedicado a la distribución GNU/Linux que uso habitualmente, Arch Linux, a mis andanzas alrededor del software libre, la programación y a otros temas relacionados con la tecnología y la informática.</p>
      <p>Publicando de uno a tres artículos únicos a la semana desde el año 2010.</p>
    </div>
    <div class="col-12 col-sm-4 text-center menu">
      <ul class="list-unstyled">
        <li><a href="/blog-bitix/tags/java/index-amp.html">Java</a></li>
        <li><a href="/blog-bitix/tags/gnu-linux/index-amp.html">GNU/Linux</a></li>
        <li><a href="/blog-bitix/tags/javascript/index-amp.html">JavaScript</a></li>
        <li><a href="/blog-bitix/tags/tapestry/index-amp.html">Tapestry</a></li>
        <li><a href="/blog-bitix/archive/index-amp.html">Archivo y hemeroteca</a></li>
        <li><a href="/blog-bitix/pages/links/index-amp.html">Enlaces</a></li>
        <li><a href="/blog-bitix/pages/advertising/index-amp.html">Publicidad</a></li>
        <li><a href="/blog-bitix/pages/donate/index-amp.html">Donaciones</a></li>
        <li><a href="/blog-bitix/pages/about/index-amp.html">Acerca de...</a></li>
        
      </ul>
    </div>
    <div class="col-12 col-sm-4 text-center links">
      
        <a href="https://picodotdev.github.io/blog-bitix/index.xml" title="¡Suscríbete a Blog Bitix!"><amp-img src="/blog-bitix/assets/images/rss.png" width="50" height="50" class="icon"></amp-img></a>
      
      
        <a href="https://twitter.com/picodotdev/" title="¡Sígueme en twitter!"><amp-img src="/blog-bitix/assets/images/twitter.svg" width="50" height="50" class="icon"></amp-img></a>
      
      
      
        <a href="https://github.com/picodotdev/blog-ejemplos/" title="¡Obtén el código fuente de los ejemplos!"><amp-img src="/blog-bitix/assets/images/github.svg" width="50" height="50" class="icon"></amp-img></a>
      
      
      
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      Copyleft <span class="copyleft">&copy;</span> 2020 - <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="nofollow"><amp-img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" width="80" height="15" alt="Creative Commons License" title="Creative Commons License"></amp-img></a><br />
      <a href="https://www.planetacodigo.com/" rel="nofollow"><amp-img src="/blog-bitix/assets/images/planeta-codigo.png" width="80" height="15" alt="Planeta código" title="Planeta código"></amp-img></a>
      <br/>
      <a href="https://picodotdev.github.io/blog-bitix/" rel="nofollow">Blog Bitix</a> by <a href="https://picodotdev.github.io/blog-bitix/">pico.dev</a> is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional License</a>.
      <br/>
      <span class="credit">Powered by <a href="https://gohugo.io/" rel="nofollow" title="A fast and modern static website engine">Hugo</a> and <a href="https://pages.github.com/" title="Websites for you and your projects">GitHub Pages</a>.</span>
      <span class="credit">Background patterns from <a href="https://www.toptal.com/designers/subtlepatterns/" rel="nofollow">Subtle Patterns</a>.</span>
    </div>
  </div>
</footer>

  </div>
  <amp-analytics type="gtag" data-credentials="include">
<script type="application/json">
{
    "vars" : {
        "gtag_id": "UA-12874075-4",
        "config" : {
            "UA-12874075-4": { "groups": "default" }
        }
    }
}
</script>
</amp-analytics>  
  
</body>
</html>