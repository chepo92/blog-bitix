<!doctype html><html lang=es><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="picodotdev"><meta name=keywords content="java,programacion,software,hardware,tapestry,software libre,gnu,linux,gnu/linux,unix,arch,arch linux,html,css,javascript"><meta name=description content="Google ofrece numerosos productos de desarrollo que permiten automatizar tareas e realizar integración con servicios, aplicaciones y documentos de Google creando un programa con un lenguaje de programacion. Las API que ofrece Google desde Drive, Sheets, Sides, GMail, Calendar, Contacts, Street View, AdSense, Analytics, Youtube, Speech y muchos más.
 Google API Client Libraries Google API Client Libraries, Java  Para acceder a los servicios mediante APIs hay que obtener unas credenciales. &mldr;"><base href=https://picodotdev.github.io/blog-bitix/><title>Acceder a hojas de cálculo de Google Docs mediante API desde una aplicación Java</title><link rel=author type=text/plain href=humans.txt><link rel="shortcut icon" href=assets/favicon.ico><link rel=apple-touch-icon-precomposed sizes=144x144 href=assets/apple-touch-icon-144-precomposed.png><link rel=canonical href=https://picodotdev.github.io/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/><link href=index.xml rel=alternate type=application/rss+xml title="Blog Bitix"><link rel=stylesheet type=text/css href=assets/css/font.css><link rel=stylesheet type=text/css href=assets/libs/bootstrap-4.3.1/css/bootstrap.min.css><link rel=stylesheet type=text/css href=assets/libs/Gallery-2.33.0/css/blueimp-gallery.min.css><link rel=stylesheet type=text/css href=assets/css/syntax.css><link rel=stylesheet type=text/css href=assets/css/main.css><script type=text/javascript src=assets/js/require-config.js data-main=js/main defer></script><script type=text/javascript src=assets/libs/require.js data-main=js/main defer></script><script src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js defer></script><script type=text/javascript defer>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:'ca-pub-3533636310991304',enable_page_level_ads:true});</script><script type=text/javascript defer>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-12874075-4','picodotdev.github.io');ga('send','pageview');</script><script type=text/javascript src="//platform-api.sharethis.com/js/sharethis.js#property=5920c4ce1bd0670011e06acd&product=inline-share-buttons" defer></script><script type=text/javascript src=assets/js/app.js defer></script></head><body><div class=container><div class=row><div class=col-12><header><div class=row><div class="col-12 col-lg-4"></div><div class="col-12 col-lg-4"><h2 class=title><a href=https://picodotdev.github.io/blog-bitix/>Blog Bitix</a></h2><div class=links><a href=index.xml title="¡Suscríbete a Blog Bitix!"><img src=assets/images/rss.png class=icon></a>
<a href=https://twitter.com/picodotdev/ title="¡Sígueme en twitter!"><img src=assets/images/twitter.svg class=icon></a>
<a href=https://github.com/picodotdev/blog-ejemplos/ title="¡Obtén el código fuente de los ejemplos!"><img src=assets/images/github.svg class=icon></a></div></div><div class="col-12 col-lg-4 text-center"><form name=query class="form-inline search" onsubmit="return false;"><div class=input-group><input type=text name=q class=form-control placeholder="Buscar en Blog Bitix">
<span class=input-group-btn><button class="btn btn-secondary" type=submit>Buscar</button></span></div></form><form name=search action=https://duckduckgo.com/ method=get class=hidden data-site=https://picodotdev.github.io/blog-bitix/><input type=hidden name=q></form></div></div><div class=row><div class=col-12><nav class="nav nav-pills nav-fill"><a href=/blog-bitix/tags/java/ class="nav-item nav-link">Java</a>
<a href=/blog-bitix/tags/gnu-linux/ class="nav-item nav-link">GNU/Linux</a>
<a href=/blog-bitix/tags/javascript/ class="nav-item nav-link">JavaScript</a>
<a href=/blog-bitix/tags/tapestry/ class="nav-item nav-link">Tapestry</a>
<a href=/blog-bitix/archive/ class="nav-item nav-link">Archivo y hemeroteca</a>
<a href=/blog-bitix/pages/links/ class="nav-item nav-link">Enlaces</a>
<a href=/blog-bitix/pages/about/ class="nav-item nav-link">Acerca de...</a></nav></div></div></header></div></div><div class=row><div class="col-12 text-center"><ins class=adsbygoogle style=display:inline-block;width:970px;height:250px data-ad-client=ca-pub-3533636310991304 data-ad-slot=2975854584 data-type=billboard></ins></div></div><div class=row><div class=col-12><div class="adblock-sidebar adblock-sidebar-right"><div class=adblock-sidebar-container><ins class="adsbygoogle adblock-sidebar-vertical" style=display:block data-ad-client=ca-pub-3533636310991304 data-ad-slot=9933840986 data-ad-format="vertical, rectangle" data-type=auto></ins></div></div><article itemprop=mainEntity itemscope itemtype=http://schema.org/BlogPosting><meta itemprop=inLanguage content="es"><meta itemprop=keywords content="java, planeta-codigo, programacion"><h1 itemprop=name>Acceder a hojas de cálculo de Google Docs mediante API desde una aplicación Java</h1><p class=information>Escrito por
<span itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>picodotdev</span></span> el <time itemprop=datePublished datetime=2019-01-12>12/01/2019</time>.<br><a href=tags/java/>java</a> <a href=tags/planeta-codigo/>planeta-codigo</a> <a href=tags/programacion/>programacion</a><br><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/ itemprop=url>Enlace permanente</a>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/#comments>Comentarios</a></p><div class=content itemprop=articleBody><meta itemprop=wordCount content="1324"><div class=logotypes><img src=/blog-bitix/assets/images/logotipos/java.svg class=right width=200 alt=Java title=Java></div><div class=logotypes><img src=/blog-bitix/assets/images/logotipos/google.svg class=right width=350 alt=Google title=Google></div><p><a href=https://developers.google.com/products/develop/>Google ofrece numerosos productos de desarrollo</a> que permiten automatizar tareas e realizar integración con servicios, aplicaciones y documentos de Google creando un programa con un lenguaje de programacion. <a href=https://developers.google.com/api-client-library/java/apis/>Las API que ofrece Google</a> desde <a href=https://www.google.es/drive/apps.html>Drive</a>, <a href=https://www.google.com/intl/es/sheets/about/>Sheets</a>, <a href=https://www.google.com/intl/es/slides/about/>Sides</a>, <a href=https://www.google.com/intl/es/gmail/about/>GMail</a>, <a href=https://www.google.com/calendar/about/>Calendar</a>, <a href=https://contacts.google.com/>Contacts</a>, <a href=https://www.google.es/intl/es/streetview/>Street View</a>, <a href=https://www.google.com/adsense/>AdSense</a>, <a href=https://www.google.es/intl/es/analytics/>Analytics</a>, <a href=https://www.youtube.com/>Youtube</a>, <a href=https://cloud.google.com/speech-to-text/>Speech</a> y muchos más.</p><ul><li><a href=https://developers.google.com/api-client-library/>Google API Client Libraries</a></li><li><a href=https://developers.google.com/api-client-library/java/>Google API Client Libraries, Java</a></li></ul><p>Para acceder a los servicios mediante APIs hay que obtener unas credenciales. Un ejemplo es el siguiente usando un API <em>key</em> para acceder a una hoja de cálculo compartida para cualquier usuario que tenga el enlace o identificativo del documento en Google Drive. Cada servicio de Google ofrece una API distinta según su contexto y datos que maneja.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span><span class=lnt>17&#10;</span><span class=lnt>18&#10;</span><span class=lnt>19&#10;</span><span class=lnt>20&#10;</span><span class=lnt>21&#10;</span><span class=lnt>22&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=kn>package</span> <span class=nn>io.github.picodotdev.javagoogleapi</span><span class=o>;</span>&#10;&#10;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&#10;<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Main</span> <span class=o>{</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=n>Credential</span> <span class=nf>getCredentialsApiKey</span><span class=o>(</span><span class=o>)</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>return</span> <span class=k>new</span> <span class=n>GoogleCredential</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>createScoped</span><span class=o>(</span><span class=n>SCOPES</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=o>.</span><span class=o>.</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>GeneralSecurityException</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>NetHttpTransport</span> <span class=n>httpTransport</span> <span class=o>=</span> <span class=n>GoogleNetHttpTransport</span><span class=o>.</span><span class=na>newTrustedTransport</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>JsonFactory</span> <span class=n>jsonFactory</span> <span class=o>=</span> <span class=n>JacksonFactory</span><span class=o>.</span><span class=na>getDefaultInstance</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>Sheets</span> <span class=n>service</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Sheets</span><span class=o>.</span><span class=na>Builder</span><span class=o>(</span><span class=n>httpTransport</span><span class=o>,</span> <span class=n>jsonFactory</span><span class=o>,</span> <span class=n>getCredentialsApiKey</span><span class=o>(</span><span class=o>)</span><span class=o>)</span><span class=o>.</span><span class=na>setApplicationName</span><span class=o>(</span><span class=n>APPLICATION_NAME</span><span class=o>)</span><span class=o>.</span><span class=na>build</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;<span class=o>}</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/Main-1.java target=_blank>view raw</a></span>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/Main-1.java target=_blank>Main-1.java</a></div></div><p>Las hojas de cálculo se utilizan para contener información, son fácilmente editables por los usuarios y se convierten casi en una forma de base de datos. Con <a href=https://developers.google.com/sheets/api/>las APIs que ofrece Google para Spreadsheets</a> esta información es utilizable en una aplicación, un buen caso de uso es aquel en el que ciertos datos o parámetros potencialmente cambian cada cierto tiempo o según reglas de negocio. Por ejemplo, se puede crear una hoja de cálculo con los precios, descripciones, existencias, disponibilidad o gastos de envío de los productos e importar esta información en la base de datos de una aplicación usando una API de Google, en vez de crear una aplicación <em>backoffice</em> de edición a medida para editar esa información, la aplicación consistiría en procesar el documento e insertar su información en la base de datos.</p><p>Como contrapartida de estas integraciones hay que tener en cuenta que una aplicación se hace dependiente del servicio los servicios de Google que utilice, hay que evaluar si esta dependencia es deseable.</p><div class="media media-video"><iframe width=640 height=360 data-src="https://www.youtube.com/embed/0rpgVE_nrIk?rel=0" frameborder=0 class=lozad allowfullscreen></iframe></div><p>Otro posible aplicación es utilizar documentos de texto en Google Drive como plantillas de correos electrónicos, se permite una edición sencilla y posteriormente se importan en la aplicación para que los utilice. A un documento de Google Drive se accede mediante esta petición HTTP GET. Las hojas de cálculo tamibén están disponibles mediante una interfaz REST sin embargo usando las APIs que ofrece Google para cada lenguaje es más cómodo que tratar con los datos en crudo en formato JSON.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ curl -X GET <span class=s2>&#34;https://sheets.googleapis.com/v4/spreadsheets/1JhBPGW4F.../values/Hoja1?key=AIzaSyDGwW...&#34;</span>&#10;<span class=o>{</span>&#10;  <span class=s2>&#34;range&#34;</span>: <span class=s2>&#34;Hoja1!A1:AA1000&#34;</span>,&#10;  <span class=s2>&#34;majorDimension&#34;</span>: <span class=s2>&#34;ROWS&#34;</span>,&#10;  <span class=s2>&#34;values&#34;</span>: <span class=o>[</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>[</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;  <span class=s2>&#34;a1&#34;</span>,&#10;&nbsp;&nbsp;&nbsp;&nbsp;  <span class=s2>&#34;a3&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>]</span>,&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>[</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;  <span class=s2>&#34;a2&#34;</span>,&#10;&nbsp;&nbsp;&nbsp;&nbsp;  <span class=s2>&#34;a4&#34;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>]</span>&#10;  <span class=o>]</span>&#10;<span class=o>}</span>&#10;&#10;</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/curl-1.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/curl-1.sh target=_blank>curl-1.sh</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1&#10;</span><span class=lnt>2&#10;</span><span class=lnt>3&#10;</span><span class=lnt>4&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ curl -X GET <span class=s2>&#34;https://www.googleapis.com/drive/v3/files/1YCnD37w6p.../export?key=AIzaSyDGwW...&amp;mimeType=text/plain&#34;</span>&#10;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed <span class=k>do</span> eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation &#10;ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint&#10;occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/curl-2.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/curl-2.sh target=_blank>curl-2.sh</a></div></div><p>Para las hojas de cálculo hay dos formas de autorización para una aplicación. Mediante una API <em>key</em> con permisos de utilización de la API permite acceder a cualquier documento público, compartido de forma pública o para los usuarios que tengan el enlace o identificativo del documento. La otra más segura es creando una cuenta de servicio de forma que el documento se comparta únicamente con esa cuenta de servicio como si de cualquier otro usuario se tratase en vez de hacerlo público o para cualquiera que tenga el enlace.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span><span class=lnt>17&#10;</span><span class=lnt>18&#10;</span><span class=lnt>19&#10;</span><span class=lnt>20&#10;</span><span class=lnt>21&#10;</span><span class=lnt>22&#10;</span><span class=lnt>23&#10;</span><span class=lnt>24&#10;</span><span class=lnt>25&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=kn>package</span> <span class=nn>io.github.picodotdev.javagoogleapi</span><span class=o>;</span>&#10;&#10;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&#10;<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Main</span> <span class=o>{</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>CREDENTIALS_FILE_PATH</span> <span class=o>=</span> <span class=s>&#34;/blogbitix-119471bc8ebf.json&#34;</span><span class=o>;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=n>Credential</span> <span class=nf>getCredentialsServiceAccount</span><span class=o>(</span><span class=n>NetHttpTransport</span> <span class=n>httpTransport</span><span class=o>,</span> <span class=n>JsonFactory</span> <span class=n>jsonFactory</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>InputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=n>Main</span><span class=o>.</span><span class=na>class</span><span class=o>.</span><span class=na>getResourceAsStream</span><span class=o>(</span><span class=n>CREDENTIALS_FILE_PATH</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>return</span> <span class=n>GoogleCredential</span><span class=o>.</span><span class=na>fromStream</span><span class=o>(</span><span class=n>in</span><span class=o>,</span> <span class=n>httpTransport</span><span class=o>,</span> <span class=n>jsonFactory</span><span class=o>)</span><span class=o>.</span><span class=na>createScoped</span><span class=o>(</span><span class=n>SCOPES</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=o>.</span><span class=o>.</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>GeneralSecurityException</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>NetHttpTransport</span> <span class=n>httpTransport</span> <span class=o>=</span> <span class=n>GoogleNetHttpTransport</span><span class=o>.</span><span class=na>newTrustedTransport</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>JsonFactory</span> <span class=n>jsonFactory</span> <span class=o>=</span> <span class=n>JacksonFactory</span><span class=o>.</span><span class=na>getDefaultInstance</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>Sheets</span> <span class=n>service</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Sheets</span><span class=o>.</span><span class=na>Builder</span><span class=o>(</span><span class=n>httpTransport</span><span class=o>,</span> <span class=n>jsonFactory</span><span class=o>,</span> <span class=n>getCredentialsServiceAccount</span><span class=o>(</span><span class=n>httpTransport</span><span class=o>,</span> <span class=n>jsonFactory</span><span class=o>)</span><span class=o>)</span><span class=o>.</span><span class=na>setApplicationName</span><span class=o>(</span><span class=n>APPLICATION_NAME</span><span class=o>)</span><span class=o>.</span><span class=na>build</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;<span class=o>}</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/Main-2.java target=_blank>view raw</a></span>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/Main-2.java target=_blank>Main-2.java</a></div></div><p>Laa API <em>key</em> se crean en la página de <a href=https://console.developers.google.com/apis/credentials>Credenciales</a> para lo que previamente hay que crer un proyecto. Para leer el documento hay que compartirlo al menos para cualquiera que tenga acceso al enlace, al compartirlo se especifica si se hace en modo solo lectura o con permisos de ecritura.</p><div class=media><figure><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-credentials_hu116c94ed86a1fadfd830c4a2c6fc8ede_54231_2560x1440_fit_box_2.png title="Google Credentials" data-gallery=data-gallery><img data-src=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-credentials_hu116c94ed86a1fadfd830c4a2c6fc8ede_54231_300x200_fit_box_2.png width=300 height=129 class=lozad></a>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-api-key_hu1c94b54ead1ec0fe0a478bd78fbd4bde_63148_2560x1440_fit_box_2.png title="Google API Key" data-gallery=data-gallery><img data-src=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-api-key_hu1c94b54ead1ec0fe0a478bd78fbd4bde_63148_300x200_fit_box_2.png width=269 height=200 class=lozad></a>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-document-share_hu3a75edaafaa8302f727a6b88b49d99c8_55990_2560x1440_fit_box_2.png title="Compartir documento en Google Drive" data-gallery=data-gallery><img data-src=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-document-share_hu3a75edaafaa8302f727a6b88b49d99c8_55990_300x200_fit_box_2.png width=300 height=168 class=lozad></a><figcaption>Google Credentials, API Key y compartir documento</figcaption></figure></div><p>El enlace al compartir el documento o al editarlo contiene el identificativo de documento. Con la API <em>key</em> o cuenta de servicio, el identificativo del documento y el documento compartido al menos para cualquiera que tenga el enlace la información del documento está accesible para una aplicación mediante una API REST o de forma programática con una implementación de la API con Java, este programa Java imprime el contenido de las celdas de la hoja de cálculo en la terminal. Se necesita una expresión que identifique la hoja y el contenido de las celdas de las que se quieren datos con un <a href=https://developers.google.com/sheets/api/guides/concepts#a1_notation>rango en notación A1</a>.</p><div class=media><figure><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-spreadsheet_hu2ac3b424b62ef874983c386522926d77_25924_2560x1440_fit_box_2.png title="Hoja de cálculo de Google" data-gallery=data-gallery><img data-src=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-spreadsheet_hu2ac3b424b62ef874983c386522926d77_25924_300x200_fit_box_2.png width=300 height=164 class=lozad></a>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-document_hu02b1ae11f15da7edaf19c311b5f5b343_45403_2560x1440_fit_box_2.png title="Documento de Google" data-gallery=data-gallery><img data-src=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-document_hu02b1ae11f15da7edaf19c311b5f5b343_45403_300x200_fit_box_2.png width=300 height=135 class=lozad></a><figcaption>Hoja de cálculo y documento de Google</figcaption></figure></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span><span class=lnt>17&#10;</span><span class=lnt>18&#10;</span><span class=lnt>19&#10;</span><span class=lnt>20&#10;</span><span class=lnt>21&#10;</span><span class=lnt>22&#10;</span><span class=lnt>23&#10;</span><span class=lnt>24&#10;</span><span class=lnt>25&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=kn>package</span> <span class=nn>io.github.picodotdev.javagoogleapi</span><span class=o>;</span>&#10;&#10;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&#10;<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Main</span> <span class=o>{</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=o>.</span><span class=o>.</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>GeneralSecurityException</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>Sheets</span> <span class=n>service</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Sheets</span><span class=o>.</span><span class=na>Builder</span><span class=o>(</span><span class=n>httpTransport</span><span class=o>,</span> <span class=n>jsonFactory</span><span class=o>,</span> <span class=n>getCredentialsApiKey</span><span class=o>(</span><span class=o>)</span><span class=o>)</span><span class=o>.</span><span class=na>setApplicationName</span><span class=o>(</span><span class=n>APPLICATION_NAME</span><span class=o>)</span><span class=o>.</span><span class=na>build</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>ValueRange</span> <span class=n>response</span> <span class=o>=</span> <span class=n>service</span><span class=o>.</span><span class=na>spreadsheets</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>values</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>SPREADSHEET_ID</span><span class=o>,</span> <span class=n>RANGE</span><span class=o>)</span><span class=o>.</span><span class=na>setKey</span><span class=o>(</span><span class=n>API_KEY</span><span class=o>)</span><span class=o>.</span><span class=na>execute</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>List</span><span class=o>&lt;</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Object</span><span class=o>&gt;</span><span class=o>&gt;</span> <span class=n>values</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=na>getValues</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>if</span> <span class=o>(</span><span class=n>values</span> <span class=o>=</span><span class=o>=</span> <span class=kc>null</span> <span class=o>|</span><span class=o>|</span> <span class=n>values</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>(</span><span class=o>)</span><span class=o>)</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;No data found.&#34;</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>return</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>for</span> <span class=o>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Object</span><span class=o>&gt;</span> <span class=n>row</span> <span class=o>:</span> <span class=n>values</span><span class=o>)</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>row</span><span class=o>.</span><span class=na>stream</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>map</span><span class=o>(</span><span class=n>Object</span><span class=o>:</span><span class=o>:</span><span class=n>toString</span><span class=o>)</span><span class=o>.</span><span class=na>collect</span><span class=o>(</span><span class=n>java</span><span class=o>.</span><span class=na>util</span><span class=o>.</span><span class=na>stream</span><span class=o>.</span><span class=na>Collectors</span><span class=o>.</span><span class=na>joining</span><span class=o>(</span><span class=s>&#34;, &#34;</span><span class=o>)</span><span class=o>)</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;<span class=o>}</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/Main-3.java target=_blank>view raw</a></span>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/Main-3.java target=_blank>Main-3.java</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=hl><span class=lnt> 7&#10;</span></span><span class=hl><span class=lnt> 8&#10;</span></span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-Bash data-lang=Bash>$ ./gradlew run&#10;&gt; Task :compileJava&#10;&gt; Task :processResources UP-TO-DATE&#10;&gt; Task :classes&#10;&#10;&gt; Task :run&#10;<span class=hl>a1, a3&#10;</span><span class=hl>a2, a4&#10;</span>&#10;BUILD SUCCESSFUL in 1s&#10;<span class=m>3</span> actionable tasks: <span class=m>2</span> executed, <span class=m>1</span> up-to-date</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/gradlew-run.sh target=_blank>view raw</a></span>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/gradlew-run.sh target=_blank>gradlew-run.sh</a></div></div><p>El método de API <em>key</em> obliga a hacer público el documento lo que no es deseable desde el punto de vista de seguridad aunque es un poco más simple que crear una cuenta de servicio. Para no hacer público el documento pero permitir acceder a una aplicación hay que crear una cuenta de servicio en la página <a href=https://console.developers.google.com/iam-admin/serviceaccounts>Cuentas de servicio</a> seleccionando o creando un proyecto.</p><div class=media><figure><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-service-account_hu2d83f14d9df8a03d71287aee955052d9_71479_2560x1440_fit_box_2.png title="Cuenta de servicio de Google" data-gallery=data-gallery><img data-src=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-service-account_hu2d83f14d9df8a03d71287aee955052d9_71479_300x200_fit_box_2.png width=300 height=133 class=lozad></a><figcaption>Cuenta de servicio de Google</figcaption></figure></div><p>Al crear una cuenta de servicio y una clave se genera un archivo en formato JSON con las credenciales que hay que guardar y utilizar en una aplicación para acceder a los documentos compartidos con esta cuenta de servicio.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-plaintext data-lang=plaintext>{&#10;  &#34;type&#34;: &#34;service_account&#34;,&#10;  &#34;project_id&#34;: &#34;blogbitix&#34;,&#10;  &#34;private_key_id&#34;: &#34;119471bc8...&#34;,&#10;  &#34;private_key&#34;: &#34;-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDFQpNVknb3bRp9\n...\n-----END PRIVATE KEY-----\n&#34;,&#10;  &#34;client_email&#34;: &#34;blogbitix@blogbitix.iam.gserviceaccount.com&#34;,&#10;  &#34;client_id&#34;: &#34;110222042...&#34;,&#10;  &#34;auth_uri&#34;: &#34;https://accounts.google.com/o/oauth2/auth&#34;,&#10;  &#34;token_uri&#34;: &#34;https://oauth2.googleapis.com/token&#34;,&#10;  &#34;auth_provider_x509_cert_url&#34;: &#34;https://www.googleapis.com/oauth2/v1/certs&#34;,&#10;  &#34;client_x509_cert_url&#34;: &#34;https://www.googleapis.com/robot/v1/metadata/x509/blogbitix%40blogbitix.iam.gserviceaccount.com&#34;&#10;}&#10;</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/blogbitix-119471bc8ebf.json target=_blank>view raw</a></span>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/blogbitix-119471bc8ebf.json target=_blank>blogbitix-119471bc8ebf.json</a></div></div><p>En vez de compartir el documento con cualquiera que tenga en enlace, con una cuenta de servicio el documento se puede compartir únicamente con esa cuenta de servicio, la cuenta de servicio posee un correo electrónico que la identifica, el documento se puede compartir únicamente con esta cuenta de servicio como si de cualquier otro usuario se tratase.</p><div class=media><figure><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-document-share-service-account_hubd4913666ed69164853f4d9189f90b0d_78026_2560x1440_fit_box_2.png title="Documento compartido con cuenta de servicio" data-gallery=data-gallery><img data-src=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/images/google-document-share-service-account_hubd4913666ed69164853f4d9189f90b0d_78026_300x200_fit_box_2.png width=269 height=200 class=lozad></a><figcaption>Documento compartido con cuenta de servicio</figcaption></figure></div><p>El siguiente código Java accede a un documento utilizando las credenciales de una cuenta de servicio.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span><span class=lnt>14&#10;</span><span class=lnt>15&#10;</span><span class=lnt>16&#10;</span><span class=lnt>17&#10;</span><span class=lnt>18&#10;</span><span class=lnt>19&#10;</span><span class=lnt>20&#10;</span><span class=lnt>21&#10;</span><span class=lnt>22&#10;</span><span class=lnt>23&#10;</span><span class=lnt>24&#10;</span><span class=lnt>25&#10;</span><span class=lnt>26&#10;</span><span class=lnt>27&#10;</span><span class=lnt>28&#10;</span><span class=lnt>29&#10;</span><span class=lnt>30&#10;</span><span class=lnt>31&#10;</span><span class=lnt>32&#10;</span><span class=lnt>33&#10;</span><span class=lnt>34&#10;</span><span class=lnt>35&#10;</span><span class=lnt>36&#10;</span><span class=lnt>37&#10;</span><span class=lnt>38&#10;</span><span class=lnt>39&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=kn>package</span> <span class=nn>io.github.picodotdev.javagoogleapi</span><span class=o>;</span>&#10;&#10;<span class=o>.</span><span class=o>.</span><span class=o>.</span><span class=o>.</span>&#10;&#10;<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Main</span> <span class=o>{</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>APPLICATION_NAME</span> <span class=o>=</span> <span class=s>&#34;JavaGoogleApi&#34;</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>API_KEY</span> <span class=o>=</span> <span class=s>&#34;AIzaSyDBZ...&#34;</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>CREDENTIALS_FILE_PATH</span> <span class=o>=</span> <span class=s>&#34;/blogbitix-119471bc8ebf.json&#34;</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>SPREADSHEET_ID</span> <span class=o>=</span> <span class=s>&#34;1JhBPGW4F...&#34;</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>RANGE</span> <span class=o>=</span> <span class=s>&#34;Hoja1&#34;</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>SCOPES</span> <span class=o>=</span> <span class=n>Collections</span><span class=o>.</span><span class=na>singletonList</span><span class=o>(</span><span class=n>SheetsScopes</span><span class=o>.</span><span class=na>SPREADSHEETS_READONLY</span><span class=o>)</span><span class=o>;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=n>Credential</span> <span class=nf>getCredentialsApiKey</span><span class=o>(</span><span class=o>)</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>return</span> <span class=k>new</span> <span class=n>GoogleCredential</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>createScoped</span><span class=o>(</span><span class=n>SCOPES</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>private</span> <span class=kd>static</span> <span class=n>Credential</span> <span class=nf>getCredentialsServiceAccount</span><span class=o>(</span><span class=n>NetHttpTransport</span> <span class=n>httpTransport</span><span class=o>,</span> <span class=n>JsonFactory</span> <span class=n>jsonFactory</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>InputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=n>Main</span><span class=o>.</span><span class=na>class</span><span class=o>.</span><span class=na>getResourceAsStream</span><span class=o>(</span><span class=n>CREDENTIALS_FILE_PATH</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>return</span> <span class=n>GoogleCredential</span><span class=o>.</span><span class=na>fromStream</span><span class=o>(</span><span class=n>in</span><span class=o>,</span> <span class=n>httpTransport</span><span class=o>,</span> <span class=n>jsonFactory</span><span class=o>)</span><span class=o>.</span><span class=na>createScoped</span><span class=o>(</span><span class=n>SCOPES</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=o>.</span><span class=o>.</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>GeneralSecurityException</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>NetHttpTransport</span> <span class=n>httpTransport</span> <span class=o>=</span> <span class=n>GoogleNetHttpTransport</span><span class=o>.</span><span class=na>newTrustedTransport</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>JsonFactory</span> <span class=n>jsonFactory</span> <span class=o>=</span> <span class=n>JacksonFactory</span><span class=o>.</span><span class=na>getDefaultInstance</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>Sheets</span> <span class=n>service</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Sheets</span><span class=o>.</span><span class=na>Builder</span><span class=o>(</span><span class=n>httpTransport</span><span class=o>,</span> <span class=n>jsonFactory</span><span class=o>,</span> <span class=n>getCredentialsServiceAccount</span><span class=o>(</span><span class=n>httpTransport</span><span class=o>,</span> <span class=n>jsonFactory</span><span class=o>)</span><span class=o>)</span><span class=o>.</span><span class=na>setApplicationName</span><span class=o>(</span><span class=n>APPLICATION_NAME</span><span class=o>)</span><span class=o>.</span><span class=na>build</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>ValueRange</span> <span class=n>response</span> <span class=o>=</span> <span class=n>service</span><span class=o>.</span><span class=na>spreadsheets</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>values</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>SPREADSHEET_ID</span><span class=o>,</span> <span class=n>RANGE</span><span class=o>)</span><span class=o>.</span><span class=na>setKey</span><span class=o>(</span><span class=n>API_KEY</span><span class=o>)</span><span class=o>.</span><span class=na>execute</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>List</span><span class=o>&lt;</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Object</span><span class=o>&gt;</span><span class=o>&gt;</span> <span class=n>values</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=na>getValues</span><span class=o>(</span><span class=o>)</span><span class=o>;</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>if</span> <span class=o>(</span><span class=n>values</span> <span class=o>=</span><span class=o>=</span> <span class=kc>null</span> <span class=o>|</span><span class=o>|</span> <span class=n>values</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>(</span><span class=o>)</span><span class=o>)</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;No data found.&#34;</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>return</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=k>for</span> <span class=o>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Object</span><span class=o>&gt;</span> <span class=n>row</span> <span class=o>:</span> <span class=n>values</span><span class=o>)</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>row</span><span class=o>.</span><span class=na>stream</span><span class=o>(</span><span class=o>)</span><span class=o>.</span><span class=na>map</span><span class=o>(</span><span class=n>Object</span><span class=o>:</span><span class=o>:</span><span class=n>toString</span><span class=o>)</span><span class=o>.</span><span class=na>collect</span><span class=o>(</span><span class=n>java</span><span class=o>.</span><span class=na>util</span><span class=o>.</span><span class=na>stream</span><span class=o>.</span><span class=na>Collectors</span><span class=o>.</span><span class=na>joining</span><span class=o>(</span><span class=s>&#34;, &#34;</span><span class=o>)</span><span class=o>)</span><span class=o>)</span><span class=o>;</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=o>}</span>&#10;<span class=o>}</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/Main-4.java target=_blank>view raw</a></span>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/Main-4.java target=_blank>Main-4.java</a></div></div><p>En el caso de Java hay que incluir la dependencia que proporciona la implementación de la API de Google Spreadsheets para Java como se muestra usando <a href=https://gradle.org/>Gradle</a>.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1&#10;</span><span class=lnt> 2&#10;</span><span class=lnt> 3&#10;</span><span class=lnt> 4&#10;</span><span class=lnt> 5&#10;</span><span class=lnt> 6&#10;</span><span class=lnt> 7&#10;</span><span class=lnt> 8&#10;</span><span class=lnt> 9&#10;</span><span class=lnt>10&#10;</span><span class=lnt>11&#10;</span><span class=lnt>12&#10;</span><span class=lnt>13&#10;</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-groovy data-lang=groovy><span class=n>apply</span> <span class=nl>plugin:</span> <span class=s1>&#39;java&#39;</span>&#10;<span class=n>apply</span> <span class=nl>plugin:</span> <span class=s1>&#39;application&#39;</span>&#10;&#10;<span class=n>mainClassName</span> <span class=o>=</span> <span class=s1>&#39;io.github.picodotdev.javagoogleapi.Main&#39;</span>&#10;<span class=n>version</span> <span class=o>=</span> <span class=s1>&#39;1.0&#39;</span>&#10;&#10;<span class=n>repositories</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>mavenCentral</span><span class=o>(</span><span class=o>)</span>&#10;<span class=o>}</span>&#10;&#10;<span class=n>dependencies</span> <span class=o>{</span>&#10;&nbsp;&nbsp;&nbsp;&nbsp;<span class=n>compile</span> <span class=s1>&#39;com.google.apis:google-api-services-sheets:v4-rev553-1.25.0&#39;</span>&#10;<span class=o>}</span>&#10;</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/build.gradle target=_blank>view raw</a></span>
<a href=/blog-bitix/2019/01/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java/code/build.gradle target=_blank>build.gradle</a></div></div><p>Google ofrece un <a href=https://developers.google.com/apis-explorer/#p/sheets/v4/>explorador para probar las peticiones y permisos de los documentos</a> o <a href=https://developers.google.com/apis-explorer/#p/>explorar cualquier otra API de Google</a> por ejemplo esta de Drive para <a href=https://developers.google.com/apis-explorer/#p/drive/v3/drive.files.export>exportar un documento en un formato determinado</a> directamente desde una web sin tener que crear una aplicación, también se pueden <a href=https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/get>hacer peticiones desde las páginas de documentación</a>.</p><p>El <a href=https://github.com/picodotdev/blog-ejemplos/tree/master/JavaGoogleApi>código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en <a href=https://github.com/>GitHub</a>.</p><div class=reference>Referencia:<br><ul><li><a href=https://googleapis.github.io/google-api-java-client/releases/1.25.0/javadoc/index.html>Google API Client Library for Java, Javadoc</a></li><li><a href=https://developers.google.com/resources/api-libraries/documentation/sheets/v4/java/latest/>Google Sheets API v4, Javadoc</a></li><li><a href=https://github.com/googleapis/>Código fuente Google APIs</a></li></ul></div></div></article><div class="row related"><div class=col-md-12>Artículos relacionados:<ul><li><a href=/blog-bitix/2019/01/las-contrasenas-e-informacion-sensible-en-el-codigo-fuente-o-bytecode-de-java-no-son-seguras/>Las contraseñas e información sensible en el código fuente o bytecode de Java no son seguras</a></li><li><a href=/blog-bitix/2018/12/hemeroteca-14/>Hemeroteca #14</a></li><li><a href=/blog-bitix/2018/12/exponer-las-metricas-de-hystrix-en-grafana-con-prometheus-de-una-aplicacion-spring-boot/>Exponer las métricas de Hystrix en Grafana con Prometheus de una aplicación Spring Boot</a></li><li><a href=/blog-bitix/2018/12/monitorizar-una-aplicacion-java-de-spring-boot-con-micrometer-prometheus-y-grafana/>Monitorizar una aplicación Java de Spring Boot con Micrometer, Prometheus y Grafana</a></li><li><a href=/blog-bitix/2018/11/novedades-de-java-ee-8/>Novedades de Java EE 8</a></li></ul></div></div><div class=row><div class=col-md-12><div class=sharethis-inline-share-buttons></div></div></div><div class=row><div class="col-12 text-center"><ins class=adsbygoogle style=display:inline-block;width:970px;height:250px data-ad-client=ca-pub-3533636310991304 data-ad-slot=2975854584 data-type=billboard></ins></div></div><a id=comments></a><div class=row><div class=col-md-12><div id=disqus_thread></div></div></div><script type=text/javascript async>var disqus_shortname='blog-bitix';var disqus_identifier='blog-bitix-372';var disqus_url='https:\/\/picodotdev.github.io\/blog-bitix\/2019\/01\/acceder-a-hojas-de-calculo-de-google-docs-mediante-api-desde-una-aplicacion-java\/';var disqus_script='embed.js';</script></div></div><div class=row><div class=col-12><hr></div></div><footer><div class=row><div class="col-12 col-sm-4"><p><strong>Blog Bitix</strong></p><p>Blog dedicado a la distribución GNU/Linux que uso habitualmente, Arch Linux, a mis andanzas alrededor del software libre, la programación y a otros temas relacionados con la tecnología y la informática.</p><p>Publicando de uno a tres artículos únicos a la semana desde el año 2010.</p></div><div class="col-12 col-sm-4 text-center menu"><ul class=list-unstyled><li><a href=/blog-bitix/tags/java/>Java</a></li><li><a href=/blog-bitix/tags/gnu-linux/>GNU/Linux</a></li><li><a href=/blog-bitix/tags/javascript/>JavaScript</a></li><li><a href=/blog-bitix/tags/tapestry/>Tapestry</a></li><li><a href=/blog-bitix/archive/>Archivo y hemeroteca</a></li><li><a href=/blog-bitix/pages/links/>Enlaces</a></li><li><a href=/blog-bitix/pages/advertising/>Publicidad</a></li><li><a href=/blog-bitix/pages/donate/>Donaciones</a></li><li><a href=/blog-bitix/pages/about/>Acerca de...</a></li></ul></div><div class="col-12 col-sm-4 text-center links"><a href=index.xml title="¡Suscríbete a Blog Bitix!"><img src=assets/images/rss.png class=icon></a>
<a href=https://twitter.com/picodotdev/ title="¡Sígueme en twitter!"><img src=assets/images/twitter.svg class=icon></a>
<a href=https://github.com/picodotdev/blog-ejemplos/ title="¡Obtén el código fuente de los ejemplos!"><img src=assets/images/github.svg class=icon></a></div></div><div class=row><div class=col-12>Copyleft <span class=copyleft>&copy;</span> 2019 - <a href=https://creativecommons.org/licenses/by-sa/4.0/ rel=nofollow rel=license><img alt="Licencia de Creative Commons" title="Licencia de Creative Commons" style=border-width:0 src=https://licensebuttons.net/l/by-sa/4.0/80x15.png class=licencia></a><br><a href=https://twitter.com/blogstackinfo rel=nofollow><img src=https://picodotdev.github.io/blog-bitix/assets/images/blog-stack.png alt="Blog Stack" title="Blog Stack"></a>
<a href=https://www.planetacodigo.com/ rel=nofollow><img src=https://picodotdev.github.io/blog-bitix/assets/images/planeta-codigo.png alt="Planeta código" title="Planeta código"></a><br><span xmlns:dct=http://purl.org/dc/terms/ property="dct:title"><a href=https://picodotdev.github.io/blog-bitix/ rel=nofollow>Blog Bitix</a></span> by <a xmlns:cc=https://creativecommons.org/ns# href=https://picodotdev.github.io/blog-bitix/ property="cc:attributionName" rel=cc:attributionurl>pico.dev</a> is licensed under a <a rel=license href=https://creativecommons.org/licenses/by-sa/4.0/>Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional License</a>.<br><span class=credit>Powered by <a href=https://gohugo.io/ rel=nofollow title="A fast and modern static website engine">Hugo</a> and <a href=https://pages.github.com/ title="Websites for you and your projects">GitHub Pages</a>.</span>
<span class=credit>Background patterns from <a href=https://www.toptal.com/designers/subtlepatterns/ rel=nofollow>Subtle Patterns</a>.</span></div></div></footer></div><div class=blueimp-gallery-container><div id=blueimp-gallery class="blueimp-gallery blueimp-gallery-controls" data-use-bootstrap-modal=false><div class=slides></div><h3 class=title></h3><a class=prev>‹</a>
<a class=next>›</a>
<a class=close>×</a>
<a class=play-pause></a><ol class=indicator></ol><div class="modal fade"><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close aria-hidden=true>&#215;</button><h4 class=modal-title></h4></div><div class="modal-body next"></div><div class=modal-footer><button type=button class="btn btn-default pull-left prev">
<i class="glyphicon glyphicon-chevron-left"></i>Anterior</button>
<button type=button class="btn btn-primary next">
Siguiente
<i class="glyphicon glyphicon-chevron-right"></i></button></div></div></div></div></div></div><script type=text/javascript>window.cookieconsent_options={"message":"Esta bitácora te informa de la obviedad de que utiliza «cookies», propias y de servicios como Google Analytics y Google AdSense entre otros.","dismiss":"Aceptar","learnMore":"Más información","link":null,"theme":"dark-bottom"};</script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js async></script></body></html>