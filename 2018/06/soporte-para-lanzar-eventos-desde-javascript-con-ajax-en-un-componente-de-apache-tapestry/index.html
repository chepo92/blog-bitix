<!doctype html><html lang=es><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="picodotdev"><meta name=keywords content="java,programacion,software,hardware,tapestry,software libre,gnu,linux,gnu/linux,unix,arch,arch linux,html,css,javascript"><meta name=description content="Para desarrollar aplicaciones web con el lenguaje de programación Java hay gran cantidad de frameworks que proponen un marco de trabajo para proporcionar la mayor parte de la funcionalidad de infraestructura necesaria para una aplicación. La mayoría basados en acciones y unos pocos basados en componentes. Una aplicación web no solo consta de la parte del servidor y desde hace tiempo la parte de cliente ha cobrado gran importancia. &hellip;"><base href=https://picodotdev.github.io/blog-bitix/><title>Soporte para lanzar eventos desde JavaScript con Ajax en un componente de Apache Tapestry</title><link rel=author type=text/plain href=humans.txt><link rel="shortcut icon" href=assets/favicon.ico><link rel=apple-touch-icon-precomposed sizes=144x144 href=assets/apple-touch-icon-144-precomposed.png><link rel=canonical href=https://picodotdev.github.io/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/><link href=index.xml rel=alternate type=application/rss+xml title="Blog Bitix"><link rel=stylesheet type=text/css href=assets/css/font.css><link rel=stylesheet type=text/css href=assets/libs/bootstrap-4.3.1/css/bootstrap.min.css><link rel=stylesheet type=text/css href=assets/libs/Gallery-2.33.0/css/blueimp-gallery.min.css><link rel=stylesheet type=text/css href=assets/css/syntax.css><link rel=stylesheet type=text/css href=assets/css/main.css><script type=text/javascript src=assets/js/require-config.js data-main=js/main defer></script><script type=text/javascript src=assets/libs/require.js data-main=js/main defer></script><script src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js defer></script><script type=text/javascript defer>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:'ca-pub-3533636310991304',enable_page_level_ads:true});</script><script type=text/javascript defer>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-12874075-4','picodotdev.github.io');ga('send','pageview');</script><script type=text/javascript src="//platform-api.sharethis.com/js/sharethis.js#property=5920c4ce1bd0670011e06acd&product=inline-share-buttons" defer></script><script type=text/javascript src=assets/js/app.js defer></script></head><body><div class=container><div class=row><div class=col-12><header><div class=row><div class="col-12 col-lg-4"></div><div class="col-12 col-lg-4"><h2 class=title><a href=https://picodotdev.github.io/blog-bitix/>Blog Bitix</a></h2><div class=links><a href=index.xml title="¡Suscríbete a Blog Bitix!"><img src=assets/images/rss.png class=icon></a>
<a href=https://twitter.com/picodotdev/ title="¡Sígueme en twitter!"><img src=assets/images/twitter.svg class=icon></a>
<a href=https://github.com/picodotdev/blog-ejemplos/ title="¡Obtén el código fuente de los ejemplos!"><img src=assets/images/github.svg class=icon></a></div></div><div class="col-12 col-lg-4 text-center"><form name=query class="form-inline search" onsubmit="return false;"><div class=input-group><input type=text name=q class=form-control placeholder="Buscar en Blog Bitix">
<span class=input-group-btn><button class="btn btn-secondary" type=submit>Buscar</button></span></div></form><form name=search action=https://duckduckgo.com/ method=get class=hidden data-site=https://picodotdev.github.io/blog-bitix/><input type=hidden name=q></form></div></div><div class=row><div class=col-12><nav class="nav nav-pills nav-fill"><a href=/blog-bitix/tags/java/ class="nav-item nav-link">Java</a>
<a href=/blog-bitix/tags/gnu-linux/ class="nav-item nav-link">GNU/Linux</a>
<a href=/blog-bitix/tags/javascript/ class="nav-item nav-link">JavaScript</a>
<a href=/blog-bitix/tags/tapestry/ class="nav-item nav-link">Tapestry</a>
<a href=/blog-bitix/archive/ class="nav-item nav-link">Archivo y hemeroteca</a>
<a href=/blog-bitix/pages/links/ class="nav-item nav-link">Enlaces</a>
<a href=/blog-bitix/pages/about/ class="nav-item nav-link">Acerca de...</a></nav></div></div></header></div></div><div class=row><div class="col-12 text-center"><ins class=adsbygoogle style=display:inline-block;width:970px;height:250px data-ad-client=ca-pub-3533636310991304 data-ad-slot=2975854584 data-type=billboard></ins></div></div><div class=row><div class=col-12><div class="adblock-sidebar adblock-sidebar-right"><div class=adblock-sidebar-container><ins class="adsbygoogle adblock-sidebar-vertical" style=display:block data-ad-client=ca-pub-3533636310991304 data-ad-slot=9933840986 data-ad-format="vertical, rectangle" data-type=auto></ins></div></div><article itemprop=mainEntity itemscope itemtype=http://schema.org/BlogPosting><meta itemprop=inLanguage content="es"><meta itemprop=keywords content="java, javascript, planeta-codigo, programacion, tapestry"><h1 itemprop=name>Soporte para lanzar eventos desde JavaScript con Ajax en un componente de Apache Tapestry</h1><p class=information>Escrito por
<span itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>picodotdev</span></span> el <time itemprop=datePublished datetime=2018-06-09>09/06/2018</time>.<br><a href=tags/java/>java</a> <a href=tags/javascript/>javascript</a> <a href=tags/planeta-codigo/>planeta-codigo</a> <a href=tags/programacion/>programacion</a> <a href=tags/tapestry/>tapestry</a><br><a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/ itemprop=url>Enlace permanente</a>
<a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/#comments>Comentarios</a></p><div class=content itemprop=articleBody><meta itemprop=wordCount content="908"><div class=logotypes style=float:right><img src=assets/images/logotipos/apache-tapestry-5.svg class=right width=400 alt="Apache Tapestry" title="Apache Tapestry"></div><div class=logotypes style=float:right;clear:right><img src=assets/images/logotipos/java.svg class=right width=200 alt=Java title=Java></div><p>Para desarrollar aplicaciones web con el lenguaje de programación Java hay gran cantidad de <em>frameworks</em> que proponen un marco de trabajo para proporcionar la mayor parte de la funcionalidad de infraestructura necesaria para una aplicación. La mayoría basados en acciones y unos pocos basados en componentes. Una aplicación web no solo consta de la parte del servidor y desde hace tiempo la parte de cliente ha cobrado gran importancia.</p><p>Algunos <em>frameworks</em> proporcionan cierto soporte para JavaScript y recursos CSS en otros es muy escaso o inexistente. En el caso del <em>framework</em> <a href=https://tapestry.apache.org/>Apache Tapestry</a> en la categoría de los basados en componentes proporciona un gran soporte no solo en la parte del servidor sino también para la parte cliente.</p><p>Una de estas funcionalidades que proporciona Tapestry es poder lanzar eventos desde el cliente mediante una petición <em>Ajax</em> para que sean procesados en el servidor y obtener la respuesta que se devuelva desde el servidor normalmente en formato <em>Json</em>. Hay que definir un manejador de evento en el servidor siguiendo la convención <em>on[Event]</em> y en caso de querer lanzar un evento desde el cliente anotándolo con <a href=http://tapestry.apache.org/current/apidocs/index.html?org/apache/tapestry5/ComponentResources.html>@PublishEvent</a>.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-Java data-lang=Java><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-Java data-lang=Java><span class=err>package io</span><span class=p>.</span><span class=na>github</span><span class=p>.</span><span class=na>picodotdev</span><span class=p>.</span><span class=na>plugintapestry</span><span class=p>.</span><span class=na>components</span><span class=p>;</span>

<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>BindingConstants</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>MarkupWriter</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>annotations</span><span class=p>.</span><span class=na>Component</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>annotations</span><span class=p>.</span><span class=na>Environmental</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>annotations</span><span class=p>.</span><span class=na>Parameter</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>annotations</span><span class=p>.</span><span class=na>PublishEvent</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>corelib</span><span class=p>.</span><span class=na>components</span><span class=p>.</span><span class=na>Any</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>json</span><span class=p>.</span><span class=na>JSONArray</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>json</span><span class=p>.</span><span class=na>JSONObject</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>services</span><span class=p>.</span><span class=na>javascript</span><span class=p>.</span><span class=na>JavaScriptSupport</span><span class=p>;</span>

<span class=cm>/**
</span><span class=cm> * @tapestrydoc
</span><span class=cm> */</span>
<span class=err>public class </span><span class=n>Event</span> <span class=p>{</span>

    <span class=nd>@Parameter</span><span class=p>(</span><span class=n>defaultPrefix</span> <span class=o>=</span> <span class=n>BindingConstants</span><span class=p>.</span><span class=na>LITERAL</span><span class=p>)</span>
    <span class=err>private String </span><span class=n>selector</span><span class=p>;</span>

    <span class=nd>@Component</span>
    <span class=err>private Any </span><span class=n>span</span><span class=p>;</span>

    <span class=nd>@Environmental</span>
    <span class=err>private JavaScriptSupport </span><span class=n>support</span><span class=p>;</span>

    <span class=nd>@PublishEvent</span>
    <span class=err>Object onGetColores</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>JSONArray</span><span class=p>(</span><span class=s>&#34;Rojo&#34;</span><span class=p>,</span> <span class=s>&#34;Verde&#34;</span><span class=p>,</span> <span class=s>&#34;Azul&#34;</span><span class=p>,</span> <span class=s>&#34;Negro&#34;</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=err>protected void </span><span class=n>afterRender</span><span class=p>(</span><span class=err>MarkupWriter writer</span><span class=p>)</span> <span class=p>{</span>
        <span class=err>JSONObject spec </span><span class=o>=</span> <span class=k>new</span> <span class=n>JSONObject</span><span class=p>();</span>
        <span class=n>spec</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;selector&#34;</span><span class=p>,</span> <span class=n>span</span><span class=p>.</span><span class=na>getClientId</span><span class=p>());</span>

        <span class=n>support</span><span class=p>.</span><span class=na>require</span><span class=p>(</span><span class=s>&#34;app/event&#34;</span><span class=p>).</span><span class=na>invoke</span><span class=p>(</span><span class=s>&#34;init&#34;</span><span class=p>).</span><span class=na>with</span><span class=p>(</span><span class=n>spec</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/Event.java target=_blank>view raw</a></span>
<a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/Event.java target=_blank>Event.java</a></div></div><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-HTML data-lang=HTML><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-HTML data-lang=HTML><span class=cp>&lt;!DOCTYPE html&gt;</span>
<span class=p>&lt;</span><span class=nt>t:container</span> <span class=na>xmlns</span><span class=o>=</span><span class=s>&#34;http://www.w3.org/1999/xhtml&#34;</span> <span class=na>xmlns:t</span><span class=o>=</span><span class=s>&#34;http://tapestry.apache.org/schema/tapestry_5_4.xsd&#34;</span> <span class=na>xmlns:p</span><span class=o>=</span><span class=s>&#34;tapestry:parameter&#34;</span><span class=p>&gt;</span>
    Colores: <span class=p>&lt;</span><span class=nt>span</span> <span class=na>t:type</span><span class=o>=</span><span class=s>&#34;any&#34;</span> <span class=na>t:id</span><span class=o>=</span><span class=s>&#34;span&#34;</span><span class=p>&gt;</span>Cargando...<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span> (Event/Json)
<span class=p>&lt;/</span><span class=nt>t:container</span><span class=p>&gt;</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/Event.tml target=_blank>view raw</a></span>
<a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/Event.tml target=_blank>Event.tml</a></div></div><p>El uso del componente en una plantilla de una página.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-HTML data-lang=HTML><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-HTML data-lang=HTML>...
<span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>t:event</span><span class=p>/&gt;</span>
<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
...</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/Index.tml target=_blank>view raw</a></span>
<a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/Index.tml target=_blank>Index.tml</a></div></div><p>En el código JavaScript asociado a una página o componente hay que hacer uso del módulo que ofrece el soporte para <em>Ajax</em> y los eventos desde el cliente, con <a href=https://requirejs.org/>RequireJS</a> se obtiene una referencia a él. Solo es necesario indicar como parámetro el nombre del evento a lanzar, los parámetros si los hubiese y los manejadores de respuesta, tanto en el caso de ser correcta que recibirá los datos devueltos en el servidor como incorrecta. En el archivo <a href="https://git1-us-west.apache.org/repos/asf?p=tapestry-5.git;a=blob_plain;f=tapestry-core/src/main/coffeescript/META-INF/modules/t5/core/ajax.coffee;hb=85cc611fbad4a3574664b33ce9adf614b4f0fe07">ajax.coffee</a> están documentados todos los parámetros que posee la función <em>ajax</em> del módulo <em>t5/core/ajax</em>.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=nx>define</span><span class=p>(</span><span class=s2>&#34;app/event&#34;</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;t5/core/ajax&#34;</span><span class=p>,</span> <span class=s2>&#34;jquery&#34;</span><span class=p>],</span> <span class=kd>function</span><span class=p>(</span><span class=nx>ajax</span><span class=p>,</span> <span class=nx>$</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>function</span> <span class=nx>Colores</span><span class=p>(</span><span class=nx>spec</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>var</span> <span class=nx>_this</span> <span class=o>=</span> <span class=k>this</span><span class=p>;</span>
        
        <span class=k>this</span><span class=p>.</span><span class=nx>spec</span> <span class=o>=</span> <span class=nx>spec</span><span class=p>;</span>

        <span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
            <span class=nx>_this</span><span class=p>.</span><span class=nx>getColores</span><span class=p>();</span>
        <span class=p>},</span> <span class=mi>2000</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nx>Colores</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>getColores</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
        <span class=kd>var</span> <span class=nx>_this</span> <span class=o>=</span> <span class=k>this</span><span class=p>;</span>
        
        <span class=nx>ajax</span><span class=p>(</span><span class=s1>&#39;getColores&#39;</span><span class=p>,</span> <span class=p>{</span>
            <span class=nx>element</span><span class=o>:</span> <span class=nx>$</span><span class=p>(</span><span class=nx>_this</span><span class=p>.</span><span class=nx>spec</span><span class=p>.</span><span class=nx>selector</span><span class=p>),</span>
            <span class=nx>success</span><span class=o>:</span> <span class=kd>function</span><span class=p>(</span><span class=nx>response</span><span class=p>)</span> <span class=p>{</span>
                <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>.</span><span class=nx>join</span><span class=p>();</span>
                <span class=nx>$</span><span class=p>(</span><span class=nx>_this</span><span class=p>.</span><span class=nx>spec</span><span class=p>.</span><span class=nx>selector</span><span class=p>).</span><span class=nx>html</span><span class=p>(</span><span class=nx>c</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>});</span>
    <span class=p>}</span>

    <span class=kd>function</span> <span class=nx>init</span><span class=p>(</span><span class=nx>spec</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>new</span> <span class=nx>Colores</span><span class=p>(</span><span class=nx>spec</span><span class=p>);</span>
    <span class=p>}</span>
    
    <span class=k>return</span> <span class=p>{</span>
        <span class=nx>init</span><span class=o>:</span> <span class=nx>init</span>
    <span class=p>}</span>
<span class=p>});</span>
</code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/event.js target=_blank>view raw</a></span>
<a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/event.js target=_blank>event.js</a></div></div><p>En el primer elemento del HTML se añade un atributo <em>data-componenent-events</em> que contiene la URL necesaria para cada evento que haya sido declarado como lanzable. A partir del elemento indicado en la opción <em>element</em> se busca la URL en el atributo <em>data-componenent-events</em> siguiendo un orden empezando por el propio elemento, en los previos al mismo nivel jerárquicamente empezando por el más cercano desde abajo hacia arriba, en los padres y finalmente en el elemento <em>body</em>.</p><div class=media style=text-align:center><figure><a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/images/event_hu8172c8a741f24521f7cd7f3616353770_847602_2560x1440_fit_box_2.png title="Petición Ajax del evento" data-gallery><img src=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/images/event_hu8172c8a741f24521f7cd7f3616353770_847602_300x200_fit_box_2.png width=300></a>
<a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/images/data-component-events_hu8172c8a741f24521f7cd7f3616353770_837819_2560x1440_fit_box_2.png title="Atributo con la URL del evento" data-gallery><img src=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/images/data-component-events_hu8172c8a741f24521f7cd7f3616353770_837819_300x200_fit_box_2.png width=300></a><figcaption>Petición Ajax y atributo con la URL del evento</figcaption></figure></div><p>Esta funcionalidad se incorporó en Apache Tapestry 5.2 donde hasta entonces era necesario construir la URL del evento en el servidor con <a href=http://tapestry.apache.org/current/apidocs/org/apache/tapestry5/ComponentResourcesCommon.html#createEventLink-java.lang.String-java.lang.Object...->ComponentResources.createEventLink()</a> y enviarlo al componente haciendo uso de <a href=http://tapestry.apache.org/current/apidocs/org/apache/tapestry5/services/javascript/JavaScriptSupport.html>JavaScriptSupport</a> como se muestra en el componente <em>Ajax</em> que no hace uso de esta funcionalidad de eventos.</p><div class=code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-Java data-lang=Java><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-Java data-lang=Java><span class=err>package io</span><span class=p>.</span><span class=na>github</span><span class=p>.</span><span class=na>picodotdev</span><span class=p>.</span><span class=na>plugintapestry</span><span class=p>.</span><span class=na>components</span><span class=p>;</span>

<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>BindingConstants</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>ComponentResources</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>MarkupWriter</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>annotations</span><span class=p>.</span><span class=na>Environmental</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>annotations</span><span class=p>.</span><span class=na>Parameter</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>ioc</span><span class=p>.</span><span class=na>annotations</span><span class=p>.</span><span class=na>Inject</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>json</span><span class=p>.</span><span class=na>JSONArray</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>json</span><span class=p>.</span><span class=na>JSONObject</span><span class=p>;</span>
<span class=err>import org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>tapestry5</span><span class=p>.</span><span class=na>services</span><span class=p>.</span><span class=na>javascript</span><span class=p>.</span><span class=na>JavaScriptSupport</span><span class=p>;</span>

<span class=cm>/**
</span><span class=cm> * @tapestrydoc
</span><span class=cm> */</span>
<span class=err>public class </span><span class=n>Ajax</span> <span class=p>{</span>

    <span class=nd>@Parameter</span><span class=p>(</span><span class=n>defaultPrefix</span> <span class=o>=</span> <span class=n>BindingConstants</span><span class=p>.</span><span class=na>LITERAL</span><span class=p>)</span>
    <span class=err>private String </span><span class=n>selector</span><span class=p>;</span>

    <span class=nd>@Environmental</span>
    <span class=err>private JavaScriptSupport </span><span class=n>support</span><span class=p>;</span>

    <span class=nd>@Inject</span>
    <span class=err>private ComponentResources </span><span class=n>componentResources</span><span class=p>;</span>

    <span class=err>Object onGetColores</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>JSONArray</span><span class=p>(</span><span class=s>&#34;Rojo&#34;</span><span class=p>,</span> <span class=s>&#34;Verde&#34;</span><span class=p>,</span> <span class=s>&#34;Azul&#34;</span><span class=p>,</span> <span class=s>&#34;Negro&#34;</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=err>protected void </span><span class=n>afterRender</span><span class=p>(</span><span class=err>MarkupWriter writer</span><span class=p>)</span> <span class=p>{</span>
        <span class=err>String link </span><span class=o>=</span> <span class=n>componentResources</span><span class=p>.</span><span class=na>createEventLink</span><span class=p>(</span><span class=s>&#34;getColores&#34;</span><span class=p>).</span><span class=na>toAbsoluteURI</span><span class=p>();</span>

        <span class=err>JSONObject spec </span><span class=o>=</span> <span class=k>new</span> <span class=n>JSONObject</span><span class=p>();</span>
        <span class=n>spec</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;selector&#34;</span><span class=p>,</span> <span class=n>selector</span><span class=p>);</span>
        <span class=n>spec</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;link&#34;</span><span class=p>,</span> <span class=n>link</span><span class=p>);</span>

        <span class=n>support</span><span class=p>.</span><span class=na>require</span><span class=p>(</span><span class=s>&#34;app/ajax&#34;</span><span class=p>).</span><span class=na>invoke</span><span class=p>(</span><span class=s>&#34;init&#34;</span><span class=p>).</span><span class=na>with</span><span class=p>(</span><span class=n>spec</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span></code></pre></td></tr></table></div></div><div class=highlight-meta><span class=raw><a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/Ajax.java target=_blank>view raw</a></span>
<a href=/blog-bitix/2018/06/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry/code/Ajax.java target=_blank>Ajax.java</a></div></div><p>Con este soporte es algo más fácil enviar eventos y realizar peticiones <em>Ajax</em> desde el cliente para obtener datos.</p><p>El <a href=https://github.com/picodotdev/blog-ejemplos/tree/master/PlugInTapestry>código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en <a href=https://github.com/>GitHub</a> y probarlo en tu equipo ejecutando el comando <code>./gradlew run</code>.</p><div class="alert alert-warning"><img src=assets/images/misc/PugInTapestry.png alt="Portada libro: PlugIn Tapestry" title="Portada libro: PlugIn Tapestry" style=float:left;margin-right:1.5em><h3>Libro PlugIn Tapestry</h3><p>Si te interesa Apache Tapestry descarga gratis el libro de más de 300 páginas que he escrito sobre este <i>framework</i> en el formato que prefieras, <a href=https://picodotdev.github.io/blog-bitix/2014/02/libro-sobre-desarrollo-de-aplicaciones-con-apache-tapestry/>PlugIn Tapestry: Desarrollo de aplicaciones y páginas web con Apache Tapestry</a>, y el código de ejemplo asociado. En el libro comento detalladamente muchos aspectos que son necesarios en una aplicación web como persistencia, pruebas unitarias y de integración, inicio rápido, seguridad, formularios, internacionalización (i18n) y localización (l10n), AJAX, ... y como abordarlos usando Apache Tapestry.</p><br style=clear:both><div class=buttons><a href=https://picodotdev.github.io/blog-bitix/assets/custom/PlugInTapestry.pdf class="btn btn-lg btn-success">PDF</a>
<a href=https://github.com/picodotdev/blog-ejemplos/tree/master/PlugInTapestry class="btn btn-lg btn-success">Código fuente ejemplos</a></div></div><div class=reference>Referencia:<br><ul><li><a href=https://tapestry.apache.org/ajax-and-zones.html>Ajax and Zones</a></li><li><a href="https://git1-us-west.apache.org/repos/asf?p=tapestry-5.git;a=blob_plain;f=tapestry-core/src/main/coffeescript/META-INF/modules/t5/core/ajax.coffee;hb=85cc611fbad4a3574664b33ce9adf614b4f0fe07">ajax.coffee</a></li></ul></div></div></article><div class="row related"><div class=col-md-12>Artículos relacionados:<ul><li><a href=/blog-bitix/2016/10/anadir-botones-selectores-de-opciones-a-select-multiple-de-bootsrap-select/>Añadir botones selectores de opciones a select múltiple de bootsrap-select</a></li><li><a href=/blog-bitix/2016/10/componente-select-multiple-en-apache-tapestry/>Componente select múltiple en Apache Tapestry</a></li><li><a href=/blog-bitix/2016/10/componente-select-de-apache-tapestry-con-funcionalidades-adicionales-usando-bootstrap-select/>Componente select de Apache Tapestry con funcionalidades adicionales usando bootstrap-select</a></li><li><a href=/blog-bitix/2018/06/actualizar-las-versiones-de-las-librerias-javascript-built-in-de-apache-tapestry/>Actualizar las versiones de las librerías JavaScript built-in de Apache Tapestry</a></li><li><a href=/blog-bitix/2018/06/dependencias-sobre-librerias-de-lado-de-cliente-con-webjars-en-una-aplicacion-web-java/>Dependencias sobre librerías de lado de cliente con Webjars en una aplicación web Java</a></li></ul></div></div><div class=row><div class=col-md-12><div class=sharethis-inline-share-buttons></div></div></div><div class=row><div class="col-12 text-center"><ins class=adsbygoogle style=display:inline-block;width:970px;height:250px data-ad-client=ca-pub-3533636310991304 data-ad-slot=2975854584 data-type=billboard></ins></div></div><a id=comments></a><div class=row><div class=col-md-12><div id=disqus_thread></div></div></div><script type=text/javascript async>var disqus_shortname='blog-bitix';var disqus_identifier='https:\/\/picodotdev.github.io\/blog-bitix\/2018\/06\/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry\/';var disqus_url='https:\/\/picodotdev.github.io\/blog-bitix\/2018\/06\/soporte-para-lanzar-eventos-desde-javascript-con-ajax-en-un-componente-de-apache-tapestry\/';var disqus_script='embed.js';(function(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;dsq.src='//'+disqus_shortname+'.disqus.com/'+disqus_script;(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);}());</script></div></div><div class=row><div class=col-12><hr></div></div><footer><div class=row><div class="col-12 col-sm-4"><p><strong>Blog Bitix</strong></p><p>Blog dedicado a la distribución GNU/Linux que uso habitualmente, Arch Linux, a mis andanzas alrededor del software libre, la programación y a otros temas relacionados con la tecnología y la informática.</p><p>Publicando de uno a tres artículos únicos a la semana desde el año 2010.</p></div><div class="col-12 col-sm-4 text-center menu"><ul class=list-unstyled><li><a href=/blog-bitix/tags/java/>Java</a></li><li><a href=/blog-bitix/tags/gnu-linux/>GNU/Linux</a></li><li><a href=/blog-bitix/tags/javascript/>JavaScript</a></li><li><a href=/blog-bitix/tags/tapestry/>Tapestry</a></li><li><a href=/blog-bitix/archive/>Archivo y hemeroteca</a></li><li><a href=/blog-bitix/pages/links/>Enlaces</a></li><li><a href=/blog-bitix/pages/advertising/>Publicidad</a></li><li><a href=/blog-bitix/pages/donate/>Donaciones</a></li><li><a href=/blog-bitix/pages/about/>Acerca de...</a></li></ul></div><div class="col-12 col-sm-4 text-center links"><a href=index.xml title="¡Suscríbete a Blog Bitix!"><img src=assets/images/rss.png class=icon></a>
<a href=https://twitter.com/picodotdev/ title="¡Sígueme en twitter!"><img src=assets/images/twitter.svg class=icon></a>
<a href=https://github.com/picodotdev/blog-ejemplos/ title="¡Obtén el código fuente de los ejemplos!"><img src=assets/images/github.svg class=icon></a></div></div><div class=row><div class=col-12>Copyleft <span class=copyleft>&copy;</span> 2019 - <a href=https://creativecommons.org/licenses/by-sa/4.0/ rel=nofollow rel=license><img alt="Licencia de Creative Commons" title="Licencia de Creative Commons" style=border-width:0 src=https://licensebuttons.net/l/by-sa/4.0/80x15.png class=licencia></a><br><a href=https://twitter.com/blogstackinfo rel=nofollow><img src=https://picodotdev.github.io/blog-bitix/assets/images/blog-stack.png alt="Blog Stack" title="Blog Stack"></a>
<a href=https://www.planetacodigo.com/ rel=nofollow><img src=https://picodotdev.github.io/blog-bitix/assets/images/planeta-codigo.png alt="Planeta código" title="Planeta código"></a><br><span xmlns:dct=http://purl.org/dc/terms/ property="dct:title"><a href=https://picodotdev.github.io/blog-bitix/ rel=nofollow>Blog Bitix</a></span> by <a xmlns:cc=https://creativecommons.org/ns# href=https://picodotdev.github.io/blog-bitix/ property="cc:attributionName" rel=cc:attributionurl>pico.dev</a> is licensed under a <a rel=license href=https://creativecommons.org/licenses/by-sa/4.0/>Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional License</a>.<br><span class=credit>Powered by <a href=https://gohugo.io/ rel=nofollow title="A fast and modern static website engine">Hugo</a> and <a href=https://pages.github.com/ title="Websites for you and your projects">GitHub Pages</a>.</span>
<span class=credit>Background patterns from <a href=https://www.toptal.com/designers/subtlepatterns/ rel=nofollow>Subtle Patterns</a>.</span></div></div></footer></div><div class=blueimp-gallery-container><div id=blueimp-gallery class="blueimp-gallery blueimp-gallery-controls" data-use-bootstrap-modal=false><div class=slides></div><h3 class=title></h3><a class=prev>‹</a>
<a class=next>›</a>
<a class=close>×</a>
<a class=play-pause></a><ol class=indicator></ol><div class="modal fade"><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close aria-hidden=true>&times;</button><h4 class=modal-title></h4></div><div class="modal-body next"></div><div class=modal-footer><button type=button class="btn btn-default pull-left prev">
<i class="glyphicon glyphicon-chevron-left"></i>Anterior</button>
<button type=button class="btn btn-primary next">
Siguiente
<i class="glyphicon glyphicon-chevron-right"></i></button></div></div></div></div></div></div><script type=text/javascript>window.cookieconsent_options={"message":"Esta bitácora te informa de la obviedad de que utiliza «cookies», propias y de servicios como Google Analytics y Google AdSense entre otros.","dismiss":"Aceptar","learnMore":"Más información","link":null,"theme":"dark-bottom"};</script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js async></script></body></html>