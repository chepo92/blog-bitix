<!DOCTYPE html><html lang=""><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="pico.dev"><meta name="keywords" content="java, programacion, tapestry, linux, gnu, gnu/linux, arch, arch linux, software, software libre, html, css, javascript"><meta name="description" content="Desde la versión 1.6 del JDK disponemos de una API para acceder al compilador desde un programa Java. En el ejemplo de este artículo utilizaré varias clases de esa API para conseguir compilar un archivo con la definición de una clase Java y posteriormente instanciarla y usarla. En posteriores artículos comentaré un ejemplo práctico y muy útil con el que podemos sacar provecho de esta funcionalidad.
Las clases que necesitaremos de esa API son: &hellip;"><base href="https://picodotdev.github.io/blog-bitix/"><title>Compilar y cargar de forma dinámica una clase Java | Blog Bitix</title><link rel="author" type="text/plain" href="humans.txt"><link rel="shortcut icon" href="assets/favicon.ico"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/apple-touch-icon-144-precomposed.png"><link rel="canonical" href="https://picodotdev.github.io/blog-bitix/2014/09/compilar-y-cargar-de-forma-dinamica-una-clase-java/"><link href="index.xml" rel="alternate" type="application/rss+xml" title="Blog Bitix"><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Serif:400,700italic,700,400italic"><link rel="stylesheet" type="text/css" href="//www.google.com/cse/api/branding.css"><link rel="stylesheet" type="text/css" href="assets/libs/bootstrap-3.3.6-dist/css/bootstrap.min.css"><link rel="stylesheet" href="assets/libs/Gallery-2.17.0/css/blueimp-gallery.min.css"><link rel="stylesheet" href="assets/libs/Bootstrap-Image-Gallery-3.3.6/css/bootstrap-image-gallery.min.css"><link rel="stylesheet" type="text/css" href="assets/css/main.css"><script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><script type="text/javascript">(adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: 'ca-pub-3533636310991304',
      enable_page_level_ads: true
    });
    var sharethisPublisher = 'ur-a2d4b156-3d22-5ffc-2477-6c0f8a809173';</script><script type="text/javascript" async>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-12874075-4', 'picodotdev.github.io');
    ga('send', 'pageview');</script><script type="text/javascript" src="assets/libs/require.min.js" data-main="assets/js/main" async></script></head><body><div class="container"><div class="row"><header><div class="row"><div class="col-md-4 col-md-offset-4"><h2 class="title"><a href="https://picodotdev.github.io/blog-bitix/">Blog Bitix</a></h2><div class="links"><a href="index.xml" title="¡Suscríbete a Blog Bitix!"><img src="assets/images/custom/rss.png"></a><a href="https://twitter.com/picodotdev/" title="¡Sígueme en twitter!"><img src="assets/images/custom/twitter.png"></a><a href="https://plus.google.com/114317443908384387611/posts" title="¡Sigue a Blog Bitix en Google&#43;!"><img src="assets/images/custom/google-plus.png"></a><a href="https://github.com/picodotdev/blog-ejemplos/" title="¡Obtén el código fuente de los ejemplos!"><img src="assets/images/custom/github.png"></a></div></div><div class="col-md-4 text-center"><form name="query" class="form-inline search" onsubmit="return false"><div class="input-group"><input type="text" name="q" class="form-control" placeholder="Buscar en Blog Bitix"> <span class="input-group-btn"><button class="btn btn-default" type="submit">Buscar</button></span></div></form><form name="search" action="https://duckduckgo.com/" method="get" class="hidden" data-site="https://picodotdev.github.io/blog-bitix/"><input type="hidden" name="q" value=""></form></div></div><div class="row"><div class="col-md-12"><nav><ul class="nav nav-pills"><li role="presentation"><a href="/blog-bitix/tags/java/">Java</a></li><li role="presentation"><a href="/blog-bitix/tags/gnu-linux/">GNU/Linux</a></li><li role="presentation"><a href="/blog-bitix/tags/javascript/">JavaScript</a></li><li role="presentation"><a href="/blog-bitix/tags/tapestry/">Tapestry</a></li><li role="presentation"><a href="/blog-bitix/archive/">Archivo y hemeroteca</a></li><li role="presentation"><a href="/blog-bitix/pages/links/">Enlaces</a></li><li role="presentation"><a href="/blog-bitix/pages/about/">Acerca de...</a></li></ul></nav></div></div></header><div class="col-sm-12 col-md-8"><div class="row"><div class="col-md-12"><article itemscope itemtype="http://schema.org/BlogPosting"><meta itemprop="inLanguage" content=""><meta itemprop="keywords" content="software, programacion, java, planeta-codigo, blog-stack"><h1 itemprop="name">Compilar y cargar de forma dinámica una clase Java</h1><p class="information">Publicado por <span itemscope itemtype="http://schema.org/Person"><span itemprop="name">pico.dev</span></span> el <time itemprop="datePublished" datetime="2014-09-12">12/09/2014</time>, actualizado el <time itemprop="dateModified" datetime="2015-05-30">30/05/2015</time>.<br><a href="tags/software/">software</a> <a href="tags/programacion/">programacion</a> <a href="tags/java/">java</a> <a href="tags/planeta-codigo/">planeta-codigo</a> <a href="tags/blog-stack/">blog-stack</a><br><a href="/blog-bitix/2014/09/compilar-y-cargar-de-forma-dinamica-una-clase-java/" itemprop="url">Enlace permanente</a> <a href="/blog-bitix/2014/09/compilar-y-cargar-de-forma-dinamica-una-clase-java/#comments">Comentarios</a></p><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-3533636310991304" data-ad-slot="5966819782" data-type="leaderboard"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="content" itemprop="articleBody"><meta itemprop="wordCount" content="532"><div class="share-this share-this-begin"><span class="st_twitter_vcount" displaytext="Tweet" st_via="picodotdev"></span></div><div class="logotypes" style="float: right"><img src="assets/images/custom/logotipos/java.png" class="right" alt="Java" title="Java"></div><p>Desde la versión 1.6 del JDK disponemos de una API para acceder al compilador desde un programa Java. En el ejemplo de este artículo utilizaré varias clases de esa API para conseguir compilar un archivo con la definición de una clase Java y posteriormente instanciarla y usarla. En posteriores artículos comentaré un ejemplo práctico y muy útil con el que podemos sacar provecho de esta funcionalidad.</p><p>Las clases que necesitaremos de esa API son:</p><ul><li><a href="http://docs.oracle.com/javase/7/docs/api/javax/tools/JavaCompiler.html">JavaCompiler</a> que es la interfaz para acceder al compilador desde un programa Java.</li><li><a href="http://docs.oracle.com/javase/7/docs/api/javax/tools/JavaFileManager.html">JavaFileManager</a> que es una abstracción para gestionar los archivos fuente y las clases. Usaremos uno propio llamado ClassFileManager.</li><li><a href="http://docs.oracle.com/javase/7/docs/api/javax/tools/SimpleJavaFileObject.html">SimpleJavaFileObject</a> clase que contiene el código fuente Java.</li></ul><p>Y también necesitaremos redefinir algunas:</p><ul><li>La clase ClassFileManager que extiende <a href="http://docs.oracle.com/javase/7/docs/api/javax/tools/ForwardingJavaFileManager.html">ForwardingJavaFileManager</a> y se encargará de cargar los objetos JavaClassObject con un ClassLoader.</li><li>La clase JavaClassObject que extiende <a href="http://docs.oracle.com/javase/7/docs/api/javax/tools/SimpleJavaFileObject.html">SimpleJavaFileObject</a> y contendrá el código bytecode generado en memoria por el compilador.</li><li>CharSequenceJavaFileObject clase que extiende <a href="http://docs.oracle.com/javase/7/docs/api/javax/tools/SimpleJavaFileObject.html">SimpleJavaFileObject</a> y que contiene el código fuente en un objeto de tipo CharSequence.</li><li>La interfaz Configuracion es la interfaz que debe cumplir la clase Java que compilaremos, cargaremos de forma dinámica en la aplicación y posteriormente invocaremos sus métodos.</li></ul><p>En el javadoc de las clases hay una descripción más amplia de cada una de ellas.</p><p>En el siguiente código suponiendo que disponemos en la variable source de un código Java a compilar y de la que crearemos mas tarde una instancia de la clase que define podemos hacerlo de la forma indicada continuación. Antes de mostrar el código código la clase a compilar y a cargar de forma dinámica en este ejemplo debe cumplir el contrato definido en una determinada interfaz de modo que una vez compilada y cargada sepamos que métodos podemos invocar de esa clase. En este caso el código fuente de la clase a compilar está hardcodeada en un String en el propio programa pero perfectamente podría haber obtenido su contenido de un archivo del disco duro o de una base de datos.</p><script src="//gist.github.com/picodotdev/bb8fafe477c926a26986.js?file=Main1.java"></script><script src="//gist.github.com/picodotdev/bb8fafe477c926a26986.js?file=Configuracion.java"></script><p>Con este ejemplo puede intuirse el ejemplo práctico que comentaré que no es más que utilizar código Java para definir la configuración de una aplicación, esto tiene varias ventajas sobre utilizar un xml u otro tipo de formato de archivo de configuración de la aplicación (una de ellas que utilizando un IDE el compilador nos informará de errores y nos ofrecerá asistencia al escribir código). Esta idea junto con la posibilidad de monitorizar un archivo para ver si se han producido cambios en él (también con la API de Java) y recargarlo puede darnos como resultado una funcionalidad en la que la configuración se basa en código Java y que la configuración pueda recargarse de forma dinámica, si la aplicación se utiliza en un servidor de aplicaciones podríamos cambiar la configuración sin tener que reiniciar la aplicación.</p><div class="media" style="text-align: center"><a href="assets/images/custom/posts/42/main1.png" title="Salida programa Main1.java" data-gallery><img src="assets/images/custom/posts/42/main1.png"></a></div><p>Casi para terminar las clases de utilidad:</p><script src="//gist.github.com/picodotdev/bb8fafe477c926a26986.js?file=ClassFileManager.java"></script><script src="//gist.github.com/picodotdev/bb8fafe477c926a26986.js?file=CharSequenceJavaFileObject.java"></script><script src="//gist.github.com/picodotdev/bb8fafe477c926a26986.js?file=JavaClassObject.java"></script><p>El código fuente completo puede encontrarse en el <a href="https://github.com/picodotdev/blog-ejemplos/tree/master/ConfiguracionJava">siguiente repositorio de GitHub</a>.</p><p>En el siguiente artículo comentaré como <a href="https://picodotdev.github.io/blog-bitix/2014/09/monitorizar-archivos-con-java/">monitorizar un archivo con código fuente Java</a> para ver si se han producido cambios en él. Y basándome en estos dos artículos comentaré como disponer de <a href="https://picodotdev.github.io/blog-bitix/2014/09/monitorizar-archivos-con-java/">un archivo de configuración que se recargue al detectase cambios en él</a>.</p></div></article></div></div><div class="row"><div class="col-md-12"><div class="share-this share-this-end"><span class="st_twitter_vcount" displaytext="Tweet" st_via="picodotdev"></span> <span class="st_facebook_vcount" displaytext="Facebook"></span> <span class="st_googleplus_vcount" displaytext="Google +"></span> <span class="st_linkedin_vcount" displaytext="LinkedIn"></span> <span class="st_sharethis_vcount" displaytext="ShareThis"></span></div></div></div><div class="row"><div class="col-md-12"><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-3533636310991304" data-ad-slot="5966819782" data-type="leaderboard"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div><a id="comments"></a><div class="row"><div class="col-md-12"><div id="disqus_thread"></div></div></div><script type="text/javascript" async>var disqus_shortname = 'blog-bitix';
    var disqus_identifier = 'https:\/\/picodotdev.github.io\/blog-bitix\/2014\/09\/compilar-y-cargar-de-forma-dinamica-una-clase-java\/';
    var disqus_url = 'https:\/\/picodotdev.github.io\/blog-bitix\/2014\/09\/compilar-y-cargar-de-forma-dinamica-una-clase-java\/';
    var disqus_script = 'embed.js';
    (function () {
      var dsq = document.createElement('script'); 
      dsq.type = 'text/javascript'; 
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());</script></div><div class="col-md-4"><div class="row"><div class="col-md-12 text-center"><ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px" data-ad-client="ca-pub-3533636310991304" data-ad-slot="9559414587" data-type="large-skycraper"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div><div class="row"><div class="col-md-12 text-center"><ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-3533636310991304" data-ad-slot="2873752587" data-type="large-rectangle"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div><div class="row text-center"><div class="col-md-12"><a href="https://picodotdev.github.io/blog-bitix/2015/12/yo-apoyo-al-software-libre-tu-tambien/"><img src="//static.fsf.org/nosvn/images/badges/badges_es/i-support-fs_red-bg-es.png" alt="Yo apoyo al software libre"></a></div></div><div class="row"><div class="col-md-12"><hr></div></div><div class="row"><div class="col-md-12"><ul class="list-unstyled recents"><li><span class="glyphicon glyphicon-hand-right"></span> <a href="archive/">Más artículos recientes en el archivo</a></li></ul></div></div></div></div><div class="row"><div class="col-md-12"><hr></div></div><footer><div class="row"><div class="col-md-4"><p><strong>Blog Bitix</strong></p><p>Blog dedicado a la distribución GNU/Linux que uso habitualmente, Arch Linux, a mis andanzas alrededor del software libre, la programación y a otros temas relacionados con la tecnología y la informática.</p></div><div class="col-md-4 text-center menu"><ul class="list-unstyled"><li><a href="/blog-bitix/tags/java/">Java</a></li><li><a href="/blog-bitix/tags/gnu-linux/">GNU/Linux</a></li><li><a href="/blog-bitix/tags/javascript/">JavaScript</a></li><li><a href="/blog-bitix/tags/tapestry/">Tapestry</a></li><li><a href="/blog-bitix/archive/">Archivo y hemeroteca</a></li><li><a href="/blog-bitix/pages/links/">Enlaces</a></li><li><a href="/blog-bitix/pages/advertising/">Publicidad</a></li><li><a href="/blog-bitix/pages/about/">Acerca de...</a></li></ul></div><div class="col-md-4 text-center links"><a href="index.xml" title="¡Suscríbete a Blog Bitix!"><img src="assets/images/custom/rss.png"></a><a href="https://twitter.com/picodotdev/" title="¡Sígueme en twitter!"><img src="assets/images/custom/twitter.png"></a><a href="https://plus.google.com/114317443908384387611/posts" title="¡Sigue a Blog Bitix en Google&#43;!"><img src="assets/images/custom/google-plus.png"></a><a href="https://github.com/picodotdev/blog-ejemplos/" title="¡Obtén el código fuente de los ejemplos!"><img src="assets/images/custom/github.png"></a></div></div><div class="row"><div class="col-md-12">Copyleft <span class="copyleft">&copy;</span> 2016 - <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Licencia de Creative Commons" title="Licencia de Creative Commons" style="border-width:0" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" class="licencia"></a><br><a href="https://twitter.com/blogstackinfo"><img src="https://picodotdev.github.io/blog-bitix/assets/images/custom/blog-stack.png" alt="Blog Stack" title="Blog Stack"></a><a href="http://planetalinux.org/es/"><img src="https://picodotdev.github.io/blog-bitix/assets/images/custom/planeta-linux.png" alt="Planeta Linux" title="Planeta Linux"></a><a href="http://www.planetacodigo.com/"><img src="https://picodotdev.github.io/blog-bitix/assets/images/custom/planeta-codigo.png" alt="Planeta código" title="Planeta código"></a><br><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a href="https://picodotdev.github.io/blog-bitix/">Blog Bitix</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://picodotdev.github.io/blog-bitix/" property="cc:attributionName" rel="cc:attributionURL">pico.dev</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional License</a>.<br><span class="credit">Powered by <a href="https://gohugo.io/" title="A fast and modern static website engine">Hugo</a> and <a href="https://pages.github.com/" title="Websites for you and your projects">GitHub Pages</a></span></div></div></footer></div><div class="blueimp-gallery-container"><div id="blueimp-gallery" class="blueimp-gallery blueimp-gallery-controls" data-use-bootstrap-modal="false"><div class="slides"></div><h3 class="title"></h3><a class="prev">‹</a> <a class="next">›</a> <a class="close">×</a> <a class="play-pause"></a><ol class="indicator"></ol><div class="modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true">&times;</button><h4 class="modal-title"></h4></div><div class="modal-body next"></div><div class="modal-footer"><button type="button" class="btn btn-default pull-left prev"><i class="glyphicon glyphicon-chevron-left"></i> Anterior</button> <button type="button" class="btn btn-primary next">Siguiente <i class="glyphicon glyphicon-chevron-right"></i></button></div></div></div></div></div></div><script type="text/javascript">window.cookieconsent_options = {
        "message": "Esta bitácora te informa de la obviedad de que utiliza «cookies», propias y de servicios como Google Analytics y Google AdSense entre otros.",
        "dismiss": "Aceptar",
        "learnMore": "Más información",
        "link": null,
        "theme": "dark-bottom"
    };</script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js" async></script></body></html>